{"version":3,"sources":["webpack:///./resources/js/components/inputs/DateInput.vue?0c44","webpack:///./resources/js/components/inputs/DateInput.vue?e061","webpack:///resources/js/components/inputs/DateInput.vue","webpack:///./resources/js/components/inputs/DateInput.vue","webpack:///./resources/js/components/forms/FieldObservationForm.vue?45e0","webpack:///./resources/js/models/user.js","webpack:///./resources/js/mixins/UserMixin.js","webpack:///resources/js/components/forms/FieldObservationForm.vue","webpack:///./resources/js/components/forms/FieldObservationForm.vue?4c26","webpack:///./resources/js/components/forms/FieldObservationForm.vue","webpack:///./resources/js/components/inputs/UserAutocomplete.vue?200d","webpack:///resources/js/components/inputs/UserAutocomplete.vue","webpack:///./resources/js/components/inputs/UserAutocomplete.vue?9f60","webpack:///./resources/js/components/inputs/UserAutocomplete.vue","webpack:///./resources/js/components/inputs/SpatialInput.vue?1219","webpack:///./resources/js/components/inputs/SpatialInput.vue?4894","webpack:///resources/js/components/inputs/SpatialInput.vue","webpack:///./resources/js/components/inputs/SpatialInput.vue","webpack:///./resources/js/mixins/FormMixin.js","webpack:///./resources/js/components/inputs/PhotoUpload.vue?b649","webpack:///./resources/js/Croppr.js","webpack:///./resources/js/components/ImageCropModal.vue?7cdd","webpack:///resources/js/components/ImageCropModal.vue","webpack:///./resources/js/components/inputs/PhotoUpload.vue?7763","webpack:///resources/js/components/inputs/PhotoUpload.vue","webpack:///./resources/js/components/ImageCropModal.vue","webpack:///./resources/js/components/ImageCropModal.vue?9faf","webpack:///./resources/js/components/inputs/PhotoUpload.vue","webpack:///./resources/js/components/ImageModal.vue?e923","webpack:///./resources/js/components/ImageModal.vue?a0e2","webpack:///resources/js/components/ImageModal.vue","webpack:///./resources/js/components/ImageModal.vue","webpack:///./resources/js/components/inputs/TaxonAutocomplete.vue?0331","webpack:///resources/js/components/inputs/TaxonAutocomplete.vue","webpack:///./resources/js/components/inputs/TaxonAutocomplete.vue?b12f","webpack:///./resources/js/components/inputs/TaxonAutocomplete.vue"],"names":["name","props","label","type","String","default","year","Number","month","day","placeholders","Object","errors","computed","now","months","this","isThisYear","splice","days","isThisMonth","watch","truncateDay","methods","length","onYearInput","$emit","value","onMonthInput","onDayInput","component","_vm","_h","$createElement","_c","_self","attrs","has","first","on","_v","domProps","_l","index","_s","User","data","attribute","roles","Array","isArray","_intersection","map","role","currentUser","window","App","isCuratorOrAdmin","hasRole","mixins","FormMixin","components","NzDateInput","NzPhotoUpload","NzSpatialInput","NzTaxonAutocomplete","NzUserAutocomplete","observation","taxon","taxon_id","taxon_suggestion","latitude","longitude","accuracy","elevation","location","photos","observer","identifier","note","sex","number","project","habitat","found_on","stage_id","found_dead","found_dead_note","data_license","image_license","time","types","observed_by_id","observed_by","identified_by_id","identified_by","dataset","atlas_code","licenses","sexes","observationTypes","showObserverIdentifier","Boolean","atlasCodes","keepAfterSubmit","getAttributesToKeep","showMoreDetails","locale","observationTypeSearch","shouldClearType","exifExtracted","lastStageId","stages","form","selectedObservationTypes","get","filter","set","observation_types_ids","availableObservationTypes","isIdentified","identificationChanged","usesAtlasCodes","uses_atlas_codes","created","setDefaultObservationType","newForm","forEach","photo","crop","reason","resetOnSuccess","hookAfterSubmitWithoutRedirect","clearPhotos","$refs","taxonAutocomplete","focusOnInput","onTaxonSelect","id","invalidStage","updateIdentifier","onTimeInput","onPhotoUploaded","push","availableType","pushSelectedObservationType","promptToExtractExifData","image","onPhotoRemoved","selectedTypeIndex","onPhotoCropped","photoIndex","croppedImage","getObservationPhotoAttribute","updated","isValid","onTypeTyping","onTypeBackspace","exif","$buefy","dialog","confirm","message","extractExifMessage","replace","cancelText","trans","confirmText","onConfirm","onCancel","extractExifData","fillFromExif","onObserverSelect","user","full_name","onIdentifierSelect","onLicenseChanged","license","staticClass","action","ref","model","callback","$$v","$set","expression","$event","directives","rawName","stage","key","nativeOn","indexOf","_k","keyCode","scopedSlots","_u","fn","option","atlasCode","code","_e","slot","content","class","submittingWithRedirect","preventDefault","submitWithRedirect","submittingWithoutRedirect","submitWithoutRedirect","cancelUrl","placeholder","route","error","except","autofocus","disabled","selected","loading","icon","fetchData","params","onSelect","onInput","currentValue","$el","querySelector","focus","getValue","email","hasOtherErrors","emptyAccuracy","calculateEmptyAccuracy","gmaps","center","zoom","showDetails","elevationService","position","coordinatesSet","isNaN","mapHasErrors","newAccuracy","centerCoordinates","lat","lng","getElevation","setCurrentLocationAsMapCenter","castNumber","onLocationInput","updateLocation","event","target","onLongitudeInput","updateLongitude","onLatitudeInput","updateLatitude","onAccuracyInput","updateAccuracy","onElevationInput","updateElevation","setMarker","updateRadius","radius","google","maps","ElevationService","getElevationForLocations","locations","status","ElevationStatus","OK","results","onZoomChanged","parseInt","Math","pow","navigator","geolocation","getCurrentPosition","staticStyle","streetViewControl","strokeWeight","_t","required","method","redirectUrl","submitMore","shouldConfirmSubmit","confirmSubmitMessage","shouldAskReason","shouldConfirmCancel","submitOnlyDirty","submitOnlyDirtyMessage","confirmingSubmit","confirmingCancel","document","addEventListener","registerKeyListener","beforeDestroy","removeEventListener","Form","e","enter","which","ctrlKey","shiftKey","confirmSubmit","options","promptForReason","prompt","inputAttrs","maxlength","$nextTick","input","setCustomValidity","validity","valid","validationMessage","notifyNoChanges","toast","open","notifyNoChangesAndRedirect","setTimeout","href","processing","isDirty","performSubmitWithRedirect","toLowerCase","then","onSuccessfulSubmitWithRedirect","onFailedSubmit","hookAfterSubmitWithRedirect","performSubmitWithoutRedirect","onSuccessfulSubmitWithoutRedirect","keep","_pick","reset","populate","duration","_get","_isEqual","initial","confirmCancel","Croppr","actualWidth","imageEl","naturalWidth","actualHeight","naturalHeight","factorX","offsetWidth","factorY","offsetHeight","box","Box","round","x","y","width","height","redraw","BaseCroppr","canCancel","imageUrl","newCrop","preserveRatio","mounted","ctrlIsPressed","ctrlIsNotPressed","isActive","handleScroll","croppr","onCropEnd","onInitialize","setBoxToRealPosition","savedScrollTop","body","classList","toggle","style","top","documentElement","scrollTop","cropImage","close","aspectRatio","NzImageCropModal","animation","maxWidth","newWidth","cancel","NzImageModal","withCrop","uploading","headers","getImageDataUrl","canvas","createElement","setAttribute","img","getContext","drawImage","toDataURL","haveImage","showModal","thumbnailUrl","openCropModal","closeCropModal","path","hasExisting","remove","handleLicenseChanged","showCropModal","url","progress","text","items","newValue","active","openImage","handler","next","prev","onClose","haveThumbnail","thumbnail_url","limit","enterPressed","autocomplete","native_name"],"mappings":"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","file":"js/21.js?id=82cfed81f602f27a3435","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-field',{attrs:{\"label\":_vm.label}},[_c('b-field',{attrs:{\"expanded\":\"\",\"grouped\":\"\"}},[_c('b-field',{attrs:{\"type\":_vm.errors.has('year') ? 'is-danger': '',\"message\":_vm.errors.has('year') ? _vm.errors.first('year'): '',\"expanded\":\"\"}},[_c('b-input',{attrs:{\"placeholder\":_vm.placeholders.year,\"value\":_vm.year},on:{\"input\":_vm.onYearInput}})],1),_vm._v(\" \"),_c('b-field',{attrs:{\"type\":_vm.errors.has('month') ? 'is-danger': '',\"message\":_vm.errors.has('month') ? _vm.errors.first('month'): '',\"expanded\":\"\"}},[_c('b-select',{attrs:{\"placeholder\":_vm.placeholders.month,\"value\":_vm.month,\"expanded\":\"\"},on:{\"input\":_vm.onMonthInput}},[_c('option',{domProps:{\"value\":null}}),_vm._v(\" \"),_vm._l((_vm.months),function(month,index){return _c('option',{domProps:{\"value\":(index + 1),\"textContent\":_vm._s(month)}})})],2)],1),_vm._v(\" \"),_c('b-field',{attrs:{\"type\":_vm.errors.has('day') ? 'is-danger': '',\"message\":_vm.errors.has('day') ? _vm.errors.first('day'): '',\"expanded\":\"\"}},[_c('b-select',{attrs:{\"placeholder\":_vm.placeholders.day,\"value\":_vm.day,\"expanded\":\"\"},on:{\"input\":_vm.onDayInput}},[_c('option',{domProps:{\"value\":null}}),_vm._v(\" \"),_vm._l((_vm.days),function(day){return _c('option',{domProps:{\"value\":day,\"textContent\":_vm._s(day)}})})],2)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DateInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DateInput.vue?vue&type=script&lang=js&\"","<template>\n  <b-field :label=\"label\">\n    <b-field expanded grouped>\n      <b-field\n        :type=\"errors.has('year') ? 'is-danger': ''\"\n        :message=\"errors.has('year') ? errors.first('year'): ''\"\n        expanded\n      >\n        <b-input :placeholder=\"placeholders.year\" :value=\"year\" @input=\"onYearInput\" />\n      </b-field>\n\n      <b-field\n        :type=\"errors.has('month') ? 'is-danger': ''\"\n        :message=\"errors.has('month') ? errors.first('month'): ''\"\n        expanded\n      >\n        <b-select :placeholder=\"placeholders.month\" :value=\"month\" @input=\"onMonthInput\" expanded>\n          <option :value=\"null\"></option>\n          <option v-for=\"(month, index) in months\" :value=\"(index + 1)\" v-text=\"month\"></option>\n        </b-select>\n      </b-field>\n\n      <b-field\n        :type=\"errors.has('day') ? 'is-danger': ''\"\n        :message=\"errors.has('day') ? errors.first('day'): ''\"\n        expanded\n      >\n        <b-select :placeholder=\"placeholders.day\" :value=\"day\" @input=\"onDayInput\" expanded>\n          <option :value=\"null\"></option>\n          <option v-for=\"day in days\" :value=\"day\" v-text=\"day\"></option>\n        </b-select>\n      </b-field>\n    </b-field>\n  </b-field>\n</template>\n\n<script>\nimport dayjs from '@/dayjs'\nimport _range from 'lodash/range'\n\nexport default {\n  name: 'nzDateInput',\n\n  props: {\n    label: {\n      type: String,\n      default: 'Date'\n    },\n\n    year: {\n      type: Number,\n      default: dayjs().year()\n    },\n\n    month: {\n      type: Number,\n      default: dayjs().month() + 1\n    },\n\n    day: {\n      type: Number,\n      default: dayjs().date()\n    },\n\n    placeholders: {\n      type: Object,\n      default() {\n        return {\n          year: 'Year',\n          month: 'Month',\n          day: 'Day'\n        }\n      }\n    },\n\n    errors: {\n      type: Object,\n      default: () => ({ has: () => false })\n    }\n  },\n\n  computed: {\n    now() {\n      return dayjs()\n    },\n\n    months() {\n      if (!this.year || this.year > dayjs().year()) return []\n\n      const isThisYear = this.year === dayjs().year()\n\n      let months = dayjs.months()\n\n      if (isThisYear) months.splice(dayjs().month() + 1)\n\n      return months\n    },\n\n    days() {\n      const haveDate = this.year && this.month\n\n      if (!haveDate) return []\n\n      const isThisMonth = this.year === dayjs().year() && (this.month - 1) === dayjs().month()\n\n      let days = dayjs(new Date(this.year, this.month - 1, 1)).daysInMonth()\n\n      if (isThisMonth) days = dayjs().date()\n\n      return _range(1, days + 1)\n    }\n  },\n\n  watch: {\n    year() {\n      if (this.year > dayjs().year() || this.months.length < this.month -1)  {\n          this.onMonthInput(null)\n      }\n\n      this.truncateDay()\n    },\n\n    month() {\n      this.truncateDay()\n    }\n  },\n\n  methods: {\n    truncateDay() {\n      if (this.days.length < this.day)  {\n          this.onDayInput(null)\n      }\n    },\n\n    onYearInput(value) {\n      this.$emit('update:year', +value || null)\n    },\n\n    onMonthInput(value) {\n      this.$emit('update:month', value)\n    },\n\n    onDayInput(value) {\n      this.$emit('update:day', value)\n    }\n  }\n}\n</script>\n","import { render, staticRenderFns } from \"./DateInput.vue?vue&type=template&id=113a099e&\"\nimport script from \"./DateInput.vue?vue&type=script&lang=js&\"\nexport * from \"./DateInput.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('form',{staticClass:\"field-observation-form\",attrs:{\"action\":_vm.action,\"method\":\"POST\",\"lang\":_vm.locale}},[_c('div',{staticClass:\"columns is-desktop\"},[_c('div',{staticClass:\"column is-half-desktop\"},[_c('nz-taxon-autocomplete',{ref:\"taxonAutocomplete\",attrs:{\"taxon\":_vm.observation.taxon,\"error\":_vm.form.errors.has('taxon_id'),\"message\":_vm.form.errors.has('taxon_id') ? _vm.form.errors.first('taxon_id') : null,\"autofocus\":\"\",\"label\":_vm.trans('labels.field_observations.taxon'),\"placeholder\":_vm.trans('labels.field_observations.search_for_taxon')},on:{\"select\":_vm.onTaxonSelect},model:{value:(_vm.form.taxon_suggestion),callback:function ($$v) {_vm.$set(_vm.form, \"taxon_suggestion\", $$v)},expression:\"form.taxon_suggestion\"}}),_vm._v(\" \"),_c('nz-date-input',{attrs:{\"year\":_vm.form.year,\"month\":_vm.form.month,\"day\":_vm.form.day,\"errors\":_vm.form.errors,\"label\":_vm.trans('labels.field_observations.date'),\"placeholders\":{\n            year: _vm.trans('labels.field_observations.year'),\n            month: _vm.trans('labels.field_observations.month'),\n            day: _vm.trans('labels.field_observations.day')\n        }},on:{\"update:year\":function($event){return _vm.$set(_vm.form, \"year\", $event)},\"update:month\":function($event){return _vm.$set(_vm.form, \"month\", $event)},\"update:day\":function($event){return _vm.$set(_vm.form, \"day\", $event)}}}),_vm._v(\" \"),_c('b-field',{attrs:{\"label\":_vm.trans('labels.field_observations.photos')}},[_c('div',{staticClass:\"columns\"},[_c('div',{staticClass:\"column is-one-third\"},[_c('nz-photo-upload',{ref:\"photoUpload-1\",attrs:{\"image-url\":_vm.getObservationPhotoAttribute(0, 'url'),\"image-path\":_vm.getObservationPhotoAttribute(0, 'path'),\"image-license\":_vm.getObservationPhotoAttribute(0, 'license'),\"licenses\":_vm.licenses,\"text\":_vm.trans('labels.field_observations.upload'),\"errors\":_vm.form.errors},on:{\"uploaded\":_vm.onPhotoUploaded,\"removed\":_vm.onPhotoRemoved,\"cropped\":_vm.onPhotoCropped,\"license-changed\":function($event){return _vm.onLicenseChanged(0, $event)}}})],1),_vm._v(\" \"),_c('div',{staticClass:\"column is-one-third\"},[_c('nz-photo-upload',{ref:\"photoUpload-2\",attrs:{\"image-url\":_vm.getObservationPhotoAttribute(1, 'url'),\"image-path\":_vm.getObservationPhotoAttribute(1, 'path'),\"image-license\":_vm.getObservationPhotoAttribute(1, 'license'),\"licenses\":_vm.licenses,\"text\":_vm.trans('labels.field_observations.upload'),\"errors\":_vm.form.errors},on:{\"uploaded\":_vm.onPhotoUploaded,\"removed\":_vm.onPhotoRemoved,\"cropped\":_vm.onPhotoCropped,\"license-changed\":function($event){return _vm.onLicenseChanged(1, $event)}}})],1),_vm._v(\" \"),_c('div',{staticClass:\"column is-one-third\"},[_c('nz-photo-upload',{ref:\"photoUpload-3\",attrs:{\"image-url\":_vm.getObservationPhotoAttribute(2, 'url'),\"image-path\":_vm.getObservationPhotoAttribute(2, 'path'),\"image-license\":_vm.getObservationPhotoAttribute(2, 'license'),\"licenses\":_vm.licenses,\"text\":_vm.trans('labels.field_observations.upload'),\"errors\":_vm.form.errors},on:{\"uploaded\":_vm.onPhotoUploaded,\"removed\":_vm.onPhotoRemoved,\"cropped\":_vm.onPhotoCropped,\"license-changed\":function($event){return _vm.onLicenseChanged(2, $event)}}})],1)])])],1),_vm._v(\" \"),_c('div',{staticClass:\"column is-half-desktop\"},[_c('nz-spatial-input',{attrs:{\"latitude\":_vm.form.latitude,\"longitude\":_vm.form.longitude,\"location\":_vm.form.location,\"accuracy\":_vm.form.accuracy,\"elevation\":_vm.form.elevation,\"errors\":_vm.form.errors},on:{\"update:latitude\":function($event){return _vm.$set(_vm.form, \"latitude\", $event)},\"update:longitude\":function($event){return _vm.$set(_vm.form, \"longitude\", $event)},\"update:location\":function($event){return _vm.$set(_vm.form, \"location\", $event)},\"update:accuracy\":function($event){return _vm.$set(_vm.form, \"accuracy\", $event)},\"update:elevation\":function($event){return _vm.$set(_vm.form, \"elevation\", $event)}}})],1)]),_vm._v(\" \"),_c('button',{staticClass:\"button is-text\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.showMoreDetails = !_vm.showMoreDetails}}},[_vm._v(\"\\n    \"+_vm._s(_vm.showMoreDetails ? _vm.trans('labels.field_observations.less_details') : _vm.trans('labels.field_observations.more_details'))+\"\\n  \")]),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showMoreDetails),expression:\"showMoreDetails\"}],staticClass:\"mt-4\"},[_c('div',{staticClass:\"columns\"},[_c('div',{staticClass:\"column\"},[_c('b-field',{attrs:{\"label\":_vm.trans('labels.field_observations.stage'),\"label-for\":\"stage\",\"type\":_vm.form.errors.has('stage_id') ? 'is-danger' : null,\"message\":_vm.form.errors.has('stage_id') ? _vm.form.errors.first('stage_id') : null}},[_c('b-select',{attrs:{\"id\":\"stage\",\"disabled\":!_vm.stages.length,\"expanded\":\"\"},on:{\"input\":function($event){_vm.lastStageId = $event}},model:{value:(_vm.form.stage_id),callback:function ($$v) {_vm.$set(_vm.form, \"stage_id\", $$v)},expression:\"form.stage_id\"}},[_c('option',{domProps:{\"value\":null}},[_vm._v(_vm._s(_vm.trans('labels.field_observations.choose_a_stage')))]),_vm._v(\" \"),_vm._l((_vm.stages),function(stage){return _c('option',{key:stage.id,domProps:{\"value\":stage.id,\"textContent\":_vm._s(_vm.trans((\"stages.\" + (stage.name))))}})})],2)],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"column\"},[_c('b-field',{attrs:{\"label\":_vm.trans('labels.field_observations.sex'),\"type\":_vm.form.errors.has('sex') ? 'is-danger' : null,\"message\":_vm.form.errors.has('sex') ? _vm.form.errors.first('sex') : null}},[_c('b-select',{attrs:{\"expanded\":\"\"},model:{value:(_vm.form.sex),callback:function ($$v) {_vm.$set(_vm.form, \"sex\", $$v)},expression:\"form.sex\"}},[_c('option',{domProps:{\"value\":null}},[_vm._v(_vm._s(_vm.trans('labels.field_observations.choose_a_value')))]),_vm._v(\" \"),_vm._l((_vm.sexes),function(label,sex){return _c('option',{key:sex,domProps:{\"value\":sex,\"textContent\":_vm._s(label)}})})],2)],1)],1)]),_vm._v(\" \"),_c('b-field',{attrs:{\"label\":_vm.trans('labels.field_observations.types'),\"error\":_vm.form.errors.has('observation_types_ids'),\"message\":_vm.form.errors.has('observation_types_ids') ? _vm.form.errors.first('observation_types_ids') : null}},[_c('b-taginput',{attrs:{\"data\":_vm.availableObservationTypes,\"autocomplete\":\"\",\"allowNew\":false,\"field\":\"name\",\"icon\":\"tag\",\"placeholder\":_vm.trans('labels.field_observations.types_placeholder'),\"open-on-focus\":\"\"},on:{\"typing\":_vm.onTypeTyping},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"delete\",[8,46],$event.key,[\"Backspace\",\"Delete\",\"Del\"])){ return null; }return _vm.onTypeBackspace($event)}},scopedSlots:_vm._u([{key:\"default\",fn:function(props){return [_c('span',[_vm._v(_vm._s(props.option.name))])]}}]),model:{value:(_vm.selectedObservationTypes),callback:function ($$v) {_vm.selectedObservationTypes=$$v},expression:\"selectedObservationTypes\"}})],1),_vm._v(\" \"),(_vm.usesAtlasCodes)?_c('b-field',{attrs:{\"label\":_vm.trans('labels.field_observations.atlas_code'),\"label-for\":\"atlas-code\",\"type\":_vm.form.errors.has('atlas_code') ? 'is-danger' : null,\"message\":_vm.form.errors.has('atlas_code') ? _vm.form.errors.first('atlas_code') : null}},[_c('b-select',{attrs:{\"id\":\"atlas-code\",\"expanded\":\"\"},model:{value:(_vm.form.atlas_code),callback:function ($$v) {_vm.$set(_vm.form, \"atlas_code\", $$v)},expression:\"form.atlas_code\"}},[_c('option',{domProps:{\"value\":null}},[_vm._v(_vm._s(_vm.trans('labels.field_observations.choose_a_value')))]),_vm._v(\" \"),_vm._l((_vm.atlasCodes),function(atlasCode){return _c('option',{key:atlasCode.code,domProps:{\"value\":atlasCode.code,\"textContent\":_vm._s(atlasCode.name)}})})],2)],1):_vm._e(),_vm._v(\" \"),_c('b-field',{attrs:{\"label\":_vm.trans('labels.field_observations.number'),\"label-for\":\"number\",\"type\":_vm.form.errors.has('number') ? 'is-danger' : null,\"message\":_vm.form.errors.has('number') ? _vm.form.errors.first('number') : null}},[_c('b-input',{attrs:{\"id\":\"number\",\"type\":\"number\"},model:{value:(_vm.form.number),callback:function ($$v) {_vm.$set(_vm.form, \"number\", $$v)},expression:\"form.number\"}})],1),_vm._v(\" \"),_c('b-field',{attrs:{\"label\":_vm.trans('labels.field_observations.note'),\"label-for\":\"note\",\"error\":_vm.form.errors.has('note'),\"message\":_vm.form.errors.has('note') ? _vm.form.errors.first('note') : null}},[_c('b-input',{attrs:{\"id\":\"note\",\"type\":\"textarea\"},model:{value:(_vm.form.note),callback:function ($$v) {_vm.$set(_vm.form, \"note\", $$v)},expression:\"form.note\"}})],1),_vm._v(\" \"),_c('div',{staticClass:\"columns\"},[_c('div',{staticClass:\"column\"},[_c('b-field',{attrs:{\"label\":_vm.trans('labels.field_observations.habitat'),\"label-for\":\"habitat\",\"error\":_vm.form.errors.has('habitat'),\"message\":_vm.form.errors.has('habitat') ? _vm.form.errors.first('habitat') : null}},[_c('b-input',{attrs:{\"id\":\"habitat\",\"name\":\"habitat\"},model:{value:(_vm.form.habitat),callback:function ($$v) {_vm.$set(_vm.form, \"habitat\", $$v)},expression:\"form.habitat\"}})],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"column\"},[_c('b-field',{attrs:{\"label\":_vm.trans('labels.literature_observations.found_on'),\"type\":_vm.form.errors.has('found_on') ? 'is-danger' : null,\"message\":_vm.form.errors.has('found_on') ? _vm.form.errors.first('found_on') : null}},[_c('label',{staticClass:\"label\",attrs:{\"slot\":\"label\",\"for\":\"found_on\"},slot:\"label\"},[_c('span',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:({content: _vm.trans('labels.literature_observations.found_on_tooltip')}),expression:\"{content: trans('labels.literature_observations.found_on_tooltip')}\"}],staticClass:\"is-dashed\"},[_vm._v(\"\\n              \"+_vm._s(_vm.trans('labels.literature_observations.found_on'))+\"\\n            \")])]),_vm._v(\" \"),_c('b-input',{attrs:{\"id\":\"found_on\",\"name\":\"found_on\"},model:{value:(_vm.form.found_on),callback:function ($$v) {_vm.$set(_vm.form, \"found_on\", $$v)},expression:\"form.found_on\"}})],1)],1)]),_vm._v(\" \"),_c('b-field',{attrs:{\"label\":_vm.trans('labels.field_observations.time'),\"label-for\":\"time\",\"type\":_vm.form.errors.has('time') ? 'is-danger' : null,\"message\":_vm.form.errors.has('time') ? _vm.form.errors.first('time') : null}},[_c('b-timepicker',{attrs:{\"id\":\"time\",\"value\":_vm.time,\"placeholder\":_vm.trans('labels.field_observations.click_to_select'),\"icon\":\"clock-o\",\"mobile-native\":false},on:{\"input\":_vm.onTimeInput}},[_c('button',{staticClass:\"button is-danger\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.form.time = null}}},[_c('b-icon',{attrs:{\"icon\":\"close\"}})],1)])],1),_vm._v(\" \"),_c('div',{staticClass:\"columns\"},[_c('div',{staticClass:\"column\"},[_c('b-field',{attrs:{\"label\":_vm.trans('labels.literature_observations.project'),\"type\":_vm.form.errors.has('project') ? 'is-danger' : null,\"message\":_vm.form.errors.has('project') ? _vm.form.errors.first('project') : null}},[_c('label',{staticClass:\"label\",attrs:{\"slot\":\"label\",\"for\":\"project\"},slot:\"label\"},[_c('span',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:({content: _vm.trans('labels.literature_observations.project_tooltip')}),expression:\"{content: trans('labels.literature_observations.project_tooltip')}\"}],staticClass:\"is-dashed\"},[_vm._v(\"\\n              \"+_vm._s(_vm.trans('labels.literature_observations.project'))+\"\\n            \")])]),_vm._v(\" \"),_c('b-input',{attrs:{\"id\":\"project\",\"name\":\"project\"},model:{value:(_vm.form.project),callback:function ($$v) {_vm.$set(_vm.form, \"project\", $$v)},expression:\"form.project\"}})],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"column\"},[_c('b-field',{attrs:{\"label\":_vm.trans('labels.field_observations.dataset'),\"label-for\":\"dataset\",\"type\":_vm.form.errors.has('dataset') ? 'is-danger' : null,\"message\":_vm.form.errors.has('dataset') ? _vm.form.errors.first('dataset') : null}},[_c('b-input',{attrs:{\"id\":\"dataset\",\"name\":\"dataset\"},model:{value:(_vm.form.dataset),callback:function ($$v) {_vm.$set(_vm.form, \"dataset\", $$v)},expression:\"form.dataset\"}})],1)],1)]),_vm._v(\" \"),_c('b-checkbox',{model:{value:(_vm.form.found_dead),callback:function ($$v) {_vm.$set(_vm.form, \"found_dead\", $$v)},expression:\"form.found_dead\"}},[_vm._v(_vm._s(_vm.trans('labels.field_observations.found_dead')))]),_vm._v(\" \"),(_vm.form.found_dead)?_c('b-field',{attrs:{\"label\":_vm.trans('labels.field_observations.found_dead_note'),\"label-for\":\"found_dead_note\",\"error\":_vm.form.errors.has('found_dead_note'),\"message\":_vm.form.errors.has('found_dead_note') ? _vm.form.errors.first('found_dead_note') : null}},[_c('b-input',{attrs:{\"id\":\"found_dead_note\",\"type\":\"textarea\"},model:{value:(_vm.form.found_dead_note),callback:function ($$v) {_vm.$set(_vm.form, \"found_dead_note\", $$v)},expression:\"form.found_dead_note\"}})],1):_vm._e(),_vm._v(\" \"),(_vm.showObserverIdentifier)?[_c('nz-user-autocomplete',{attrs:{\"error\":_vm.form.errors.has('observer'),\"message\":_vm.form.errors.has('observer') ? _vm.form.errors.first('observer') : null,\"user\":_vm.form.observed_by,\"label\":_vm.trans('labels.field_observations.observer'),\"placeholder\":_vm.currentUser.full_name},on:{\"select\":_vm.onObserverSelect},model:{value:(_vm.form.observer),callback:function ($$v) {_vm.$set(_vm.form, \"observer\", $$v)},expression:\"form.observer\"}}),_vm._v(\" \"),_c('nz-user-autocomplete',{attrs:{\"error\":_vm.form.errors.has('identifier'),\"message\":_vm.form.errors.has('identifier') ? _vm.form.errors.first('identifier') : null,\"user\":_vm.form.identified_by,\"label\":_vm.trans('labels.field_observations.identifier'),\"disabled\":!_vm.isIdentified},on:{\"select\":_vm.onIdentifierSelect},model:{value:(_vm.form.identifier),callback:function ($$v) {_vm.$set(_vm.form, \"identifier\", $$v)},expression:\"form.identifier\"}})]:_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"columns\"},[_c('div',{staticClass:\"column\"},[_c('b-field',{attrs:{\"label\":_vm.trans('labels.field_observations.data_license'),\"label-for\":\"data_license\",\"type\":_vm.form.errors.has('data_license') ? 'is-danger' : null,\"message\":_vm.form.errors.has('data_license') ? _vm.form.errors.first('data_license') : null}},[_c('b-select',{attrs:{\"id\":\"data_license\",\"expanded\":\"\"},model:{value:(_vm.form.data_license),callback:function ($$v) {_vm.$set(_vm.form, \"data_license\", $$v)},expression:\"form.data_license\"}},[_c('option',{domProps:{\"value\":null}},[_vm._v(_vm._s(_vm.trans('labels.field_observations.default')))]),_vm._v(\" \"),_vm._l((_vm.licenses),function(label,value){return _c('option',{domProps:{\"value\":value,\"textContent\":_vm._s(label)}})})],2)],1)],1)])],2),_vm._v(\" \"),_c('hr'),_vm._v(\" \"),_c('button',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:({content: _vm.trans('labels.field_observations.save_tooltip')}),expression:\"{content: trans('labels.field_observations.save_tooltip')}\"}],staticClass:\"button is-primary\",class:{\n        'is-loading': _vm.submittingWithRedirect\n    },attrs:{\"type\":\"submit\"},on:{\"click\":function($event){$event.preventDefault();return _vm.submitWithRedirect($event)}}},[_vm._v(\"\\n    \"+_vm._s(_vm.trans('buttons.save'))+\"\\n  \")]),_vm._v(\" \"),(_vm.submitMore)?_c('button',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:({content: _vm.trans('labels.field_observations.save_more_tooltip')}),expression:\"{content: trans('labels.field_observations.save_more_tooltip')}\"}],staticClass:\"button is-primary\",class:{\n        'is-outlined': !_vm.submittingWithoutRedirect,\n        'is-loading': _vm.submittingWithoutRedirect\n    },attrs:{\"type\":\"submit\"},on:{\"click\":function($event){$event.preventDefault();return _vm.submitWithoutRedirect($event)}}},[_vm._v(\"\\n    \"+_vm._s(_vm.trans('buttons.save_more'))+\"\\n  \")]):_vm._e(),_vm._v(\" \"),_c('a',{staticClass:\"button is-text\",attrs:{\"href\":_vm.cancelUrl},on:{\"click\":_vm.onCancel}},[_vm._v(_vm._s(_vm.trans('buttons.cancel')))])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import _intersection from 'lodash/intersection'\n\nexport default class User {\n  constructor(data) {\n    for (let attribute in data) {\n      this[attribute] = data[attribute];\n    }\n  }\n\n  hasRole(roles) {\n    if (!Array.isArray(roles)) {\n      roles = [roles]\n    }\n\n    return !!_intersection(this.roles.map(role => role.name), roles).length;\n  }\n}\n","import User from '@/models/user'\n\nexport default {\n  data() {\n    return {\n      currentUser: new User(window.App.User)\n    }\n  },\n\n  computed: {\n    isCuratorOrAdmin() {\n        return this.currentUser.hasRole(['admin', 'curator'])\n    }\n  }\n}\n","<template>\n  <form :action=\"action\" method=\"POST\" :lang=\"locale\" class=\"field-observation-form\">\n    <div class=\"columns is-desktop\">\n      <div class=\"column is-half-desktop\">\n        <nz-taxon-autocomplete\n          v-model=\"form.taxon_suggestion\"\n          @select=\"onTaxonSelect\"\n          :taxon=\"observation.taxon\"\n          :error=\"form.errors.has('taxon_id')\"\n          :message=\"form.errors.has('taxon_id') ? form.errors.first('taxon_id') : null\"\n          autofocus\n          ref=\"taxonAutocomplete\"\n          :label=\"trans('labels.field_observations.taxon')\"\n          :placeholder=\"trans('labels.field_observations.search_for_taxon')\"\n        />\n\n        <nz-date-input\n          :year.sync=\"form.year\"\n          :month.sync=\"form.month\"\n          :day.sync=\"form.day\"\n          :errors=\"form.errors\"\n          :label=\"trans('labels.field_observations.date')\"\n          :placeholders=\"{\n              year: trans('labels.field_observations.year'),\n              month: trans('labels.field_observations.month'),\n              day: trans('labels.field_observations.day')\n          }\"\n        />\n\n        <b-field :label=\"trans('labels.field_observations.photos')\">\n          <div class=\"columns\">\n            <div class=\"column is-one-third\">\n              <nz-photo-upload\n                :image-url=\"getObservationPhotoAttribute(0, 'url')\"\n                :image-path=\"getObservationPhotoAttribute(0, 'path')\"\n                :image-license=\"getObservationPhotoAttribute(0, 'license')\"\n                :licenses=\"licenses\"\n                :text=\"trans('labels.field_observations.upload')\"\n                @uploaded=\"onPhotoUploaded\"\n                @removed=\"onPhotoRemoved\"\n                @cropped=\"onPhotoCropped\"\n                @license-changed=\"onLicenseChanged(0, $event)\"\n                :errors=\"form.errors\"\n                ref=\"photoUpload-1\"\n              />\n            </div>\n\n            <div class=\"column is-one-third\">\n              <nz-photo-upload\n                :image-url=\"getObservationPhotoAttribute(1, 'url')\"\n                :image-path=\"getObservationPhotoAttribute(1, 'path')\"\n                :image-license=\"getObservationPhotoAttribute(1, 'license')\"\n                :licenses=\"licenses\"\n                :text=\"trans('labels.field_observations.upload')\"\n                @uploaded=\"onPhotoUploaded\"\n                @removed=\"onPhotoRemoved\"\n                @cropped=\"onPhotoCropped\"\n                @license-changed=\"onLicenseChanged(1, $event)\"\n                :errors=\"form.errors\"\n                ref=\"photoUpload-2\"\n              />\n            </div>\n\n            <div class=\"column is-one-third\">\n              <nz-photo-upload\n                :image-url=\"getObservationPhotoAttribute(2, 'url')\"\n                :image-path=\"getObservationPhotoAttribute(2, 'path')\"\n                :image-license=\"getObservationPhotoAttribute(2, 'license')\"\n                :licenses=\"licenses\"\n                :text=\"trans('labels.field_observations.upload')\"\n                @uploaded=\"onPhotoUploaded\"\n                @removed=\"onPhotoRemoved\"\n                @cropped=\"onPhotoCropped\"\n                @license-changed=\"onLicenseChanged(2, $event)\"\n                :errors=\"form.errors\"\n                ref=\"photoUpload-3\"\n              />\n            </div>\n          </div>\n        </b-field>\n      </div>\n\n      <div class=\"column is-half-desktop\">\n        <nz-spatial-input\n          :latitude.sync=\"form.latitude\"\n          :longitude.sync=\"form.longitude\"\n          :location.sync=\"form.location\"\n          :accuracy.sync=\"form.accuracy\"\n          :elevation.sync=\"form.elevation\"\n          :errors=\"form.errors\"\n        />\n      </div>\n    </div>\n\n    <button\n      type=\"button\"\n      class=\"button is-text\"\n      @click=\"showMoreDetails = !showMoreDetails\"\n    >\n      {{ showMoreDetails ? trans('labels.field_observations.less_details') : trans('labels.field_observations.more_details') }}\n    </button>\n\n    <div class=\"mt-4\" v-show=\"showMoreDetails\">\n      <div class=\"columns\">\n        <div class=\"column\">\n          <b-field\n            :label=\"trans('labels.field_observations.stage')\"\n            label-for=\"stage\"\n            :type=\"form.errors.has('stage_id') ? 'is-danger' : null\"\n            :message=\"form.errors.has('stage_id') ? form.errors.first('stage_id') : null\"\n          >\n            <b-select id=\"stage\" v-model=\"form.stage_id\" :disabled=\"!stages.length\" @input=\"lastStageId = $event\" expanded>\n              <option :value=\"null\">{{ trans('labels.field_observations.choose_a_stage') }}</option>\n              <option v-for=\"stage in stages\" :value=\"stage.id\" :key=\"stage.id\" v-text=\"trans(`stages.${stage.name}`)\"></option>\n            </b-select>\n          </b-field>\n        </div>\n\n        <div class=\"column\">\n          <b-field\n            :label=\"trans('labels.field_observations.sex')\"\n            :type=\"form.errors.has('sex') ? 'is-danger' : null\"\n            :message=\"form.errors.has('sex') ? form.errors.first('sex') : null\"\n          >\n            <b-select v-model=\"form.sex\" expanded>\n              <option :value=\"null\">{{ trans('labels.field_observations.choose_a_value') }}</option>\n              <option v-for=\"(label,sex) in sexes\" :key=\"sex\" :value=\"sex\" v-text=\"label\"></option>\n            </b-select>\n          </b-field>\n        </div>\n      </div>\n\n      <b-field\n        :label=\"trans('labels.field_observations.types')\"\n        :error=\"form.errors.has('observation_types_ids')\"\n        :message=\"form.errors.has('observation_types_ids') ? form.errors.first('observation_types_ids') : null\"\n      >\n        <b-taginput\n          v-model=\"selectedObservationTypes\"\n          :data=\"availableObservationTypes\"\n          autocomplete\n          :allowNew=\"false\"\n          field=\"name\"\n          icon=\"tag\"\n          :placeholder=\"trans('labels.field_observations.types_placeholder')\"\n          @typing=\"onTypeTyping\"\n          @keyup.native.delete=\"onTypeBackspace\"\n          open-on-focus\n        >\n          <template v-slot:default=\"props\">\n            <span>{{ props.option.name }}</span>\n          </template>\n        </b-taginput>\n      </b-field>\n\n      <b-field\n        v-if=\"usesAtlasCodes\"\n        :label=\"trans('labels.field_observations.atlas_code')\"\n        label-for=\"atlas-code\"\n        :type=\"form.errors.has('atlas_code') ? 'is-danger' : null\"\n        :message=\"form.errors.has('atlas_code') ? form.errors.first('atlas_code') : null\"\n      >\n        <b-select id=\"atlas-code\" v-model=\"form.atlas_code\" expanded>\n          <option :value=\"null\">{{ trans('labels.field_observations.choose_a_value') }}</option>\n          <option v-for=\"atlasCode in atlasCodes\" :value=\"atlasCode.code\" v-text=\"atlasCode.name\" :key=\"atlasCode.code\"></option>\n        </b-select>\n      </b-field>\n\n      <b-field\n        :label=\"trans('labels.field_observations.number')\"\n        label-for=\"number\"\n        :type=\"form.errors.has('number') ? 'is-danger' : null\"\n        :message=\"form.errors.has('number') ? form.errors.first('number') : null\"\n      >\n        <b-input id=\"number\" type=\"number\" v-model=\"form.number\" />\n      </b-field>\n\n      <b-field\n        :label=\"trans('labels.field_observations.note')\"\n        label-for=\"note\"\n        :error=\"form.errors.has('note')\"\n        :message=\"form.errors.has('note') ? form.errors.first('note') : null\"\n      >\n        <b-input id=\"note\" type=\"textarea\" v-model=\"form.note\" />\n      </b-field>\n\n      <div class=\"columns\">\n        <div class=\"column\">\n          <b-field\n            :label=\"trans('labels.field_observations.habitat')\"\n            label-for=\"habitat\"\n            :error=\"form.errors.has('habitat')\"\n            :message=\"form.errors.has('habitat') ? form.errors.first('habitat') : null\"\n          >\n            <b-input id=\"habitat\" name=\"habitat\" v-model=\"form.habitat\" />\n          </b-field>\n        </div>\n\n        <div class=\"column\">\n          <b-field\n            :label=\"trans('labels.literature_observations.found_on')\"\n            :type=\"form.errors.has('found_on') ? 'is-danger' : null\"\n            :message=\"form.errors.has('found_on') ? form.errors.first('found_on') : null\"\n          >\n            <label for=\"found_on\" class=\"label\" slot=\"label\">\n              <span class=\"is-dashed\" v-tooltip=\"{content: trans('labels.literature_observations.found_on_tooltip')}\">\n                {{ trans('labels.literature_observations.found_on') }}\n              </span>\n            </label>\n\n            <b-input id=\"found_on\" name=\"found_on\" v-model=\"form.found_on\"/>\n          </b-field>\n        </div>\n      </div>\n\n      <b-field\n        :label=\"trans('labels.field_observations.time')\"\n        label-for=\"time\"\n        :type=\"form.errors.has('time') ? 'is-danger' : null\"\n        :message=\"form.errors.has('time') ? form.errors.first('time') : null\"\n      >\n        <b-timepicker\n          id=\"time\"\n          :value=\"time\"\n          @input=\"onTimeInput\"\n          :placeholder=\"trans('labels.field_observations.click_to_select')\"\n          icon=\"clock-o\"\n          :mobile-native=\"false\"\n        >\n          <button type=\"button\" class=\"button is-danger\" @click=\"form.time = null\">\n            <b-icon icon=\"close\"></b-icon>\n          </button>\n        </b-timepicker>\n      </b-field>\n\n      <div class=\"columns\">\n        <div class=\"column\">\n          <b-field\n            :label=\"trans('labels.literature_observations.project')\"\n            :type=\"form.errors.has('project') ? 'is-danger' : null\"\n            :message=\"form.errors.has('project') ? form.errors.first('project') : null\"\n          >\n            <label for=\"project\" class=\"label\" slot=\"label\">\n              <span class=\"is-dashed\" v-tooltip=\"{content: trans('labels.literature_observations.project_tooltip')}\">\n                {{ trans('labels.literature_observations.project') }}\n              </span>\n            </label>\n\n            <b-input id=\"project\" name=\"project\" v-model=\"form.project\"/>\n          </b-field>\n        </div>\n\n        <div class=\"column\">\n          <b-field\n            :label=\"trans('labels.field_observations.dataset')\"\n            label-for=\"dataset\"\n            :type=\"form.errors.has('dataset') ? 'is-danger' : null\"\n            :message=\"form.errors.has('dataset') ? form.errors.first('dataset') : null\"\n          >\n            <b-input id=\"dataset\" name=\"dataset\" v-model=\"form.dataset\" />\n          </b-field>\n        </div>\n      </div>\n\n      <b-checkbox v-model=\"form.found_dead\">{{ trans('labels.field_observations.found_dead') }}</b-checkbox>\n\n      <b-field\n        :label=\"trans('labels.field_observations.found_dead_note')\"\n        label-for=\"found_dead_note\"\n        v-if=\"form.found_dead\"\n        :error=\"form.errors.has('found_dead_note')\"\n        :message=\"form.errors.has('found_dead_note') ? form.errors.first('found_dead_note') : null\"\n      >\n        <b-input id=\"found_dead_note\" type=\"textarea\" v-model=\"form.found_dead_note\" />\n      </b-field>\n\n      <template v-if=\"showObserverIdentifier\">\n        <nz-user-autocomplete\n          v-model=\"form.observer\"\n          @select=\"onObserverSelect\"\n          :error=\"form.errors.has('observer')\"\n          :message=\"form.errors.has('observer') ? form.errors.first('observer') : null\"\n          :user=\"form.observed_by\"\n          :label=\"trans('labels.field_observations.observer')\"\n          :placeholder=\"currentUser.full_name\"\n        />\n\n        <nz-user-autocomplete\n          v-model=\"form.identifier\"\n          @select=\"onIdentifierSelect\"\n          :error=\"form.errors.has('identifier')\"\n          :message=\"form.errors.has('identifier') ? form.errors.first('identifier') : null\"\n          :user=\"form.identified_by\"\n          :label=\"trans('labels.field_observations.identifier')\"\n          :disabled=\"!isIdentified\"\n        />\n      </template>\n\n      <div class=\"columns\">\n        <div class=\"column\">\n          <b-field\n            :label=\"trans('labels.field_observations.data_license')\"\n            label-for=\"data_license\"\n            :type=\"form.errors.has('data_license') ? 'is-danger' : null\"\n            :message=\"form.errors.has('data_license') ? form.errors.first('data_license') : null\"\n          >\n            <b-select id=\"data_license\" v-model=\"form.data_license\" expanded>\n              <option :value=\"null\">{{ trans('labels.field_observations.default') }}</option>\n              <option v-for=\"(label, value) in licenses\" :value=\"value\" v-text=\"label\"></option>\n            </b-select>\n          </b-field>\n        </div>\n      </div>\n    </div>\n\n    <hr>\n\n    <button\n      type=\"submit\"\n      class=\"button is-primary\"\n      :class=\"{\n          'is-loading': submittingWithRedirect\n      }\"\n      @click.prevent=\"submitWithRedirect\"\n      v-tooltip=\"{content: trans('labels.field_observations.save_tooltip')}\"\n    >\n      {{ trans('buttons.save') }}\n    </button>\n\n    <button\n      type=\"submit\"\n      class=\"button is-primary\"\n      :class=\"{\n          'is-outlined': !submittingWithoutRedirect,\n          'is-loading': submittingWithoutRedirect\n      }\"\n      @click.prevent=\"submitWithoutRedirect\"\n      v-if=\"submitMore\"\n      v-tooltip=\"{content: trans('labels.field_observations.save_more_tooltip')}\"\n    >\n      {{ trans('buttons.save_more') }}\n    </button>\n\n    <a :href=\"cancelUrl\" class=\"button is-text\" @click=\"onCancel\">{{ trans('buttons.cancel') }}</a>\n  </form>\n</template>\n\n<script>\nimport Form from 'form-backend-validation'\nimport dayjs from '@/dayjs'\nimport _get from 'lodash/get'\nimport _find from 'lodash/find'\nimport _includes from 'lodash/includes'\nimport _range from 'lodash/range'\nimport _findIndex from 'lodash/findIndex'\nimport _remove from 'lodash/remove'\nimport _cloneDeep from 'lodash/cloneDeep'\nimport FormMixin from '@/mixins/FormMixin'\nimport UserMixin from '@/mixins/UserMixin'\nimport NzDateInput from '@/components/inputs/DateInput'\nimport NzPhotoUpload from '@/components/inputs/PhotoUpload'\nimport NzSpatialInput from '@/components/inputs/SpatialInput'\nimport NzTaxonAutocomplete from '@/components/inputs/TaxonAutocomplete'\nimport NzUserAutocomplete from '@/components/inputs/UserAutocomplete'\n\nexport default {\n  name: 'nzFieldObservationForm',\n\n  mixins: [FormMixin, UserMixin],\n\n  components: {\n    NzDateInput,\n    NzPhotoUpload,\n    NzSpatialInput,\n    NzTaxonAutocomplete,\n    NzUserAutocomplete\n  },\n\n  props: {\n    observation: {\n      type: Object,\n      default() {\n        return {\n          taxon: null,\n          taxon_id: null,\n          taxon_suggestion: '',\n          year: dayjs().year(),\n          month: dayjs().month() + 1,\n          day: dayjs().date(),\n          latitude: null,\n          longitude: null,\n          accuracy: null,\n          elevation: null,\n          location: '',\n          photos: [],\n          observer: '',\n          identifier: '',\n          note: '',\n          sex: null,\n          number: null,\n          project: null,\n          habitat: null,\n          found_on: null,\n          stage_id: null,\n          found_dead: false,\n          found_dead_note: '',\n          data_license: null,\n          image_license: null,\n          time: null,\n          types: [],\n          observed_by_id: null,\n          observed_by: null,\n          identified_by_id: null,\n          identified_by: null,\n          dataset: null,\n          atlas_code: null,\n        }\n      }\n    },\n\n    licenses: {\n        type: Object,\n        default: () => ({})\n    },\n\n    sexes: {\n        type: Object,\n        default: () => ({})\n    },\n\n    observationTypes: {\n        type: Array,\n        default: () => []\n    },\n\n    showObserverIdentifier: Boolean,\n\n    atlasCodes: Array,\n  },\n\n  data() {\n    return {\n      keepAfterSubmit: this.getAttributesToKeep(),\n      showMoreDetails: false,\n      locale: window.App.locale,\n      observationTypeSearch: '',\n      shouldClearType: false,\n      exifExtracted: false,\n      lastStageId: this.observation.stage_id,\n    }\n  },\n\n  computed: {\n    stages() {\n      return this.form.taxon ? this.form.taxon.stages : []\n    },\n\n    time() {\n      return this.form.time ? dayjs(this.form.time, 'HH:mm').toDate() : null\n    },\n\n    selectedObservationTypes: {\n      get() {\n        return this.observationTypes.filter(type =>\n          _includes(this.form.observation_types_ids, type.id)\n        )\n      },\n\n      set(value) {\n        this.form.observation_types_ids = value.map(type => type.id)\n      }\n    },\n\n    availableObservationTypes() {\n      return this.observationTypes.filter(type => {\n        return !_includes(this.form.observation_types_ids, type.id) &&\n          type.name.toLowerCase().includes(this.observationTypeSearch.toLowerCase())\n      })\n    },\n\n    isIdentified() {\n      return !!(this.form.taxon_id || this.form.taxon_suggestion)\n    },\n\n    /**\n     * Check if identification is changed compared to the original observation.\n     * @return {Boolean}\n     */\n    identificationChanged() {\n      return this.form.taxon_id != this.observation.taxon_id ||\n        this.form.taxon_suggestion != this.observation.taxon_suggestion\n    },\n\n    usesAtlasCodes() {\n      return this.form.taxon ? this.form.taxon.uses_atlas_codes : false;\n    }\n  },\n\n  created() {\n    this.setDefaultObservationType()\n  },\n\n  methods: {\n    /**\n     * Create new form instance.\n     *\n     * @return {Form}\n     */\n    newForm() {\n      const observation = this.observation\n\n      // If crop is not set on existing photos, we can't crop them.\n      observation.photos.forEach(photo => {\n        photo.crop = null\n      })\n\n      return new Form({\n        ...observation,\n        observation_types_ids: observation.types.map(type => type.id),\n        reason: null\n      }, {\n        resetOnSuccess: false\n      })\n    },\n\n    /**\n     * Performa after submit without redirect is successful.\n     */\n    hookAfterSubmitWithoutRedirect() {\n      this.setDefaultObservationType()\n      this.clearPhotos()\n      // Focus on taxon autocomplete input.\n      this.$refs.taxonAutocomplete.focusOnInput()\n    },\n\n    /**\n     * Clear all photos.\n     */\n    clearPhotos() {\n      _range(1, 3).forEach(number => {\n        this.$refs[`photoUpload-${number}`].clearPhoto()\n      })\n    },\n\n    /**\n     * Handle taxon veing selected.\n     *\n     * @param {Object} value\n     */\n    onTaxonSelect(taxon) {\n      this.form.taxon = taxon || null\n      this.form.taxon_id = taxon ? taxon.id : null\n      this.form.taxon_suggestion = taxon ? taxon.name : null\n\n      const invalidStage = this.lastStageId && !_find(this.stages, stage => stage.id === this.lastStageId)\n\n      this.form.stage_id = invalidStage ? null : this.lastStageId\n\n      if (!this.usesAtlasCodes) {\n        this.form.atlas_code = null;\n      }\n\n      this.updateIdentifier()\n    },\n\n    /**\n     * Set time.\n     */\n    onTimeInput(value) {\n      this.form.time = value ? dayjs(value).format('HH:mm') : null\n    },\n\n    /**\n     * Add uploaded photo's filename to array.\n     *\n     * @param {String} file name\n     */\n    onPhotoUploaded(image) {\n      this.form.photos.push({\n\t\t\t\tpath: image.path,\n\t\t\t\tcrop: image.crop,\n\t\t\t\tlicense: image.license\n      })\n\n      const availableType = _find(this.availableObservationTypes, { slug: 'photographed' })\n\n      if (availableType) {\n        this.pushSelectedObservationType(availableType)\n      }\n\n      this.promptToExtractExifData(image)\n    },\n\n    /**\n     * Remove photo from form.\n     *\n     * @param {Object} image\n     */\n    onPhotoRemoved(image) {\n      _remove(this.form.photos, { path: image.path })\n\n      const selectedTypeIndex = _findIndex(this.selectedObservationTypes, { slug: 'photographed' })\n\n      if (!this.form.photos.length && selectedTypeIndex >= 0) {\n        const selectedObservationTypes = this.selectedObservationTypes\n\n        selectedObservationTypes.splice(selectedTypeIndex, 1)\n\n        this.selectedObservationTypes = selectedObservationTypes\n      }\n    },\n\n    /**\n     * Add/remove cropping information.\n     *\n     * @param {Object} image\n     */\n    onPhotoCropped(croppedImage) {\n      const photoIndex = _findIndex(this.form.photos, { path: croppedImage.path })\n\n      if (photoIndex >= 0) {\n        const photo = _cloneDeep(this.form.photos[photoIndex])\n\n        photo.crop = croppedImage.crop\n\n        this.form.photos.splice(photoIndex, 1, photo)\n      }\n    },\n\n    /**\n     * Get observation photo attribute.\n     *\n     * @param  {Number} [photoIndex=0]\n     * @param  {String} [attribute='url']\n     * @return {String}\n     */\n    getObservationPhotoAttribute(photoIndex = 0, attribute = 'url') {\n      let value = _get(this.observation, `photos.${photoIndex}.${attribute}`, '')\n\n      if (attribute === 'url' && value) {\n        const updated = dayjs(_get(this.observation, `photos.${photoIndex}.updated_at`, null))\n\n        value += updated.isValid() ? `?v=${updated.format('X')}` : ''\n      }\n\n      return value\n    },\n\n    /**\n     * Attributes to keep after submit without redirect.\n     *\n     * @return {Array}\n     */\n    getAttributesToKeep() {\n      return [\n        'location', 'accuracy', 'elevation', 'latitude', 'longitude',\n        'year', 'month', 'day', 'project', 'observer', 'observed_by',\n        'observed_by_id', 'data_license', 'image_license',\n      ]\n    },\n\n    /**\n     * Set tag search.\n     * @param {String} value\n     */\n    onTypeTyping(value) {\n      this.observationTypeSearch = value\n    },\n\n    /**\n     * Handle removing tags with backspace.\n     */\n    onTypeBackspace() {\n      if (this.shouldClearType) {\n        this.form.observation_types_ids.splice(-1, 1)\n        this.shouldClearType = false\n      } else if (!this.observationTypeSearch) {\n        this.shouldClearType = true\n      }\n    },\n\n    /**\n     * Add observation type to selections.\n     *\n     * @param  {Object} type\n     */\n    pushSelectedObservationType(type) {\n      const selectedObservationTypes = this.selectedObservationTypes\n\n      selectedObservationTypes.push(type)\n\n      this.selectedObservationTypes = selectedObservationTypes\n    },\n\n    /**\n     * Ask the user to use EXIF data to populate the fields.\n     *\n     * @param  {Object} image\n     */\n    promptToExtractExifData(image) {\n      if (this.exifExtracted || !image.exif) return\n\n      this.$buefy.dialog.confirm({\n        message: this.extractExifMessage(image).replace(/\\n/g, '<br>'),\n        cancelText: this.trans('No'),\n        confirmText: this.trans('Yes'),\n        onConfirm: () => { this.fillFromExif(image) },\n        onCancel: () => { this.exifExtracted = true }\n      })\n    },\n\n    /**\n     * Format message to use EXIF data from image.\n     */\n    extractExifMessage(image) {\n      const data = this.extractExifData(image)\n\n      return [\n        this.trans('Use data from photo to fill the form?') + \"\\n\",\n        ...Object.keys(data).map(key => `${this.trans('labels.field_observations.'+key)}: ${data[key]}`)\n      ].join(\"\\n\")\n    },\n\n    /**\n     * Extract EXIF data from image.\n     */\n    extractExifData(image) {\n      const data = {}\n\n      for (let exif in image.exif) {\n        let value = image.exif[exif]\n\n        if (value) {\n         data[exif] = value\n        }\n      }\n\n      return data\n    },\n\n    /**\n     * Fill the fields with EXIF data.\n     *\n     * @param  {Object} image\n     */\n    fillFromExif(image) {\n      const data = this.extractExifData(image)\n\n      for (const exif in data) {\n        this.form[exif] = data[exif]\n      }\n\n      this.exifExtracted = true\n    },\n\n    /**\n     * Select observer.\n     */\n    onObserverSelect(user) {\n      this.form.observed_by = user || null\n      this.form.observed_by_id = user ? user.id : null\n      this.form.observer = user ? user.full_name : null\n    },\n\n    /**\n     * Select identifier.\n     */\n    onIdentifierSelect(user) {\n      this.form.identified_by = user || null\n      this.form.identified_by_id = user ? user.id : null\n      this.form.identifier = user ? user.full_name : null\n    },\n\n    /**\n     * Set default observation type.\n     */\n    setDefaultObservationType() {\n      if (!this.selectedObservationTypes.length) {\n        this.pushSelectedObservationType(\n          _find(this.availableObservationTypes, { slug: 'observed' })\n        )\n      }\n    },\n\n    /**\n     * Update identifier based on identification change.\n     */\n    updateIdentifier() {\n      let identifier = this.observation.identified_by\n\n      if (this.identificationChanged) {\n        identifier = this.isIdentified ? window.App.User : null\n      }\n\n      this.onIdentifierSelect(identifier)\n    },\n\n    /**\n     * Change photo license.\n     *\n     * @param {Number} photoIndex\n     * @param {Number} license\n     */\n    onLicenseChanged(photoIndex, license) {\n      const photo = _cloneDeep(this.form.photos[photoIndex])\n\n      photo.license = license\n\n      this.form.photos[photoIndex] = photo\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FieldObservationForm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FieldObservationForm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FieldObservationForm.vue?vue&type=template&id=65c2e2ac&\"\nimport script from \"./FieldObservationForm.vue?vue&type=script&lang=js&\"\nexport * from \"./FieldObservationForm.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-field',{staticClass:\"nz-user-autocomplete\",attrs:{\"label\":_vm.label,\"type\":_vm.error ? 'is-danger' : null,\"message\":_vm.message}},[_c('b-field',{attrs:{\"grouped\":\"\"}},[_c('b-autocomplete',{attrs:{\"value\":_vm.value,\"data\":_vm.data,\"field\":\"full_name\",\"loading\":_vm.loading,\"icon\":_vm.icon,\"placeholder\":_vm.placeholder,\"expanded\":\"\",\"autofocus\":_vm.autofocus,\"disabled\":_vm.disabled},on:{\"input\":_vm.onInput,\"select\":_vm.onSelect},scopedSlots:_vm._u([{key:\"default\",fn:function(props){return [_c('div',{staticClass:\"media\"},[_c('div',{staticClass:\"media-content\"},[_vm._v(\"\\n            \"+_vm._s(props.option.full_name)+\" \"),_c('small',[_vm._v(\"<\"+_vm._s(props.option.email)+\">\")])])])]}}])})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <b-field :label=\"label\" class=\"nz-user-autocomplete\" :type=\"error ? 'is-danger' : null\" :message=\"message\">\n    <b-field grouped>\n      <b-autocomplete\n        :value=\"value\"\n        :data=\"data\"\n        field=\"full_name\"\n        :loading=\"loading\"\n        @input=\"onInput\"\n        @select=\"onSelect\"\n        :icon=\"icon\"\n        :placeholder=\"placeholder\"\n        expanded\n        :autofocus=\"autofocus\"\n        :disabled=\"disabled\"\n      >\n        <template slot-scope=\"props\">\n          <div class=\"media\">\n            <div class=\"media-content\">\n              {{ props.option.full_name }} <small>&lt;{{ props.option.email }}&gt;</small>\n            </div>\n          </div>\n        </template>\n\n      </b-autocomplete>\n    </b-field>\n  </b-field>\n</template>\n\n<script>\nimport axios from 'axios'\nimport _debounce from 'lodash/debounce'\nimport _get from 'lodash/get'\n\nexport default {\n  name: 'nzUserAutocomplete',\n\n  props: {\n    label: {\n      type: String,\n      default: 'User'\n    },\n    placeholder: {\n      type: String,\n      default: 'Search for user...'\n    },\n    user: {\n      type: Object,\n      default: null\n    },\n    route: {\n      type: String,\n      default: 'api.autocomplete.users.index'\n    },\n    value: {\n      type: String,\n      default: ''\n    },\n    error: Boolean,\n    message: {\n      type: String,\n      default: null\n    },\n    except: {},\n    autofocus: Boolean,\n    disabled: Boolean\n  },\n\n  data() {\n    return {\n      data: [],\n      selected: this.user || null,\n      loading: false\n    }\n  },\n\n  computed: {\n    icon() {\n      return this.selected ? 'check' : null\n    }\n  },\n\n  watch: {\n    user(value) {\n      this.selected = value\n    }\n  },\n\n  methods: {\n    fetchData: _debounce(function() {\n      if (!this.value) return\n\n      this.data = []\n      this.loading = true\n\n      let params = {\n        name: this.value,\n      }\n\n      if (this.except) {\n        params.except = this.except\n      }\n\n      axios.get(route(this.route), { params }).then(({ data }) => {\n        data.data.forEach((item) => this.data.push(item))\n        this.loading = false\n      }, response => {\n        this.loading = false\n      })\n    }, 500),\n\n    onSelect(user) {\n      this.selected = user\n\n      this.$emit('select', user)\n    },\n\n    onInput(value) {\n      const currentValue = this.getValue(this.selected)\n      if (currentValue && currentValue !== value) {\n        this.onSelect(null)\n      }\n\n      this.$emit('input', value)\n\n      this.fetchData()\n    },\n\n    focusOnInput() {\n      this.$el.querySelector('input').focus()\n    },\n\n    /**\n     * Return display text for the input.\n     * If object, get value from path, or else just the value.\n     */\n    getValue(option) {\n      if (!option) return\n\n      return typeof option === 'object'\n        ? _get(option, 'full_name')\n        : option\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserAutocomplete.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserAutocomplete.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserAutocomplete.vue?vue&type=template&id=5566d9c1&\"\nimport script from \"./UserAutocomplete.vue?vue&type=script&lang=js&\"\nexport * from \"./UserAutocomplete.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"spatial-input\"},[_c('b-field',{staticClass:\"is-required\",attrs:{\"label\":_vm.trans('labels.field_observations.map')}},[_c('gmap-map',{staticStyle:{\"width\":\"100%\",\"min-height\":\"400px\"},attrs:{\"center\":_vm.centerCoordinates,\"zoom\":_vm.center.zoom,\"options\":{streetViewControl:false}},on:{\"click\":_vm.setMarker,\"zoom_changed\":_vm.onZoomChanged}},[_c('gmap-marker',{attrs:{\"position\":_vm.position,\"clickable\":true,\"draggable\":true},on:{\"dragend\":_vm.setMarker}}),_vm._v(\" \"),(_vm.position && _vm.newAccuracy)?_c('gmap-circle',{attrs:{\"center\":_vm.position,\"radius\":_vm.newAccuracy,\"editable\":true,\"options\":{ strokeWeight: .75 }},on:{\"radius_changed\":_vm.updateRadius}}):_vm._e()],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"has-text-right\"},[(_vm.mapHasErrors)?_c('span',{staticClass:\"has-text-danger is-size-7\"},[_vm._v(_vm._s(_vm.trans('Some fields have errors')))]):_vm._e(),_vm._v(\" \"),_c('button',{staticClass:\"button is-white is-small is-text\",class:{'has-text-danger': _vm.mapHasErrors},attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.showDetails = !_vm.showDetails}}},[_vm._v(_vm._s(_vm.trans('labels.field_observations.details')))])]),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showDetails),expression:\"showDetails\"}]},[_c('div',{staticClass:\"field is-grouped\"},[_c('div',{staticClass:\"field is-expanded is-required\"},[_c('label',{staticClass:\"label is-small\"},[_vm._v(_vm._s(_vm.trans('labels.field_observations.latitude')))]),_vm._v(\" \"),_c('div',{staticClass:\"control is-fullwidth\"},[_c('input',{staticClass:\"input is-small\",class:{'is-danger': _vm.errors.has('latitude')},attrs:{\"placeholder\":\"f.e. 42.5234\"},domProps:{\"value\":_vm.latitude},on:{\"input\":_vm.onLatitudeInput}})]),_vm._v(\" \"),(_vm.errors.has('latitude'))?_c('p',{staticClass:\"help is-danger\",domProps:{\"textContent\":_vm._s(_vm.errors.first('latitude'))}}):_vm._e()]),_vm._v(\" \"),_c('div',{staticClass:\"field is-expanded is-required\"},[_c('label',{staticClass:\"label is-small\"},[_vm._v(_vm._s(_vm.trans('labels.field_observations.longitude')))]),_vm._v(\" \"),_c('div',{staticClass:\"control is-fullwidth\"},[_c('input',{staticClass:\"input is-small\",class:{'is-danger': _vm.errors.has('longitude')},attrs:{\"placeholder\":\"f.e. 19.1234\"},domProps:{\"value\":_vm.longitude},on:{\"input\":_vm.onLongitudeInput}})]),_vm._v(\" \"),(_vm.errors.has('longitude'))?_c('p',{staticClass:\"help is-danger\",domProps:{\"textContent\":_vm._s(_vm.errors.first('longitude'))}}):_vm._e()])]),_vm._v(\" \"),_c('div',{staticClass:\"field is-grouped\"},[_c('div',{staticClass:\"field is-expanded\"},[_c('label',{staticClass:\"label is-small\"},[_vm._v(_vm._s(_vm.trans('labels.field_observations.accuracy_m')))]),_vm._v(\" \"),_c('div',{staticClass:\"control is-fullwidth\"},[_c('input',{staticClass:\"input is-small\",attrs:{\"placeholder\":\"f.e. 100\"},domProps:{\"value\":_vm.accuracy},on:{\"input\":_vm.onAccuracyInput}})]),_vm._v(\" \"),(_vm.errors.has('accuracy'))?_c('p',{staticClass:\"help is-danger\",domProps:{\"textContent\":_vm._s(_vm.errors.first('accuracy'))}}):_vm._e()]),_vm._v(\" \"),_c('div',{staticClass:\"field is-expanded is-required\"},[_c('label',{staticClass:\"label is-small\"},[_vm._v(_vm._s(_vm.trans('labels.field_observations.elevation_m')))]),_vm._v(\" \"),_c('div',{staticClass:\"control is-fullwidth\"},[_c('input',{staticClass:\"input is-small\",attrs:{\"placeholder\":\"f.e. 500\"},domProps:{\"value\":_vm.elevation},on:{\"input\":_vm.onElevationInput}})]),_vm._v(\" \"),(_vm.errors.has('elevation'))?_c('p',{staticClass:\"help is-danger\",domProps:{\"textContent\":_vm._s(_vm.errors.first('elevation'))}}):_vm._e()])]),_vm._v(\" \"),_c('div',{staticClass:\"field is-expanded\"},[_c('label',{staticClass:\"label is-small\"},[_vm._v(_vm._s(_vm.trans('labels.field_observations.location')))]),_vm._v(\" \"),_c('div',{staticClass:\"control is-fullwidth\"},[_c('input',{staticClass:\"input is-small\",class:{'is-danger': _vm.errors.has('location')},attrs:{\"placeholder\":\"Location\"},domProps:{\"value\":_vm.location},on:{\"input\":_vm.onLocationInput}})]),_vm._v(\" \"),(_vm.errors.has('location'))?_c('p',{staticClass:\"help is-danger\",domProps:{\"textContent\":_vm._s(_vm.errors.first('location'))}}):_vm._e()]),_vm._v(\" \"),_vm._t(\"default\")],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpatialInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpatialInput.vue?vue&type=script&lang=js&\"","<template>\n  <div class=\"spatial-input\">\n    <b-field :label=\"trans('labels.field_observations.map')\" class=\"is-required\">\n      <gmap-map\n        style=\"width: 100%; min-height: 400px\"\n        :center=\"centerCoordinates\"\n        :zoom=\"center.zoom\"\n        @click=\"setMarker\"\n        @zoom_changed=\"onZoomChanged\"\n        :options=\"{streetViewControl:false}\"\n      >\n        <gmap-marker\n          :position=\"position\"\n          :clickable=\"true\"\n          :draggable=\"true\"\n          @dragend=\"setMarker\"\n        />\n\n        <gmap-circle\n          v-if=\"position && newAccuracy\"\n          :center=\"position\"\n          :radius=\"newAccuracy\"\n          :editable=\"true\"\n          @radius_changed=\"updateRadius\"\n          :options=\"{ strokeWeight: .75 }\"\n        />\n      </gmap-map>\n    </b-field>\n\n    <div class=\"has-text-right\">\n      <span v-if=\"mapHasErrors\" class=\"has-text-danger is-size-7\">{{ trans('Some fields have errors') }}</span>\n\n      <button type=\"button\" class=\"button is-white is-small is-text\" :class=\"{'has-text-danger': mapHasErrors}\" @click=\"showDetails = !showDetails\">{{ trans('labels.field_observations.details') }}</button>\n    </div>\n\n    <div v-show=\"showDetails\">\n      <div class=\"field is-grouped\">\n        <div class=\"field is-expanded is-required\">\n          <label class=\"label is-small\">{{ trans('labels.field_observations.latitude') }}</label>\n\n          <div class=\"control is-fullwidth\">\n            <input class=\"input is-small\" :class=\"{'is-danger': errors.has('latitude')}\" :value=\"latitude\" @input=\"onLatitudeInput\" placeholder=\"f.e. 42.5234\">\n          </div>\n\n          <p class=\"help is-danger\" v-if=\"errors.has('latitude')\" v-text=\"errors.first('latitude')\"></p>\n        </div>\n\n        <div class=\"field is-expanded is-required\">\n          <label class=\"label is-small\">{{ trans('labels.field_observations.longitude') }}</label>\n\n          <div class=\"control is-fullwidth\">\n            <input class=\"input is-small\" :class=\"{'is-danger': errors.has('longitude')}\" :value=\"longitude\" @input=\"onLongitudeInput\" placeholder=\"f.e. 19.1234\">\n          </div>\n\n          <p class=\"help is-danger\" v-if=\"errors.has('longitude')\" v-text=\"errors.first('longitude')\"></p>\n        </div>\n      </div>\n\n      <div class=\"field is-grouped\">\n        <div class=\"field is-expanded\">\n          <label class=\"label is-small\">{{ trans('labels.field_observations.accuracy_m') }}</label>\n\n          <div class=\"control is-fullwidth\">\n            <input class=\"input is-small\" :value=\"accuracy\" @input=\"onAccuracyInput\" placeholder=\"f.e. 100\">\n          </div>\n\n          <p class=\"help is-danger\" v-if=\"errors.has('accuracy')\" v-text=\"errors.first('accuracy')\"></p>\n        </div>\n\n        <div class=\"field is-expanded is-required\">\n          <label class=\"label is-small\">{{ trans('labels.field_observations.elevation_m') }}</label>\n\n          <div class=\"control is-fullwidth\">\n            <input class=\"input is-small\" :value=\"elevation\" @input=\"onElevationInput\" placeholder=\"f.e. 500\">\n          </div>\n\n          <p class=\"help is-danger\" v-if=\"errors.has('elevation')\" v-text=\"errors.first('elevation')\"></p>\n        </div>\n      </div>\n\n      <div class=\"field is-expanded\">\n        <label class=\"label is-small\">{{ trans('labels.field_observations.location') }}</label>\n\n        <div class=\"control is-fullwidth\">\n          <input class=\"input is-small\" :class=\"{'is-danger': errors.has('location')}\" :value=\"location\" @input=\"onLocationInput\" placeholder=\"Location\">\n        </div>\n\n        <p class=\"help is-danger\" v-if=\"errors.has('location')\" v-text=\"errors.first('location')\"></p>\n      </div>\n\n      <slot />\n    </div>\n  </div>\n</template>\n\n<script>\nimport _debounce from 'lodash/debounce'\n\nconst ZOOM_ONE = 6144000\n\nexport default {\n  name: 'nzSpatialInput',\n\n  props: {\n    accuracy: Number,\n    elevation: {\n      type: Number,\n      default: 100\n    },\n    latitude: {\n      type: Number,\n      default: 41.0\n    },\n    longitude: {\n      type: Number,\n      default: 19.0\n    },\n    location: {\n      type: [String, Number],\n      default: ''\n    },\n    errors: {\n      type: Object,\n      default() {\n        return {}\n      }\n    },\n    hasOtherErrors: {\n      type: Boolean,\n      default: false\n    }\n  },\n\n  data() {\n    return {\n      emptyAccuracy: this.calculateEmptyAccuracy(window.App.gmaps.center.zoom),\n      showDetails: false,\n      elevationService: null,\n      center: window.App.gmaps.center\n    }\n  },\n\n  computed: {\n    /**\n     * Position object from coordinates.\n     *\n     * @return {Object}\n     */\n    position() {\n      if (!this.coordinatesSet) {\n        return null\n      }\n\n      return {lat: this.latitude, lng: this.longitude}\n    },\n\n    /**\n     * Check if coordinate are set.\n     *\n     * @return {Boolean}\n     */\n    coordinatesSet() {\n      return !(isNaN(this.latitude)||\n        this.latitude === null ||\n        isNaN(this.longitude) ||\n        this.longitude === null\n      )\n    },\n\n    /**\n     * Check if any of the fields has an error.\n     *\n     * @return {Boolean}\n     */\n    mapHasErrors() {\n      return this.hasOtherErrors ||\n          this.errors.has('latitude') ||\n          this.errors.has('longitude') ||\n          this.errors.has('elevation') ||\n          this.errors.has('accuracy') ||\n          this.errors.has('location')\n    },\n\n    newAccuracy () {\n      return this.accuracy || this.emptyAccuracy\n    },\n\n    centerCoordinates() {\n      return this.position || {\n        lat: this.center.latitude,\n        lng: this.center.longitude\n      }\n    }\n  },\n\n  watch: {\n    /**\n     * Get elevation when coordinates change.\n     */\n    position(value) {\n      if (this.coordinatesSet) {\n        this.getElevation(value)\n      }\n    },\n  },\n\n  created() {\n    this.setCurrentLocationAsMapCenter()\n  },\n\n  methods: {\n    /**\n     * Cast to number or null.\n     *\n     * @param  {any} value\n     * @return {Number}\n     */\n    castNumber(value) {\n      return isNaN(value) || value === '' ? null : Number(value)\n    },\n\n    /**\n     * Handle location input.\n     * @param {Object} event\n     */\n    onLocationInput(event) {\n      this.updateLocation(event.target.value)\n    },\n\n    /**\n     * Sync location property.\n     *\n     * @param {String} value\n     */\n    updateLocation(value) {\n      this.$emit('update:location', value)\n    },\n\n    /**\n     * Handle longitude input.\n     * @param  {[type]} event [description]\n     * @return {[type]}       [description]\n     */\n    onLongitudeInput: _debounce(function (event) {\n      this.updateLongitude(event.target.value)\n    }, 1000),\n\n    /**\n     * Sync longitude property.\n     *\n     * @param {Number} value\n     */\n    updateLongitude(value) {\n      this.$emit('update:longitude', this.castNumber(value))\n    },\n\n    /**\n     * Handle latitude input.\n     *\n     * @param {Object} event\n     */\n    onLatitudeInput: _debounce(function (event) {\n      this.updateLatitude(event.target.value)\n    }, 1000),\n\n    /**\n     * Sync latitude property.\n     *\n     * @param {Number} value\n     */\n    updateLatitude(value) {\n      this.$emit('update:latitude', this.castNumber(value))\n    },\n\n    /**\n    * Handle accuracy input.\n    *\n    * @param {Object} event\n    */\n    onAccuracyInput: _debounce(function (event) {\n      this.updateAccuracy(event.target.value)\n    }, 1000),\n\n    /**\n     * Sync accuracy property.\n     *\n     * @param {Number} value\n     */\n    updateAccuracy(value) {\n      this.$emit('update:accuracy', this.castNumber(value))\n    },\n\n    /**\n     * Handle elevation input.\n     *\n     * @param {Object} event\n     */\n    onElevationInput(event) {\n      this.updateElevation(event.target.value)\n    },\n\n    /**\n     * Sync elevation property.\n     *\n     * @param {Number} value\n     */\n    updateElevation(value) {\n      this.$emit('update:elevation', this.castNumber(value))\n    },\n\n    /**\n     * Update coordinates from marker position.\n     *\n     * @param {Object} position\n     */\n    setMarker(position) {\n      let lat = position.latLng.lat()\n      let lng = position.latLng.lng()\n\n      this.updateLatitude(lat)\n      this.updateLongitude(lng)\n    },\n\n    /**\n     * Update accuracy from circle radius on gmaps.\n     *\n     * @param  {Number} value\n     */\n    updateRadius(value) {\n      let radius = parseInt(value)\n\n      if (this.accuracy === null && radius === this.emptyAccuracy) {\n        return\n      }\n\n      this.updateAccuracy(radius)\n    },\n\n    /**\n     * Get elevation using Google's service.\n     *\n     * @param  {Object} position\n     */\n    getElevation(position) {\n      // Do nothing if we still don't have gmaps library loaded.\n      if (!google || !google.maps || !google.maps.ElevationService) {\n        return\n      }\n\n      // We don't initialize service when component is created\n      // because Gmap library probably isn't loaded yet,\n      // so we do it on first use of this method.\n      if (!this.elevationService) {\n        this.elevationService = new google.maps.ElevationService()\n      }\n\n      this.elevationService.getElevationForLocations({\n        locations: [position]\n      }, (results, status) => {\n        if (status != google.maps.ElevationStatus.OK || !results.length) {\n          return\n        }\n\n        const elevation = parseInt(results[0].elevation)\n\n        this.$emit('elevation-fetched', elevation)\n\n        this.updateElevation(elevation)\n      })\n    },\n\n    /**\n     * Recalculate default accuracy when zoom is changed.\n     * @param  {Number} zoom\n     */\n    onZoomChanged(zoom) {\n      this.emptyAccuracy = this.calculateEmptyAccuracy(zoom)\n    },\n\n    /**\n     * Calculate accuracy based on map zoom.\n     * @param  {Number} zoom\n     * @return {Number}\n     */\n    calculateEmptyAccuracy(zoom) {\n      return parseInt(ZOOM_ONE / Math.pow(2, zoom))\n    },\n\n    /**\n     * Use browser location to set map center.\n     */\n    setCurrentLocationAsMapCenter() {\n      // We don't want to use this feature if the marker is set.\n      if (!navigator.geolocation || this.position) {\n        return\n      }\n\n      navigator.geolocation.getCurrentPosition(position => {\n        if (this.position) {\n          return\n        }\n\n        this.center.latitude = position.coords.latitude\n        this.center.longitude = position.coords.longitude\n        this.center.zoom = 10\n      })\n    }\n  }\n}\n</script>\n","import { render, staticRenderFns } from \"./SpatialInput.vue?vue&type=template&id=6d8e5d56&\"\nimport script from \"./SpatialInput.vue?vue&type=script&lang=js&\"\nexport * from \"./SpatialInput.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Form from 'form-backend-validation'\nimport _pick from 'lodash/pick'\nimport _get from 'lodash/get'\nimport _isEqual from 'lodash/isEqual'\n\n\nexport default {\n  name: 'nzFieldObservationForm',\n\n  props: {\n    action: {\n      type: String,\n      required: true\n    },\n\n    method: {\n      type: String,\n      default: 'POST'\n    },\n\n    redirectUrl: String,\n    cancelUrl: String,\n\n    submitMore: Boolean,\n    shouldConfirmSubmit: Boolean,\n    confirmSubmitMessage: {\n      type: String,\n      default() {\n        return this.trans('You are about to submit')\n      }\n    },\n    shouldAskReason: Boolean,\n    shouldConfirmCancel: Boolean,\n    submitOnlyDirty: Boolean,\n    submitOnlyDirtyMessage: {\n      type: String,\n      default() {\n        return this.trans('There are no changes, the data will not be saved.')\n      }\n    }\n  },\n\n  data() {\n    return {\n      form: this.newForm(),\n      keepAfterSubmit: [],\n      submittingWithRedirect: false,\n      submittingWithoutRedirect: false,\n      confirmingSubmit: false,\n      confirmingCancel: false,\n      locale: window.App.locale\n    }\n  },\n\n  created() {\n    document.addEventListener('keyup', this.registerKeyListener)\n  },\n\n  beforeDestroy() {\n    document.removeEventListener('keyup', this.registerKeyListener)\n  },\n\n  methods: {\n    /**\n     * Create new form instance.\n     *\n     * @param  {Object} data default form data\n     * @return {Form}\n     */\n    newForm(data = {}) {\n      return new Form(data, {\n        resetOnSuccess: false\n      })\n    },\n\n    /**\n     * Keyboard shortcuts.\n     *\n     * @param {Event} e\n     */\n    registerKeyListener(e) {\n      const enter = 13 === (e.which || e.keyCode)\n\n      if (e.ctrlKey && e.shiftKey && enter) {\n        this.submitMore && this.submitWithoutRedirect()\n      } else if (e.ctrlKey && enter) {\n        this.submitWithRedirect()\n      }\n    },\n\n    /**\n     * Confirm submit.\n     *\n     * @param {Function} onConfirm\n     */\n    confirmSubmit(onConfirm) {\n      if (this.confirmingSubmit) return\n\n      this.confirmingSubmit = true\n\n      const options = {\n        message: this.confirmSubmitMessage,\n        confirmText: this.trans('buttons.save'),\n        cancelText: this.trans('buttons.cancel'),\n        onConfirm,\n        onCancel: () => { this.confirmingSubmit = false }\n      }\n\n      if (!this.shouldAskReason) {\n        return this.$buefy.dialog.confirm(options)\n      }\n\n      return this.promptForReason(options)\n    },\n\n    /**\n     * Prompt the user for reason of change.\n     *\n     * @param  {Object} options\n     * @return {Vue}\n     */\n    promptForReason(options) {\n      const dialog = this.$buefy.dialog.prompt({\n        ...options,\n        inputAttrs: {\n            placeholder: this.trans('Reason'),\n            required: true,\n            maxlength: 255\n        }\n      })\n\n      // Custom localized validation for the prompt input.\n      dialog.$nextTick(() => {\n        dialog.$refs.input.addEventListener('invalid', (e) => {\n          e.target.setCustomValidity('')\n\n          if (!e.target.validity.valid) {\n            e.target.setCustomValidity(this.trans('This field is required and can contain max 255 chars.'))\n          }\n        })\n\n        dialog.$refs.input.addEventListener('input', (e) => {\n          dialog.validationMessage = null\n        })\n      })\n\n      return dialog\n    },\n\n    /**\n     * Notify the user there are no changes.\n     */\n    notifyNoChanges() {\n      this.$buefy.toast.open({\n        message: this.submitOnlyDirtyMessage,\n        type: 'is-info'\n      })\n    },\n\n    /**\n     * Notify the user there are no changes and redirect.\n     */\n    notifyNoChangesAndRedirect() {\n      this.notifyNoChanges()\n\n      setTimeout(() => {\n        if (this.redirectUrl) {\n          window.location.href = this.redirectUrl\n        }\n      }, 500)\n    },\n\n    /**\n     * Submit the form with redirect.\n     */\n    submitWithRedirect() {\n      if (this.form.processing) return\n\n      if (this.submitOnlyDirty && !this.isDirty()) return this.notifyNoChangesAndRedirect()\n\n      if (this.shouldConfirmSubmit) return this.confirmSubmit(this.performSubmitWithRedirect)\n\n      this.performSubmitWithRedirect()\n    },\n\n    /**\n     * Submit the form with redirect.\n     */\n    performSubmitWithRedirect(reason = null) {\n      this.submittingWithRedirect = true\n      this.confirmingSubmit = false\n\n      if (this.shouldAskReason) {\n        this.form.reason = reason\n      }\n\n      this.form[this.method.toLowerCase()](this.action)\n          .then(this.onSuccessfulSubmitWithRedirect)\n          .catch(this.onFailedSubmit)\n    },\n\n    /**\n     * Handle successful form submit with redirect.\n     */\n    onSuccessfulSubmitWithRedirect() {\n      this.form.processing = true\n\n      this.$buefy.toast.open({\n        message: this.trans('Saved successfully'),\n        type: 'is-success'\n      })\n\n      // We want to wait a bit before we send the user to redirect route\n      // so we can show the message that the action was successful.\n      setTimeout(() => {\n        this.form.processing = false\n        this.submittingWithRedirect = false\n\n        this.hookAfterSubmitWithRedirect()\n\n        if (this.redirectUrl) {\n          window.location.href = this.redirectUrl\n        }\n      }, 500)\n    },\n\n    /**\n     * Perform after submit with redirect is successful.\n     */\n    hookAfterSubmitWithRedirect() {},\n\n    /**\n     * Submit the form and stay to add more.\n     */\n    submitWithoutRedirect() {\n      if (this.form.processing) return\n\n      if (this.submitOnlyDirty  && !this.isDirty()) return this.notifyNoChanges()\n\n      if (this.shouldConfirmSubmit) return this.confirmSubmit(this.performSubmitWithoutRedirect)\n\n      this.performSubmitWithoutRedirect()\n    },\n\n    /**\n     * Submit the form and stay to add more.\n     */\n    performSubmitWithoutRedirect(reason = null) {\n      this.submittingWithoutRedirect = true\n      this.confirmingSubmit = false\n\n      if (this.shouldAskReason) {\n        this.form.reason = reason\n      }\n\n      this.form[this.method.toLowerCase()](this.action)\n          .then(this.onSuccessfulSubmitWithoutRedirect)\n          .catch(this.onFailedSubmit)\n    },\n\n    /**\n     * Handle successful form submit with no redirect.\n     */\n    onSuccessfulSubmitWithoutRedirect() {\n      this.submittingWithoutRedirect = false\n\n      this.$buefy.toast.open({\n        message: this.trans('Saved successfully'),\n        type: 'is-success'\n      })\n\n      // Reset the form but remember some data.\n      const keep = _pick(this.form.data(), this.keepAfterSubmit)\n      this.form.reset()\n      this.form.populate(keep)\n\n      this.hookAfterSubmitWithoutRedirect()\n    },\n\n    /**\n     * Perform after submit without redirect is successful.\n     */\n    hookAfterSubmitWithoutRedirect() {},\n\n    /**\n     * Handle failed form submit.\n     *\n     * @param {Error} error\n     */\n    onFailedSubmit(error) {\n      this.submittingWithRedirect = false\n      this.submittingWithoutRedirect = false\n\n      this.$buefy.toast.open({\n        duration: 2500,\n        message: _get(error, 'response.data.message', error.message),\n        type: 'is-danger'\n      })\n    },\n\n    /**\n     * Check if form is changed.\n     *\n     * @return {Boolean}\n     */\n    isDirty() {\n      return ! _isEqual(this.form.data(), this.form.initial)\n    },\n\n    /**\n     * Confirmation dialog for canceling.\n     */\n    confirmCancel() {\n      if (this.confirmingCancel) return\n\n      this.confirmingCancel = true\n\n      this.$buefy.dialog.confirm({\n        message: this.trans('If you leave this page changes will not be saved.'),\n        onConfirm: () => {\n          this.confirmingCancel = false\n          window.location.href = this.cancelUrl\n        },\n        onCancel: () => { this.confirmingCancel = false },\n        cancelText: this.trans('buttons.stay_on_page'),\n        confirmText: this.trans('buttons.leave_page'),\n      })\n    },\n\n    /**\n     * Handle cancel button/link.\n     *\n     * @param {Event} event\n     */\n    onCancel(event) {\n      if (this.shouldConfirmCancel && this.isDirty()) {\n        event.preventDefault()\n\n        this.confirmCancel()\n      }\n    }\n  }\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (!_vm.haveImage)?_c('b-field',{attrs:{\"message\":_vm.error || null,\"type\":_vm.error ? 'is-danger' : null,\"expanded\":\"\"}},[_c('b-upload',{attrs:{\"drag-drop\":\"\",\"expanded\":\"\",\"disabled\":_vm.uploading || _vm.loading},on:{\"input\":_vm.onInput}},[_c('section',{ref:\"uploadZone\",staticClass:\"section is-relative\"},[_c('div',{staticClass:\"has-text-centered\"},[_c('div',[_c('b-icon',{attrs:{\"icon\":\"upload\",\"size\":\"is-medium\"}})],1),_vm._v(\" \"),(_vm.uploading)?_c('progress',{staticClass:\"progress is-primary is-small\",attrs:{\"max\":\"100\"},domProps:{\"value\":_vm.progress}},[_vm._v(_vm._s(_vm.progress)+\"%\")]):(_vm.loading)?_c('div',[_vm._v(_vm._s(_vm.trans('Loading...')))]):_c('div',[_vm._v(_vm._s(_vm.text))])])])])],1):_c('div',{staticClass:\"card\"},[_c('div',{staticClass:\"card-image\"},[_c('figure',{staticClass:\"has-magnifier has-text-centered\",on:{\"click\":function($event){_vm.showModal = true}}},[_c('img',{staticClass:\"max-h-36\",attrs:{\"src\":_vm.thumbnailUrl,\"alt\":\"Uploaded photo\"}}),_vm._v(\" \"),_c('div',{staticClass:\"image-magnifier\"},[_c('b-icon',{attrs:{\"icon\":\"expand\",\"size\":\"is-medium\"}})],1)])]),_vm._v(\" \"),(_vm.haveImage)?_c('footer',{staticClass:\"card-footer\"},[_c('div',{staticClass:\"card-footer-item flex-col\"},[_c('div',{staticClass:\"mb-4 w-full flex justify-between\"},[(_vm.withCrop)?_c('button',{staticClass:\"button is-outlined is-small mr-2\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.openCropModal,\"close\":_vm.closeCropModal}},[_c('b-icon',{attrs:{\"icon\":\"crop\"}})],1):_vm._e(),_vm._v(\" \"),(_vm.image.path || _vm.hasExisting)?_c('button',{staticClass:\"delete is-danger is-medium\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.remove}}):_vm._e()]),_vm._v(\" \"),(_vm.withLicense)?_c('div',{staticClass:\"w-full\"},[_c('b-select',{attrs:{\"value\":_vm.image.license,\"expanded\":\"\"},on:{\"input\":_vm.handleLicenseChanged}},[_c('option',{domProps:{\"value\":null}},[_vm._v(_vm._s(_vm.trans('labels.field_observations.default')))]),_vm._v(\" \"),_vm._l((_vm.licenses),function(label,value){return _c('option',{key:value,domProps:{\"value\":value,\"textContent\":_vm._s(label)}})})],2)],1):_vm._e()])]):_vm._e(),_vm._v(\" \"),(_vm.haveImage)?_c('nz-image-crop-modal',{attrs:{\"active\":_vm.showCropModal,\"crop\":_vm.image.crop,\"image-url\":_vm.image.url},on:{\"update:active\":function($event){_vm.showCropModal=$event},\"update:crop\":function($event){return _vm.$set(_vm.image, \"crop\", $event)}}}):_vm._e(),_vm._v(\" \"),(_vm.showModal)?_c('nz-image-modal',{attrs:{\"items\":[_vm.thumbnailUrl]},on:{\"close\":function($event){_vm.showModal = false}}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import BaseCroppr from 'croppr'\nimport Box from 'croppr/src/box'\n\nexport default class Croppr extends BaseCroppr {\n  setBoxToRealPosition(value) {\n    const actualWidth = this.imageEl.naturalWidth\n    const actualHeight = this.imageEl.naturalHeight\n    const factorX = actualWidth / this.imageEl.offsetWidth\n    const factorY = actualHeight / this.imageEl.offsetHeight\n\n    this.box = new Box(\n      Math.round(value.x / factorX),\n      Math.round(value.y / factorY),\n      Math.round((value.x + value.width) / factorX),\n      Math.round((value.y + value.height) / factorY)\n    )\n\n    this.redraw()\n  }\n}\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageCropModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageCropModal.vue?vue&type=script&lang=js&\"","<template>\n  <transition :name=\"animation\">\n    <div v-if=\"isActive\" class=\"modal is-active\">\n      <div class=\"modal-background\"/>\n\n      <div\n        class=\"animation-content modal-content\"\n        :style=\"{ maxWidth: newWidth }\"\n      >\n        <img\n          :src=\"imageUrl\"\n          class=\"image\"\n          alt=\"Cropped image\"\n          ref=\"cropModalImage\"\n        >\n      </div>\n\n      <button\n        type=\"button\"\n        class=\"modal-close is-large\"\n        @click=\"cancel('x')\"\n      />\n\n      <button\n        type=\"button\"\n        class=\"modal-action\"\n        @click=\"cropImage\"\n      >\n        <b-icon icon=\"check\"/>\n      </button>\n    </div>\n  </transition>\n</template>\n\n<script>\nimport Croppr from '@/Croppr'\nimport bModal from 'buefy/src/components/modal/Modal'\n\nexport default {\n  name: 'nzImageCropModal',\n\n  mixins: [bModal],\n\n  props: {\n    canCancel: {\n      type: [Array, Boolean],\n      default: () => ['escape', 'x']\n    },\n    imageUrl: String,\n    crop: Object\n  },\n\n  data() {\n    return {\n\t\t\tcroppr: null,\n      newCrop: this.crop,\n      preserveRatio: false\n    }\n  },\n\n  mounted() {\n    document.addEventListener('keydown', this.ctrlIsPressed)\n    document.addEventListener('keyup', this.ctrlIsNotPressed)\n  },\n\n  beforeDestroy() {\n    document.removeEventListener('keydown', this.ctrlIsPressed)\n    document.removeEventListener('keyup', this.ctrlIsNotPressed)\n  },\n\n  watch: {\n    isActive(value) {\n      this.handleScroll()\n\n      this.croppr =  null\n\n      if (value) {\n        this.$nextTick(() => {\n          this.croppr = new Croppr(this.$refs.cropModalImage, {\n            onCropEnd: (value) => {\n              this.newCrop = value\n            },\n\n            onInitialize: (croppr) => {\n              if (this.newCrop) {\n                croppr.setBoxToRealPosition(this.newCrop)\n              }\n            }\n          })\n        })\n      }\n    }\n  },\n\n  methods: {\n    handleScroll() {\n      if (typeof window === 'undefined') return\n\n      this.savedScrollTop = !this.savedScrollTop\n        ? document.documentElement.scrollTop\n        : this.savedScrollTop\n\n      document.body.classList.toggle('is-noscroll', this.isActive)\n\n      if (this.isActive) {\n        document.body.style.top = `-${this.savedScrollTop}px`\n        return\n      }\n\n      document.documentElement.scrollTop = this.savedScrollTop\n      document.body.style.top = null\n      this.savedScrollTop = null\n    },\n\n    cropImage() {\n      this.$emit('update:crop', this.newCrop)\n\n      this.close()\n    },\n\n    ctrlIsPressed(e) {\n      if (e.which == 17 && this.croppr) {\n        this.croppr.options.aspectRatio = this.croppr.box.height() / this.croppr.box.width()\n      }\n    },\n\n    ctrlIsNotPressed(e) {\n      if (e.which == 17  && this.croppr) {\n        this.croppr.options.aspectRatio = null\n      }\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PhotoUpload.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PhotoUpload.vue?vue&type=script&lang=js&\"","<template>\n\t<b-field v-if=\"!haveImage\" :message=\"error || null\" :type=\"error ? 'is-danger' : null\" expanded>\n\t\t<b-upload @input=\"onInput\" drag-drop expanded :disabled=\"uploading || loading\">\n\t\t\t<section class=\"section is-relative\" ref=\"uploadZone\">\n\t\t\t\t<div class=\"has-text-centered\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<b-icon\n\t\t\t\t\t\t\ticon=\"upload\"\n\t\t\t\t\t\t\tsize=\"is-medium\">\n\t\t\t\t\t\t</b-icon>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<progress class=\"progress is-primary is-small\" :value=\"progress\" max=\"100\" v-if=\"uploading\">{{ progress }}%</progress>\n\n          <div v-else-if=\"loading\">{{ trans('Loading...') }}</div>\n\n\t\t\t\t\t<div v-else>{{ text }}</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</b-upload>\n\t</b-field>\n\n\t<div class=\"card\" v-else>\n\t\t<div class=\"card-image\">\n\t\t\t<figure class=\"has-magnifier has-text-centered\" @click=\"showModal = true\">\n        <img :src=\"thumbnailUrl\" alt=\"Uploaded photo\" class=\"max-h-36\" />\n        <div class=\"image-magnifier\">\n          <b-icon icon=\"expand\" size=\"is-medium\" />\n        </div>\n\t\t\t</figure>\n\t  </div>\n\n\t\t<footer class=\"card-footer\" v-if=\"haveImage\">\n\t\t\t<div class=\"card-footer-item flex-col\">\n\t\t\t\t<div class=\"mb-4 w-full flex justify-between\">\n\t\t\t\t\t<button\n            type=\"button\"\n            class=\"button is-outlined is-small mr-2\"\n            v-if=\"withCrop\"\n            @click=\"openCropModal\"\n            @close=\"closeCropModal\"\n          >\n            <b-icon icon=\"crop\" />\n          </button>\n\n\t\t\t\t\t<button type=\"button\" class=\"delete is-danger is-medium\" @click=\"remove\" v-if=\"image.path || hasExisting\"></button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"w-full\" v-if=\"withLicense\">\n\t\t\t\t\t<b-select :value=\"image.license\" @input=\"handleLicenseChanged\" expanded>\n\t\t\t\t\t\t<option :value=\"null\">{{ trans('labels.field_observations.default') }}</option>\n\t\t\t\t\t\t<option v-for=\"(label, value) in licenses\" :value=\"value\" :key=\"value\" v-text=\"label\"></option>\n\t\t\t\t\t</b-select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</footer>\n\n\t\t<nz-image-crop-modal :active.sync=\"showCropModal\" :crop.sync=\"image.crop\" :image-url=\"image.url\" v-if=\"haveImage\"/>\n\n\t\t<nz-image-modal :items=\"[thumbnailUrl]\" v-if=\"showModal\" @close=\"showModal = false\"/>\n\t</div>\n</template>\n\n<script>\nimport loadImage from 'blueimp-load-image'\nimport NzImageCropModal from '@/components/ImageCropModal'\nimport NzImageModal from '@/components/ImageModal'\n\nexport default {\n\tname: 'nzPhotoUpload',\n\n  components: {\n    NzImageCropModal,\n    NzImageModal\n  },\n\n  props: {\n\t\timageUrl: {\n\t\t\ttype: String,\n\t\t\tdefault: null\n\t\t},\n\t\timagePath: {\n\t\t\ttype: String,\n\t\t\tdefault: null\n\t\t},\n\t\timageLicense: {\n\t\t\ttype: [Number, String],\n\t\t\tdefault: null\n\t\t},\n\t\tlicenses: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t\ttext: String,\n\t\twithLicense: {\n      type: Boolean,\n      default: true\n    },\n    withCrop: {\n      type: Boolean,\n      default: true\n    }\n\t},\n\n  data() {\n    return {\n    \timage: {\n\t\t\t\turl: this.imageUrl,\n\t\t\t\tpath: this.imagePath,\n\t\t\t\tcrop: null,\n\t\t\t\tlicense: this.imageLicense\n\t\t\t},\n\t\t\tcroppedImageUrl: null,\n\t\t\treader: null,\n      uploading: false,\n      loading: false,\n\t\t\tprogress: 0,\n\t\t\thasExisting: !!this.imageUrl,\n\t\t\terror: null,\n\t\t\tshowCropModal: false,\n\t\t\tshowModal: false\n    }\n  },\n\n\twatch: {\n\t\t'image.crop': function (value) {\n\t\t\tthis.$emit('cropped', this.image)\n\n\t\t\tif (!value) {\n\t\t\t\tthis.croppedImageUrl = null\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tthis.cropThumbnail(value)\n    }\n\t},\n\n\tcomputed: {\n\t\thaveImage() {\n\t\t\treturn !!this.image.url\n\t\t},\n\n\t\tthumbnailUrl() {\n\t\t\treturn this.croppedImageUrl || this.image.url\n\t\t}\n\t},\n\n\tmethods: {\n\t\tselectImage() {\n\t\t\tthis.$refs.input.click()\n\t\t},\n\n\t\tonInput(file) {\n\t\t\tthis.error = null\n\n\t\t\tif (!file) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tthis.upload(file)\n\t\t},\n\n\t\tupload(file) {\n      this.uploading = true\n\t\t\treturn axios.post(route('api.photo-uploads.store'), this.makeForm(file), {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n\t\t\t\t\tAccept: 'application/json'\n\t\t\t\t},\n\t\t\t\tonUploadProgress: progressEvent => {\n          this.progress = Math.floor((progressEvent.loaded * 100) / progressEvent.total)\n\t\t\t\t}\n\t\t\t}).then(response => {\n        this.image.path = response.data.file\n\t\t\t\tthis.image.exif = response.data.exif\n\t\t\t\tthis.image.license = null\n\t\t\t\tthis.uploading = false\n\t\t\t\tthis.progress = 0\n\n        this.$emit('uploaded', this.image)\n\n        this.loading = true\n\n        loadImage(file, img => {\n            this.image.url = this.getImageDataUrl(img)\n            this.loading = false\n        }, { orientation: true })\n\t\t\t}).catch(this.handleError)\n    },\n\n    getImageDataUrl(img) {\n      let canvas = img\n\n      if (! (canvas instanceof HTMLCanvasElement)) {\n        canvas = document.createElement('canvas')\n        canvas.setAttribute('width', img.width)\n        canvas.setAttribute('height', img.height)\n        canvas.getContext('2d').drawImage(img, 0, 0)\n      }\n\n      return canvas.toDataURL()\n    },\n\n\t\tmakeForm(file) {\n\t\t\tlet form = new FormData()\n\n\t\t\tform.append('file', file)\n\n\t\t\treturn form\n\t\t},\n\n\t\tremove() {\n\t\t\tif (this.hasExisting) {\n\t\t\t\tthis.hasExisting = false\n\t\t\t\treturn this.clearPhoto()\n\t\t\t}\n\n\t\t\taxios.delete(route('api.photo-uploads.destroy', this.image.path)).then(() => {\n\t\t\t\tthis.clearPhoto()\n\t\t\t})\n\t\t},\n\n\t\tclearPhoto() {\n\t\t\tthis.$emit('removed', this.image)\n\n\t\t\tthis.image.path = null\n\t\t\tthis.image.url = null\n\t\t\tthis.image.crop = null\n\t\t\tthis.image.license = null\n\t\t\tthis.croppedImageUrl = null\n\t\t},\n\n\t\thandleError(error) {\n\t\t\tthis.uploading = false\n\t\t\tthis.loading = false\n\t\t\tthis.progress = 0\n\t\t\tthis.image.url = null\n\t\t\t// Clear the input so we can select the same image if needed.\n\t\t\tthis.$el.querySelector('input[type=\"file\"]').value = ''\n\n\t\t\tif (!error.response) {\n\t\t\t\treturn this.$buefy.toast.open({\n\t\t\t\t\tduration: 5000,\n\t\t\t\t\tmessage: error.message,\n\t\t\t\t\tposition: 'is-top',\n\t\t\t\t\ttype: 'is-danger'\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tthis.error = error.response.data.errors.file[0] || this.trans('Error')\n\t\t},\n\n\t\topenCropModal() {\n\t\t\tthis.showCropModal = true\n\t\t},\n\n\t\tcloseCropModal() {\n\t\t\tthis.showCropModal = false\n\t\t},\n\n\t\tcropThumbnail(crop) {\n\t\t\t// Create image\n\t\t\tconst image = document.createElement('img')\n\t\t\timage.src = this.image.url\n\n\t\t\t// Draw canvas\n\t\t\tconst canvas = document.createElement('canvas')\n\n  \t\tcanvas.setAttribute('width', crop.width)\n  \t\tcanvas.setAttribute('height', crop.height)\n\n  \t\tconst context = canvas.getContext('2d')\n  \t\tcontext.drawImage(image, -crop.x, -crop.y)\n\n\t\t\tthis.croppedImageUrl = canvas.toDataURL()\n\t\t},\n\n\t\t/**\n\t\t * Handle license change.\n\t\t *\n\t\t * @param {String|Number} license\n\t\t */\n\t\thandleLicenseChanged(license) {\n\t\t\tthis.image.license = license\n\t\t\tthis.$emit('license-changed', license)\n    }\n\t}\n}\n</script>\n","import { render, staticRenderFns } from \"./ImageCropModal.vue?vue&type=template&id=035960ca&\"\nimport script from \"./ImageCropModal.vue?vue&type=script&lang=js&\"\nexport * from \"./ImageCropModal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('transition',{attrs:{\"name\":_vm.animation}},[(_vm.isActive)?_c('div',{staticClass:\"modal is-active\"},[_c('div',{staticClass:\"modal-background\"}),_vm._v(\" \"),_c('div',{staticClass:\"animation-content modal-content\",style:({ maxWidth: _vm.newWidth })},[_c('img',{ref:\"cropModalImage\",staticClass:\"image\",attrs:{\"src\":_vm.imageUrl,\"alt\":\"Cropped image\"}})]),_vm._v(\" \"),_c('button',{staticClass:\"modal-close is-large\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.cancel('x')}}}),_vm._v(\" \"),_c('button',{staticClass:\"modal-action\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.cropImage}},[_c('b-icon',{attrs:{\"icon\":\"check\"}})],1)]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./PhotoUpload.vue?vue&type=template&id=58da6edb&\"\nimport script from \"./PhotoUpload.vue?vue&type=script&lang=js&\"\nexport * from \"./PhotoUpload.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-modal',{attrs:{\"active\":_vm.active,\"can-cancel\":['escape', 'x']},on:{\"update:active\":function($event){_vm.active=$event},\"close\":_vm.onClose}},[_c('div',{staticClass:\"image-modal\"},[_c('img',{attrs:{\"src\":_vm.openImage}}),_vm._v(\" \"),(_vm.items.length > 1)?_c('div',{staticClass:\"image-modal-navigation\"},[_c('div',{staticClass:\"image-modal-previous\",on:{\"click\":_vm.prev}},[_c('i',{staticClass:\"fa fa-chevron-left\",attrs:{\"aria-hidden\":\"true\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"image-modal-next\",on:{\"click\":_vm.next}},[_c('i',{staticClass:\"fa fa-chevron-right\",attrs:{\"aria-hidden\":\"true\"}})])]):_vm._e()])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageModal.vue?vue&type=script&lang=js&\"","<template>\n  <b-modal :active.sync=\"active\" :can-cancel=\"['escape', 'x']\" @close=\"onClose\">\n    <div class=\"image-modal\">\n      <img :src=\"openImage\">\n\n      <div class=\"image-modal-navigation\" v-if=\"items.length > 1\">\n        <div class=\"image-modal-previous\" @click=\"prev\">\n          <i class=\"fa fa-chevron-left\" aria-hidden=\"true\"></i>\n        </div>\n\n        <div class=\"image-modal-next\" @click=\"next\">\n          <i class=\"fa fa-chevron-right\" aria-hidden=\"true\"></i>\n        </div>\n      </div>\n    </div>\n  </b-modal>\n</template>\n\n<script>\nexport default {\n  name: 'nzImageModal',\n\n  props: {\n    items: {\n      type: Array,\n      default: () => []\n    },\n    value: {\n      type: Number,\n      default: 0\n    }\n  },\n\n  data() {\n    return {\n      newValue: this.value,\n      active: false\n    }\n  },\n\n  computed: {\n    openImage() {\n      return this.items[this.newValue]\n    }\n  },\n\n  watch: {\n    newValue() {\n      this.$emit('input', this.newValue)\n    },\n\n    openImage: {\n      handler(value) {\n        this.active = Boolean(value)\n      }\n    }\n  },\n\n  created() {\n    document.addEventListener('keyup', this.registerKeyListener)\n  },\n\n  mounted() {\n    this.active = Boolean(this.openImage)\n  },\n\n  beforeDestroy() {\n    document.removeEventListener('keyup', this.registerKeyListener)\n  },\n\n  methods: {\n    next() {\n      let newValue = this.newValue + 1\n\n      if (newValue >= this.items.length) {\n        newValue = 0\n      }\n\n      this.newValue = newValue\n    },\n\n    prev() {\n      let newValue = this.newValue - 1\n\n      if (newValue < 0) {\n        newValue = this.items.length - 1\n      }\n\n      this.newValue = newValue\n    },\n\n    registerKeyListener(e) {\n      const key = e.which || e.keyCode\n\n      if (key === 37) { // left arrow\n        this.prev()\n      } else if (key === 39) { // right arrow\n        this.next()\n      }\n    },\n\n    onClose(e) {\n      this.active = false\n\n      // b-modal component adds classes that prevent scrolling on body when active\n      // so we need to wait for it to remove them before we signal it's closing\n      this.$nextTick(() => {\n        this.$emit('close', e)\n      })\n    }\n  }\n}\n</script>\n","import { render, staticRenderFns } from \"./ImageModal.vue?vue&type=template&id=0d20be8b&\"\nimport script from \"./ImageModal.vue?vue&type=script&lang=js&\"\nexport * from \"./ImageModal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-field',{staticClass:\"nz-taxon-autocomplete\",attrs:{\"label\":_vm.label,\"type\":_vm.error ? 'is-danger' : null,\"message\":_vm.message}},[_c('b-field',{attrs:{\"grouped\":\"\"}},[(_vm.haveThumbnail)?_c('img',{attrs:{\"width\":\"32\",\"src\":this.selected.thumbnail_url}}):_vm._e(),_vm._v(\" \"),_c('b-autocomplete',{ref:\"autocomplete\",attrs:{\"value\":_vm.value,\"data\":_vm.data,\"field\":\"name\",\"loading\":_vm.loading,\"icon\":_vm.icon,\"placeholder\":_vm.placeholder,\"expanded\":\"\",\"autofocus\":_vm.autofocus},on:{\"input\":_vm.onInput,\"select\":_vm.onSelect},nativeOn:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.enterPressed($event)}},scopedSlots:_vm._u([{key:\"default\",fn:function(props){return [_c('div',{staticClass:\"media\"},[_c('div',{staticClass:\"media-left\"},[(props.option.thumbnail_url)?_c('img',{attrs:{\"width\":\"32\",\"src\":props.option.thumbnail_url}}):_vm._e()]),_vm._v(\" \"),_c('div',{staticClass:\"media-content\"},[_vm._v(\"\\n            \"+_vm._s(props.option.name)+_vm._s(props.option.native_name ? (\" (\" + (props.option.native_name) + \")\") : '')+\"\\n          \")])])]}}])})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <b-field :label=\"label\" class=\"nz-taxon-autocomplete\" :type=\"error ? 'is-danger' : null\" :message=\"message\">\n    <b-field grouped>\n      <img width=\"32\" :src=\"this.selected.thumbnail_url\" v-if=\"haveThumbnail\">\n\n      <b-autocomplete\n        ref=\"autocomplete\"\n        :value=\"value\"\n        :data=\"data\"\n        field=\"name\"\n        :loading=\"loading\"\n        @input=\"onInput\"\n        @select=\"onSelect\"\n        :icon=\"icon\"\n        :placeholder=\"placeholder\"\n        expanded\n        :autofocus=\"autofocus\"\n        @keydown.native.enter=\"enterPressed\"\n      >\n        <template slot-scope=\"props\">\n          <div class=\"media\">\n            <div class=\"media-left\">\n              <img width=\"32\" :src=\"props.option.thumbnail_url\" v-if=\"props.option.thumbnail_url\">\n            </div>\n\n            <div class=\"media-content\">\n              {{ props.option.name }}{{ props.option.native_name ? ` (${props.option.native_name})` : ''}}\n            </div>\n          </div>\n        </template>\n\n      </b-autocomplete>\n    </b-field>\n  </b-field>\n</template>\n\n<script>\nimport axios from 'axios'\nimport _debounce from 'lodash/debounce'\nimport _get from 'lodash/get'\n\nexport default {\n  name: 'nzTaxonAutocomplete',\n\n  props: {\n    label: {\n      type: String,\n      default: 'Taxon'\n    },\n    placeholder: {\n      type: String,\n      default: 'Search for taxon...'\n    },\n    taxon: {\n      type: Object,\n      default: null\n    },\n    url: {\n      type: String,\n      default: () => route('api.taxa.index')\n    },\n    value: {\n      type: String,\n      default: ''\n    },\n    error: Boolean,\n    message: {\n      type: String,\n      default: null\n    },\n    except: {},\n    autofocus: Boolean\n  },\n\n  data() {\n    return {\n      data: [],\n      selected: this.taxon || null,\n      loading: false\n    }\n  },\n\n  computed: {\n    haveThumbnail() {\n      return this.selected && this.selected.thumbnail_url\n    },\n\n    icon() {\n      return this.selected ? 'check' : 'search'\n    }\n  },\n\n  watch: {\n    taxon(value) {\n      this.selected = value\n    }\n  },\n\n  methods: {\n    fetchData: _debounce(function() {\n      if (!this.value) return\n\n      this.data = []\n      this.loading = true\n\n      let params = {\n        name: this.value,\n        limit: 20,\n      }\n\n      if (this.except) {\n        params.except = this.except\n      }\n\n      axios.get(this.url, {\n        params\n      }).then(({\n        data\n      }) => {\n        data.data.forEach(item => this.data.push(item))\n        this.loading = false\n      }, response => {\n        this.loading = false\n      })\n    }, 500),\n\n    onSelect(taxon) {\n      this.selected = taxon\n\n      this.$emit('select', taxon)\n    },\n\n    onInput(value) {\n      const currentValue = this.getValue(this.selected)\n      if (currentValue && currentValue !== value) {\n        this.onSelect(null)\n      }\n\n      this.$emit('input', value)\n\n      this.fetchData()\n    },\n\n    focusOnInput() {\n      this.$el.querySelector('input').focus()\n    },\n\n    /**\n     * Return display text for the input.\n     * If object, get value from path, or else just the value.\n     */\n    getValue(option) {\n      if (!option) return\n\n      return typeof option === 'object'\n        ? _get(option, 'name')\n        : option\n    },\n\n    enterPressed() {\n      if (!this.$refs.autocomplete.isActive) {\n        this.$emit('enter')\n      }\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaxonAutocomplete.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaxonAutocomplete.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TaxonAutocomplete.vue?vue&type=template&id=cedb826c&\"\nimport script from \"./TaxonAutocomplete.vue?vue&type=script&lang=js&\"\nexport * from \"./TaxonAutocomplete.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}