{"version":3,"sources":["webpack:///resources/js/components/FieldObservationApproval.vue","webpack:///./resources/js/components/FieldObservationApproval.vue?6d72","webpack:///./resources/js/components/FieldObservationApproval.vue","webpack:///./resources/js/components/FieldObservationApproval.vue?d8b4"],"names":["name","props","approveUrl","String","markAsUnidentifiableUrl","redirectUrl","type","required","fieldObservation","Object","data","approving","markingAsUnidentifiable","computed","busy","this","methods","confirmApprove","$buefy","dialog","confirm","message","trans","confirmText","cancelText","onConfirm","approve","bind","axios","post","field_observation_ids","id","successfullyApproved","toast","open","setTimeout","window","location","href","failedToApprove","duration","confirmMarkingAsUnidentifiable","inputAttrs","markAsUnidentifiable","$nextTick","reason","successfullyMarkedAsUnidentifiable","failedToMarkAsUnidentifiable","validateReason","$refs","input","addEventListener","e","target","setCustomValidity","validity","valid","validationMessage","_vm","_h","$createElement","_c","_self","staticClass","class","attrs","on","_v","_s","_e"],"mappings":"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","file":"js/3c6df7bda546a9ebd76c.js","sourcesContent":["<template>\n  <div class=\"level-right\">\n    <div class=\"level-item\" v-if=\"approveUrl\">\n      <button\n        type=\"button\"\n        class=\"button\"\n        :class=\"{'is-loading': approving}\"\n        @click=\"confirmApprove\"\n        :disabled=\"busy\"\n      >\n        <b-icon icon=\"check\" class=\"has-text-success\" />\n\n        <span>{{ trans('buttons.approve') }}</span>\n      </button>\n    </div>\n\n    <div class=\"level-item\" v-if=\"markAsUnidentifiableUrl\">\n      <button\n        type=\"button\"\n        class=\"button\"\n        :class=\"{'is-loading': markingAsUnidentifiable}\"\n        @click=\"confirmMarkingAsUnidentifiable\"\n        :disabled=\"busy\"\n      >\n        <b-icon icon=\"times\" class=\"has-text-danger\" />\n\n        <span>{{ trans('buttons.unidentifiable') }}</span>\n      </button>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'nzFieldObservationApproval',\n\n  props: {\n    approveUrl: String,\n    markAsUnidentifiableUrl: String,\n\n    redirectUrl: {\n      type: String,\n      required: true\n    },\n\n    fieldObservation: {\n      type: Object,\n      required: true\n    }\n  },\n\n  data() {\n    return {\n      approving: false,\n      markingAsUnidentifiable: false\n    }\n  },\n\n  computed: {\n    busy() {\n      return this.approving || this.markingAsUnidentifiable\n    }\n  },\n\n  methods: {\n    confirmApprove() {\n      this.$buefy.dialog.confirm({\n        message: this.trans('You are about to approve this field observation'),\n        confirmText: this.trans('buttons.approve'),\n        cancelText: this.trans('buttons.cancel'),\n        type: 'is-primary',\n        onConfirm: this.approve.bind(this)\n      })\n    },\n\n    approve() {\n      this.approving = true;\n\n      axios.post(this.approveUrl, {\n        field_observation_ids: [this.fieldObservation.id]\n      }).then(this.successfullyApproved).catch(this.failedToApprove)\n    },\n\n    successfullyApproved() {\n      this.$buefy.toast.open({\n        message: this.trans('Observation has been approved'),\n        type: 'is-success'\n      });\n\n      setTimeout(() => {\n        this.approving = false;\n\n        window.location.href = this.redirectUrl\n      }, 1000)\n    },\n\n    failedToApprove(error) {\n      this.approving = false\n\n      this.$buefy.toast.open({\n        message: this.trans('Observation cannot be approved'),\n        type: 'is-danger',\n        duration: 5000\n      })\n    },\n\n    confirmMarkingAsUnidentifiable() {\n      const dialog = this.$buefy.dialog.prompt({\n        message: this.trans('You are about to mark observation as unidentifiable. What\\'s the reason?'),\n        confirmText: this.trans('buttons.mark_unidentifiable'),\n        cancelText: this.trans('buttons.cancel'),\n        type: 'is-warning',\n        inputAttrs: {\n            placeholder: this.trans('Reason'),\n            required: true,\n            maxlength: 255\n        },\n        onConfirm: this.markAsUnidentifiable.bind(this)\n      })\n\n      dialog.$nextTick(() => {\n        this.validateReason(dialog);\n      })\n    },\n\n    markAsUnidentifiable(reason) {\n      this.markingAsUnidentifiable = true\n\n      axios.post(this.markAsUnidentifiableUrl, {\n        field_observation_ids: [this.fieldObservation.id],\n        reason\n      }).then(this.successfullyMarkedAsUnidentifiable)\n      .catch(this.failedToMarkAsUnidentifiable)\n    },\n\n    successfullyMarkedAsUnidentifiable() {\n      this.$buefy.toast.open({\n        message: this.trans('Observation has been marked as unidentifiable'),\n        type: 'is-success'\n      })\n\n      setTimeout(() => {\n        this.markingAsUnidentifiable = false\n\n        window.location.href = this.redirectUrl\n      }, 1000)\n    },\n\n    failedToMarkAsUnidentifiable(error) {\n      this.markingAsUnidentifiable = false\n      this.$buefy.toast.open({\n        message: this.trans('This observation cannot be marked as unidentifiable'),\n        type: 'is-danger',\n        duration: 5000\n      })\n    },\n\n    validateReason(dialog) {\n      dialog.$refs.input.addEventListener('invalid', (e) => {\n        e.target.setCustomValidity('')\n\n        if (!e.target.validity.valid) {\n          e.target.setCustomValidity(this.trans('This field is required and can contain max 255 chars.'))\n        }\n      });\n\n      dialog.$refs.input.addEventListener('input', (e) => {\n        dialog.validationMessage = null\n      })\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-5[0].rules[0].use[0]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FieldObservationApproval.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-5[0].rules[0].use[0]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FieldObservationApproval.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FieldObservationApproval.vue?vue&type=template&id=7a72b818&\"\nimport script from \"./FieldObservationApproval.vue?vue&type=script&lang=js&\"\nexport * from \"./FieldObservationApproval.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"level-right\"},[(_vm.approveUrl)?_c('div',{staticClass:\"level-item\"},[_c('button',{staticClass:\"button\",class:{'is-loading': _vm.approving},attrs:{\"type\":\"button\",\"disabled\":_vm.busy},on:{\"click\":_vm.confirmApprove}},[_c('b-icon',{staticClass:\"has-text-success\",attrs:{\"icon\":\"check\"}}),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.trans('buttons.approve')))])],1)]):_vm._e(),_vm._v(\" \"),(_vm.markAsUnidentifiableUrl)?_c('div',{staticClass:\"level-item\"},[_c('button',{staticClass:\"button\",class:{'is-loading': _vm.markingAsUnidentifiable},attrs:{\"type\":\"button\",\"disabled\":_vm.busy},on:{\"click\":_vm.confirmMarkingAsUnidentifiable}},[_c('b-icon',{staticClass:\"has-text-danger\",attrs:{\"icon\":\"times\"}}),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.trans('buttons.unidentifiable')))])],1)]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }"],"sourceRoot":""}