(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"+9Wz":function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,".columns-picker :focus{outline:none}.columns-picker .panel-block{justify-content:space-between}.columns-picker .panel-block:hover{cursor:default}.columns-picker .panel-heading{padding-left:.6em}.columns-picker .sortable-handle:hover{cursor:move}.columns-picker .b-checkbox input[type=checkbox][disabled]+.check{opacity:.5}",""])},0:function(t,e,n){n("bUC5"),t.exports=n("pyCd")},"9Wh1":function(t,e,n){window._=n("LvDl"),window.axios=n("vDqi"),window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",window.axios.interceptors.response.use(function(t){return t},function(t){if(console.log(t),!t.response||401!==t.response.status)return Promise.reject(t);window.location.href=window.route("login").url()});var a=document.head.querySelector('meta[name="csrf-token"]');a?window.axios.defaults.headers.common["X-CSRF-TOKEN"]=a.content:console.error("CSRF token not found: https://laravel.com/docs/csrf#csrf-x-csrf-token");var i=document.documentElement.lang;i&&(window.axios.defaults.headers.common["Accept-Language"]=i),window.moment=n("wd/R"),n("zx6S"),n("E+lV");var s=i;"sr"===i?s="sr-cyrl":"sr-Latn"===i&&(s="sr"),window.moment.locale(s)},RnhZ:function(t,e,n){var a={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-SG":"zavE","./en-SG.js":"zavE","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./ga":"USCx","./ga.js":"USCx","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it-ch":"bxKX","./it-ch.js":"bxKX","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ku":"JCF/","./ku.js":"JCF/","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function i(t){var e=s(t);return n(e)}function s(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=s,t.exports=i,i.id="RnhZ"},a3Es:function(t,e,n){var a=n("iO7F");"string"==typeof a&&(a=[[t.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(a,i);a.locals&&(t.exports=a.locals)},bUC5:function(t,e,n){"use strict";n.r(e);n("9Wh1");var a=n("XuX8"),i=n.n(a),s=n("igO+"),o=n.n(s),r=n("dV7z"),l=n("433b"),c={defaultTemplate:'<div class="v-tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'};var u=n("KD6U"),d=n.n(u),f={name:"nzNavbar",props:{hasUnread:Boolean},data:function(){return{active:!1,showSidebar:!1,hasUnreadNotifications:this.hasUnread}},methods:{toggle:function(){this.active=!this.active},toggleSidebar:function(){this.showSidebar=!this.showSidebar},updateNotificationStatus:function(t){this.hasUnreadNotifications=t}}},m={"App\\Notifications\\FieldObservationApproved":{link:function(t){return route("contributor.field-observations.show",t.data.field_observation_id)},message:function(t){return trans("notifications.field_observations.approved",{curatorName:t.data.curator_name||trans("roles.curator")})}},"App\\Notifications\\FieldObservationForApproval":{link:function(t){return route("curator.pending-observations.show",t.data.field_observation_id)},message:function(t){return trans("notifications.field_observations.for_approval",{contributorName:t.data.contributor_name||trans("roles.contributor")})}},"App\\Notifications\\FieldObservationMovedToPending":{link:function(t){return route("contributor.field-observations.show",t.data.field_observation_id)},message:function(t){return trans("notifications.field_observations.moved_to_pending",{curatorName:t.data.curator_name||trans("roles.curator")})}},"App\\Notifications\\FieldObservationMarkedUnidentifiable":{link:function(t){return route("contributor.field-observations.show",t.data.field_observation_id)},message:function(t){return trans("notifications.field_observations.marked_as_unidentifiable",{curatorName:t.data.curator_name||trans("roles.curator")})}}},h={name:"nzNotification",props:{notification:{type:Object,required:!0}},computed:{type:function(){return m[this.notification.type]},isNotRead:function(){return!this.notification.readAt},data:function(){return this.notification.data},createdAt:function(){return moment(this.notification.created_at).format("D.M.YYYY HH:mm")},message:function(){return this.type.message(this.notification)},link:function(){return this.type.link(this.notification)}},methods:{markAsRead:function(){this.isNotRead&&this.$emit("mark-read",this.notification.id)},visitLinkAndMarkAsRead:function(){var t=this;this.isNotRead?this.$emit("mark-read",this.notification.id,function(){t.visitLink()}):this.visitLink()},visitLink:function(){this.link&&(window.location.href=this.link)}}},p=n("KHd+"),b={name:"nzSidebar",components:{nzNotification:Object(p.a)(h,function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.type?n("div",{class:{"has-background-light":t.isNotRead}},[n("div",{staticClass:"flex-1",class:{"is-clickable":t.link},on:{click:t.visitLinkAndMarkAsRead}},[n("div",{domProps:{innerHTML:t._s(t.message)}}),t._v(" "),n("span",{staticClass:"has-text-grey is-size-7"},[t._v(t._s(t.createdAt))])]),t._v(" "),t.isNotRead?n("a",{attrs:{href:"#",title:t.trans("notifications.mark_as_read")},on:{click:function(e){return e.preventDefault(),t.markAsRead(e)}}},[n("b-icon",{attrs:{icon:"remove",size:"is-small"}})],1):t._e()]):t._e()},[],!1,null,null,null).exports},props:{active:Boolean,notifications:{type:Array,default:function(){return[]}}},data:function(){return{activeTab:"notifications",currentNotifications:this.notifications}},created:function(){"undefined"!=typeof window&&document.addEventListener("keyup",this.keyPress)},beforeDestroy:function(){"undefined"!=typeof window&&document.removeEventListener("keyup",this.keyPress)},methods:{hide:function(){this.$emit("close")},keyPress:function(t){27===t.keyCode&&this.hide()},markNotificationAsRead:function(t,e){var n=this;axios.post(route("api.my.read-notifications-batch.store"),{notifications_ids:[t]}).then(function(){n.currentNotifications=n.currentNotifications.filter(function(e){return e.id!==t}),n.$emit("update:has-unread-notifications",!!n.currentNotifications.length),e()})},markAllNotificationsAsRead:function(){var t=this;this.currentNotifications.length&&axios.post(route("api.my.read-notifications-batch.store"),{notifications_ids:this.currentNotifications.map(function(t){return t.id})}).then(function(){t.currentNotifications=[],t.$emit("update:has-unread-notifications",!1)})}}},v=Object(p.a)(b,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"sidebar",class:{"is-active":t.active}},[n("div",{staticClass:"sidebar-header"},[n("h3",{staticClass:"title is-size-5"},[t._v(t._s(t.trans("notifications.title")))])]),t._v(" "),n("div",{staticClass:"sidebar-body"},[t.currentNotifications.length?n("transition-group",{attrs:{name:"notification-list"}},t._l(t.currentNotifications,function(e){return n("nz-notification",{key:e.id,staticClass:"sidebar-block",attrs:{notification:e},on:{"mark-read":t.markNotificationAsRead}})}),1):n("div",{staticClass:"sidebar-block justify-center py-8"},[t._v("\n      "+t._s(t.trans("notifications.no_new_notifications"))+"\n    ")])],1),t._v(" "),n("footer",{staticClass:"sidebar-footer"},[n("button",{staticClass:"button",attrs:{type:"button"},on:{click:t.hide}},[t._v(t._s(t.trans("buttons.close")))]),t._v(" "),t.currentNotifications.length?n("button",{staticClass:"button is-text",attrs:{type:"button"},on:{click:t.markAllNotificationsAsRead}},[t._v("\n      "+t._s(t.trans("notifications.mark_all_as_read"))+"\n    ")]):t._e()])])},[],!1,null,null,null).exports,g={name:"nzAnnouncement",props:{announcement:Object},data:function(){return{newAnnouncement:this.announcement}},computed:{link:function(){return route("announcements.show",{announcement:this.newAnnouncement.id})}},methods:{sendRequestToMarkAsRead:function(){return axios.post("/api/read-announcements",{announcement_id:this.newAnnouncement.id})},markAsRead:function(){var t=this;this.sendRequestToMarkAsRead().then(function(){t.newAnnouncement=null})}}},y=Object(p.a)(g,function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.newAnnouncement?n("article",{staticClass:"message is-info shadow"},[n("div",{staticClass:"message-body flex justify-between"},[n("div",{},[t._v("\n      "+t._s(t.newAnnouncement.title)+"\n    ")]),t._v(" "),n("div",{staticClass:"message-actions"},[n("a",{attrs:{href:t.link}},[t._v("Read more")]),t._v(" "),n("b-icon",{staticClass:"is-clickable",attrs:{icon:"check",title:"Mark as read"},nativeOn:{click:function(e){return t.markAsRead(e)}}})],1)])]):t._e()},[],!1,null,null,null).exports,x=n("vDqi"),C=n.n(x),k={name:"nzCaptcha",props:{url:String},data:function(){return{imageUrl:this.url,refreshing:!1}},methods:{refresh:function(){var t=this;this.refreshing||(this.refreshing=!0,C.a.get(this.imageUrl+"&refresh").then(function(e){var n=e.data;t.imageUrl=n.url,t.refreshing=!1}))}}},w=Object(p.a)(k,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"is-flex is-flex-center"},[e("img",{staticClass:"image",staticStyle:{height:"60px"},attrs:{src:this.imageUrl,alt:"CAPTCHA Image"}}),this._v(" "),e("button",{staticClass:"button is-small ml-2",attrs:{type:"button"},on:{click:this.refresh}},[e("b-icon",{attrs:{icon:"refresh",size:"is-small"}})],1)])},[],!1,null,null,null).exports,S={name:"nzImageModal",props:{items:{type:Array,default:function(){return[]}},value:{type:Number,default:0}},data:function(){return{newValue:this.value,active:!0}},computed:{openImage:function(){return this.items[this.newValue]}},watch:{newValue:function(){this.$emit("input",this.newValue)}},created:function(){document.addEventListener("keyup",this.registerKeyListener)},beforeDestroy:function(){document.removeEventListener("keyup",this.registerKeyListener)},methods:{next:function(){var t=this.newValue+1;t>=this.items.length&&(t=0),this.newValue=t},prev:function(){var t=this.newValue-1;t<0&&(t=this.items.length-1),this.newValue=t},registerKeyListener:function(t){var e=t.which||t.keyCode;37===e?this.prev():39===e&&this.next()},onClose:function(t){this.active=!1,document.documentElement.classList.remove("is-clipped"),document.body.classList.remove("is-noscroll"),this.$emit("close",t)}}},A=Object(p.a)(S,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",{attrs:{active:t.active,"can-cancel":["escape","x"]},on:{close:t.onClose}},[n("div",{staticClass:"image-modal"},[n("img",{attrs:{src:t.openImage}}),t._v(" "),t.items.length>1?n("div",{staticClass:"image-modal-navigation"},[n("div",{staticClass:"image-modal-previous",on:{click:t.prev}},[n("i",{staticClass:"fa fa-chevron-left",attrs:{"aria-hidden":"true"}})]),t._v(" "),n("div",{staticClass:"image-modal-next",on:{click:t.next}},[n("i",{staticClass:"fa fa-chevron-right",attrs:{"aria-hidden":"true"}})])]):t._e()])])},[],!1,null,null,null).exports,O=n("dfMu"),D=n.n(O),P=n("T5TR");function j(t){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function T(t,e){return!e||"object"!==j(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function R(t){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $(t,e){return($=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var E=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),T(this,R(e).apply(this,arguments))}var n,a,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$(t,e)}(e,D.a),n=e,(a=[{key:"setBoxToRealPosition",value:function(t){var e=this.imageEl.naturalWidth,n=this.imageEl.naturalHeight,a=e/this.imageEl.offsetWidth,i=n/this.imageEl.offsetHeight;this.box=new P.a(Math.round(t.x/a),Math.round(t.y/i),Math.round((t.x+t.width)/a),Math.round((t.y+t.height)/i)),this.redraw()}}])&&I(n.prototype,a),i&&I(n,i),e}(),F={name:"nzImageCropModal",mixins:[n("aa4y").a],props:{canCancel:{type:[Array,Boolean],default:function(){return["escape","x"]}},imageUrl:String,crop:Object},data:function(){return{croppr:null,newCrop:this.crop}},watch:{isActive:function(t){var e=this;this.handleScroll(),this.croppr=null,t&&this.$nextTick(function(){e.croppr=new E(e.$refs.cropModalImage,{onCropEnd:function(t){e.newCrop=t},onInitialize:function(t){e.newCrop&&t.setBoxToRealPosition(e.newCrop)}})})}},methods:{handleScroll:function(){"undefined"!=typeof window&&(this.savedScrollTop=this.savedScrollTop?this.savedScrollTop:document.documentElement.scrollTop,document.body.classList.toggle("is-noscroll",this.isActive),this.isActive?document.body.style.top="-".concat(this.savedScrollTop,"px"):(document.documentElement.scrollTop=this.savedScrollTop,document.body.style.top=null,this.savedScrollTop=null))},cropImage:function(){this.$emit("update:crop",this.newCrop),this.close()}}},M=Object(p.a)(F,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:t.animation}},[t.isActive?n("div",{staticClass:"modal is-active"},[n("div",{staticClass:"modal-background"}),t._v(" "),n("div",{staticClass:"animation-content modal-content",style:{maxWidth:t.newWidth}},[n("img",{ref:"cropModalImage",staticClass:"image",attrs:{src:t.imageUrl,alt:"Cropped image"}})]),t._v(" "),n("button",{staticClass:"modal-close is-large",attrs:{type:"button"},on:{click:function(e){return t.cancel("x")}}}),t._v(" "),n("button",{staticClass:"modal-action",attrs:{type:"button"},on:{click:t.cropImage}},[n("b-icon",{attrs:{icon:"check"}})],1)]):t._e()])},[],!1,null,null,null).exports,z=(n("Nxl1"),n("1Uf0")),L={name:"nzSlider",components:{"tn-item":z.TnItem,"tn-slider":z.TnSlider},props:{items:{type:Array,default:function(){return[]}},withThumbnails:{type:Boolean,default:!0},thumbnailNumber:{type:Number,default:5}},data:function(){return{item:0}},computed:{moreThanOne:function(){return this.items.length>1}},methods:{goToPrevSlide:function(){this.item>0?this.item--:this.item=this.items.length-1},goToNextSlide:function(){this.item<this.items.length-1?this.item++:this.item=0},setCurrentSlide:function(t){this.item=t},isCurrent:function(t){return this.item===t}}},N=Object(p.a)(L,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"slider"},[n("div",{staticClass:"slide-container"},[t._l(t.items,function(e,a){return n("div",{directives:[{name:"show",rawName:"v-show",value:t.isCurrent(a),expression:"isCurrent(index)"}],staticClass:"slide"},[n("div",{staticClass:"slide-image-container"},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.url,expression:"image.url"}]}),t._v(" "),e.caption?n("div",{staticClass:"slide-caption",domProps:{innerHTML:t._s(e.caption)}}):t._e()])])}),t._v(" "),t.moreThanOne?n("a",{staticClass:"prev",on:{click:t.goToPrevSlide}},[t._v("❮")]):t._e(),t._v(" "),t.moreThanOne?n("a",{staticClass:"next",on:{click:t.goToNextSlide}},[t._v("❯")]):t._e()],2),t._v(" "),t.withThumbnails&&t.moreThanOne?n("tn-slider",{staticClass:"thumbnails",attrs:{index:t.item,count:t.thumbnailNumber}},t._l(t.items,function(e,a){return n("tn-item",{key:a,class:{active:t.isCurrent(a)},on:{"on-item-click":function(e){return t.setCurrentSlide(a)}}},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.url,expression:"image.url"}]}),t._v(" "),n("div",{staticClass:"inner-shadow"})])}),1):t.moreThanOne?n("div",{staticClass:"dots"},t._l(t.items,function(e,a){return n("div",{staticClass:"dot",class:{active:t.isCurrent(a)},on:{click:function(e){return t.setCurrentSlide(a)}}})}),0):t._e()],1)},[],!1,null,null,null).exports,U={name:"nzGroupTaxaSearch",props:{group:{type:Number,required:!0}},data:function(){return{name:"",selected:null}},computed:{link:function(){return this.selected&&this.selected.first_species_id?route("groups.species.show",{group:this.group,species:this.selected.first_species_id}):null},url:function(){return route("api.groups.taxa.index",{group:this.group})}},methods:{onTaxonSelect:function(t){this.selected=t},visitLink:function(){this.link&&(window.location.href=this.link)}}},W=Object(p.a)(U,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-card group-taxa-search"},[n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[t._v(t._s(t.trans("navigation.find_in_group")))])]),t._v(" "),n("section",{staticClass:"modal-card-body"},[n("nz-taxon-autocomplete",{attrs:{autofocus:"",url:t.url,label:t.trans("labels.field_observations.taxon"),placeholder:t.trans("labels.field_observations.search_for_taxon")},on:{select:t.onTaxonSelect,enter:t.visitLink},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),t._v(" "),n("footer",{staticClass:"modal-card-foot",staticStyle:{"justify-content":"flex-end"}},[n("a",{staticClass:"button is-primary",attrs:{href:t.link,disabled:!t.link}},[n("i",{staticClass:"fa fa-arrow-right"})])])])},[],!1,null,null,null).exports,Y={name:"nzGroupTaxaSearchButton",props:{group:{type:Number,required:!0}},methods:{showModal:function(){var t=this.$modal.open({parent:this,component:W,hasModalCard:!0,props:{group:this.group}});this.$nextTick(function(){t.$el.querySelector("input").focus()})}}},H=Object(p.a)(Y,function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"button has-text-hidden-tablet-only",attrs:{type:"button",title:this.trans("navigation.find_in_group")},on:{click:this.showModal}},[e("b-icon",{staticClass:"has-text-grey",attrs:{icon:"search",size:"is-small"}}),this._v(" "),e("span",{staticClass:"is-hidden-tablet-only"},[this._v("\n    "+this._s(this.trans("navigation.find_in_group"))+"\n  ")])],1)},[],!1,null,null,null).exports,q={name:"nzDateInput",props:{label:{type:String,default:"Date"},year:{type:Number,default:moment().year()},month:{type:Number,default:moment().month()+1},day:{type:Number,default:moment().date()},placeholders:{type:Object,default:function(){return{year:"Year",month:"Month",day:"Day"}}},errors:{type:Object,default:function(){return{has:function(){return!1}}}}},computed:{now:function(){return moment()},months:function(){if(!this.year||this.year>moment().year())return[];var t=this.year===moment().year(),e=moment.months();return t&&e.splice(moment().month()+1),e},days:function(){if(!(this.year&&this.month))return[];var t=this.year===moment().year()&&this.month-1===moment().month(),e=moment({year:this.year,month:this.month-1}).daysInMonth();return t&&(e=moment().date()),_.range(1,e+1)}},watch:{year:function(){(this.year>moment().year()||this.months.length<this.month-1)&&this.onMonthInput(null),this.truncateDay()},month:function(){this.truncateDay()}},methods:{truncateDay:function(){this.days.length<this.day&&this.onDayInput(null)},onYearInput:function(t){this.$emit("update:year",+t||null)},onMonthInput:function(t){this.$emit("update:month",t)},onDayInput:function(t){this.$emit("update:day",t)}}},B=Object(p.a)(q,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-field",{attrs:{label:t.label}},[n("b-field",{attrs:{expanded:"",grouped:""}},[n("b-field",{attrs:{type:t.errors.has("year")?"is-danger":"",message:t.errors.has("year")?t.errors.first("year"):"",expanded:""}},[n("b-input",{attrs:{placeholder:t.placeholders.year,value:t.year},on:{input:t.onYearInput}})],1),t._v(" "),n("b-field",{attrs:{type:t.errors.has("month")?"is-danger":"",message:t.errors.has("month")?t.errors.first("month"):"",expanded:""}},[n("b-select",{attrs:{placeholder:t.placeholders.month,value:t.month,expanded:""},on:{input:t.onMonthInput}},[n("option",{domProps:{value:null}}),t._v(" "),t._l(t.months,function(e,a){return n("option",{domProps:{value:a+1,textContent:t._s(e)}})})],2)],1),t._v(" "),n("b-field",{attrs:{type:t.errors.has("day")?"is-danger":"",message:t.errors.has("day")?t.errors.first("day"):"",expanded:""}},[n("b-select",{attrs:{placeholder:t.placeholders.day,value:t.day,expanded:""},on:{input:t.onDayInput}},[n("option",{domProps:{value:null}}),t._v(" "),t._l(t.days,function(e){return n("option",{domProps:{value:e,textContent:t._s(e)}})})],2)],1)],1)],1)},[],!1,null,null,null).exports,V=n("+9FD"),K=n.n(V),Z={name:"nzPhotoUpload",props:{imageUrl:{type:String,default:null},imagePath:{type:String,default:null},imageLicense:{type:[Number,String],default:null},licenses:{type:Object,required:!0},text:String,withLicense:{type:Boolean,default:!0},withCrop:{type:Boolean,default:!0}},data:function(){return{image:{url:this.imageUrl,path:this.imagePath,crop:null,license:this.imageLicense},croppedImageUrl:null,reader:null,uploading:!1,progress:0,hasExisting:!!this.imageUrl,error:null,showCropModal:!1,showModal:!1}},watch:{"image.crop":function(t){this.$emit("cropped",this.image),t?this.cropThumbnail(t):this.croppedImageUrl=null}},computed:{haveImage:function(){return!!this.image.url},thumbnailUrl:function(){return this.croppedImageUrl||this.image.url}},methods:{selectImage:function(){this.$refs.input.click()},onInput:function(t){this.error=null,t&&this.upload(t)},upload:function(t){var e=this;return this.uploading=!0,axios.post(route("api.photo-uploads.store"),this.makeForm(t),{headers:{"Content-Type":"multipart/form-data",Accept:"application/json"},onUploadProgress:function(t){e.progress=Math.floor(100*t.loaded/t.total)}}).then(function(n){e.image.path=n.data.file,e.image.exif=n.data.exif,e.image.license=null,e.uploading=!1,e.progress=0,e.$emit("uploaded",e.image),K()(t,function(t){e.image.url=t.toDataURL()},{orientation:!0})}).catch(this.handleError)},makeForm:function(t){var e=new FormData;return e.append("file",t),e},remove:function(){var t=this;if(this.hasExisting)return this.hasExisting=!1,this.clearPhoto();axios.delete(route("api.photo-uploads.destroy",this.image.path)).then(function(){t.clearPhoto()})},clearPhoto:function(){this.$emit("removed",this.image),this.image.path=null,this.image.url=null,this.image.crop=null,this.image.license=null,this.croppedImageUrl=null},handleError:function(t){if(this.uploading=!1,this.progress=0,this.image.url=null,this.$el.querySelector('input[type="file"]').value="",!t.response)return this.$toast.open({duration:5e3,message:t.message,position:"is-top",type:"is-danger"});this.error=t.response.data.errors.file[0]||this.trans("Error")},openCropModal:function(){this.showCropModal=!0},closeCropModal:function(){this.showCropModal=!1},cropThumbnail:function(t){var e=document.createElement("img");e.src=this.image.url;var n=document.createElement("canvas");n.setAttribute("width",t.width),n.setAttribute("height",t.height),n.getContext("2d").drawImage(e,-t.x,-t.y),this.croppedImageUrl=n.toDataURL()},handleLicenseChanged:function(t){this.image.license=t,this.$emit("license-changed",t)}}},X=Object(p.a)(Z,function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.haveImage?n("div",{staticClass:"card"},[n("div",{staticClass:"card-image"},[n("figure",{staticClass:"has-magnifier has-text-centered",on:{click:function(e){t.showModal=!0}}},[n("img",{staticClass:"max-h-36",attrs:{src:t.thumbnailUrl,alt:"Uploaded photo"}}),t._v(" "),n("div",{staticClass:"image-magnifier"},[n("b-icon",{attrs:{icon:"expand",size:"is-medium"}})],1)])]),t._v(" "),t.haveImage?n("footer",{staticClass:"card-footer"},[n("div",{staticClass:"card-footer-item flex-col"},[n("div",{staticClass:"mb-4 w-full flex justify-between"},[t.withCrop?n("button",{staticClass:"button is-outlined is-small mr-2",attrs:{type:"button"},on:{click:t.openCropModal,close:t.closeCropModal}},[n("b-icon",{attrs:{icon:"crop"}})],1):t._e(),t._v(" "),t.image.path||t.hasExisting?n("button",{staticClass:"delete is-danger is-medium",attrs:{type:"button"},on:{click:t.remove}}):t._e()]),t._v(" "),t.withLicense?n("div",{staticClass:"w-full"},[n("b-select",{attrs:{value:t.image.license,expanded:""},on:{input:t.handleLicenseChanged}},[n("option",{domProps:{value:null}},[t._v(t._s(t.trans("labels.field_observations.default")))]),t._v(" "),t._l(t.licenses,function(e,a){return n("option",{domProps:{value:a,textContent:t._s(e)}})})],2)],1):t._e()])]):t._e(),t._v(" "),t.haveImage?n("nz-image-crop-modal",{attrs:{active:t.showCropModal,crop:t.image.crop,"image-url":t.image.url},on:{"update:active":function(e){t.showCropModal=e},"update:crop":function(e){return t.$set(t.image,"crop",e)}}}):t._e(),t._v(" "),t.showModal?n("nz-image-modal",{attrs:{items:[t.thumbnailUrl]},on:{close:function(e){t.showModal=!1}}}):t._e()],1):n("b-field",{attrs:{message:t.error||null,type:t.error?"is-danger":null,expanded:""}},[n("b-upload",{attrs:{"drag-drop":"",type:"is-fullwidth"},on:{input:t.onInput}},[n("section",{staticClass:"section"},[n("div",{staticClass:"has-text-centered"},[n("div",[n("b-icon",{attrs:{icon:"upload",size:"is-medium"}})],1),t._v(" "),t.uploading?n("progress",{staticClass:"progress is-primary is-small",attrs:{max:"100"},domProps:{value:t.progress}},[t._v(t._s(t.progress)+"%")]):n("div",[t._v(t._s(t.text))])])])])],1)},[],!1,null,null,null).exports,G={name:"nzSpatialInput",props:{accuracy:Number,elevation:{type:Number,default:100},latitude:{type:Number,default:41},longitude:{type:Number,default:19},location:{type:[String,Number],default:""},errors:{type:Object,default:function(){return{}}},hasOtherErrors:{type:Boolean,default:!1}},data:function(){return{emptyAccuracy:this.calculateEmptyAccuracy(window.App.gmaps.center.zoom),showDetails:!1,elevationService:null,center:window.App.gmaps.center}},computed:{position:function(){return this.coordinatesSet?{lat:this.latitude,lng:this.longitude}:null},coordinatesSet:function(){return!(isNaN(this.latitude)||null===this.latitude||isNaN(this.longitude)||null===this.longitude)},mapHasErrors:function(){return this.hasOtherErrors||this.errors.has("latitude")||this.errors.has("longitude")||this.errors.has("elevation")||this.errors.has("accuracy")||this.errors.has("location")},newAccuracy:function(){return this.accuracy||this.emptyAccuracy},centerCoordinates:function(){return this.position||{lat:this.center.latitude,lng:this.center.longitude}}},watch:{position:function(t){this.coordinatesSet&&this.getElevation(t)}},created:function(){this.setCurrentLocationAsMapCenter()},methods:{castNumber:function(t){return isNaN(t)||""===t?null:Number(t)},onLocationInput:function(t){this.updateLocation(t.target.value)},updateLocation:function(t){this.$emit("update:location",t)},onLongitudeInput:_.debounce(function(t){this.updateLongitude(t.target.value)},1e3),updateLongitude:function(t){this.$emit("update:longitude",this.castNumber(t))},onLatitudeInput:_.debounce(function(t){this.updateLatitude(t.target.value)},1e3),updateLatitude:function(t){this.$emit("update:latitude",this.castNumber(t))},onAccuracyInput:_.debounce(function(t){this.updateAccuracy(t.target.value)},1e3),updateAccuracy:function(t){this.$emit("update:accuracy",this.castNumber(t))},onElevationInput:function(t){this.updateElevation(t.target.value)},updateElevation:function(t){this.$emit("update:elevation",this.castNumber(t))},setMarker:function(t){var e=t.latLng.lat(),n=t.latLng.lng();this.updateLatitude(e),this.updateLongitude(n)},updateRadius:function(t){var e=parseInt(t);null===this.accuracy&&e===this.emptyAccuracy||this.updateAccuracy(e)},getElevation:function(t){var e=this;google&&google.maps&&google.maps.ElevationService&&(this.elevationService||(this.elevationService=new google.maps.ElevationService),this.elevationService.getElevationForLocations({locations:[t]},function(t,n){if(n==google.maps.ElevationStatus.OK&&t.length){var a=parseInt(t[0].elevation);e.$emit("elevation-fetched",a),e.updateElevation(a)}}))},onZoomChanged:function(t){this.emptyAccuracy=this.calculateEmptyAccuracy(t)},calculateEmptyAccuracy:function(t){return parseInt(6144e3/Math.pow(2,t))},setCurrentLocationAsMapCenter:function(){var t=this;navigator.geolocation&&!this.position&&navigator.geolocation.getCurrentPosition(function(e){t.position||(t.center.latitude=e.coords.latitude,t.center.longitude=e.coords.longitude,t.center.zoom=10)})}}},J=Object(p.a)(G,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"spatial-input"},[n("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.field_observations.map")}},[n("gmap-map",{staticStyle:{width:"100%","min-height":"400px"},attrs:{center:t.centerCoordinates,zoom:t.center.zoom,options:{streetViewControl:!1}},on:{click:t.setMarker,zoom_changed:t.onZoomChanged}},[n("gmap-marker",{attrs:{position:t.position,clickable:!0,draggable:!0},on:{dragend:t.setMarker}}),t._v(" "),t.position&&t.newAccuracy?n("gmap-circle",{attrs:{center:t.position,radius:t.newAccuracy,editable:!0,options:{strokeWeight:.75}},on:{radius_changed:t.updateRadius}}):t._e()],1)],1),t._v(" "),n("div",{staticClass:"has-text-right"},[t.mapHasErrors?n("span",{staticClass:"has-text-danger is-size-7"},[t._v(t._s(t.trans("Some fields have errors")))]):t._e(),t._v(" "),n("button",{staticClass:"button is-white is-small is-text",class:{"has-text-danger":t.mapHasErrors},attrs:{type:"button"},on:{click:function(e){t.showDetails=!t.showDetails}}},[t._v(t._s(t.trans("labels.field_observations.details")))])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showDetails,expression:"showDetails"}]},[n("div",{staticClass:"field is-grouped"},[n("div",{staticClass:"field is-expanded is-required"},[n("label",{staticClass:"label is-small"},[t._v(t._s(t.trans("labels.field_observations.latitude")))]),t._v(" "),n("div",{staticClass:"control is-fullwidth"},[n("input",{staticClass:"input is-small",class:{"is-danger":t.errors.has("latitude")},attrs:{placeholder:"f.e. 42.5234"},domProps:{value:t.latitude},on:{input:t.onLatitudeInput}})]),t._v(" "),t.errors.has("latitude")?n("p",{staticClass:"help is-danger",domProps:{textContent:t._s(t.errors.first("latitude"))}}):t._e()]),t._v(" "),n("div",{staticClass:"field is-expanded is-required"},[n("label",{staticClass:"label is-small"},[t._v(t._s(t.trans("labels.field_observations.longitude")))]),t._v(" "),n("div",{staticClass:"control is-fullwidth"},[n("input",{staticClass:"input is-small",class:{"is-danger":t.errors.has("longitude")},attrs:{placeholder:"f.e. 19.1234"},domProps:{value:t.longitude},on:{input:t.onLongitudeInput}})]),t._v(" "),t.errors.has("longitude")?n("p",{staticClass:"help is-danger",domProps:{textContent:t._s(t.errors.first("longitude"))}}):t._e()])]),t._v(" "),n("div",{staticClass:"field is-grouped"},[n("div",{staticClass:"field is-expanded"},[n("label",{staticClass:"label is-small"},[t._v(t._s(t.trans("labels.field_observations.accuracy_m")))]),t._v(" "),n("div",{staticClass:"control is-fullwidth"},[n("input",{staticClass:"input is-small",attrs:{placeholder:"f.e. 100"},domProps:{value:t.accuracy},on:{input:t.onAccuracyInput}})]),t._v(" "),t.errors.has("accuracy")?n("p",{staticClass:"help is-danger",domProps:{textContent:t._s(t.errors.first("accuracy"))}}):t._e()]),t._v(" "),n("div",{staticClass:"field is-expanded is-required"},[n("label",{staticClass:"label is-small"},[t._v(t._s(t.trans("labels.field_observations.elevation_m")))]),t._v(" "),n("div",{staticClass:"control is-fullwidth"},[n("input",{staticClass:"input is-small",attrs:{placeholder:"f.e. 500"},domProps:{value:t.elevation},on:{input:t.onElevationInput}})]),t._v(" "),t.errors.has("elevation")?n("p",{staticClass:"help is-danger",domProps:{textContent:t._s(t.errors.first("elevation"))}}):t._e()])]),t._v(" "),n("div",{staticClass:"field is-expanded"},[n("label",{staticClass:"label is-small"},[t._v(t._s(t.trans("labels.field_observations.location")))]),t._v(" "),n("div",{staticClass:"control is-fullwidth"},[n("input",{staticClass:"input is-small",class:{"is-danger":t.errors.has("location")},attrs:{placeholder:"Location"},domProps:{value:t.location},on:{input:t.onLocationInput}})]),t._v(" "),t.errors.has("location")?n("p",{staticClass:"help is-danger",domProps:{textContent:t._s(t.errors.first("location"))}}):t._e()]),t._v(" "),t._t("default")],2)],1)},[],!1,null,null,null).exports;function Q(t){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var tt={name:"nzPublicationAutocomplete",props:{label:{type:String,default:"Publication"},placeholder:{type:String,default:"Search for publication..."},publication:{type:Object,default:null},route:{type:String,default:"api.autocomplete.publications.index"},value:{type:String,default:""},error:Boolean,message:{type:String,default:null},except:{},autofocus:Boolean,disabled:Boolean},data:function(){return{data:[],selected:this.publication||null,loading:!1}},computed:{icon:function(){return this.selected?"check":"search"}},watch:{publication:function(t){this.selected=t}},methods:{fetchData:_.debounce(function(){var t=this;if(this.value){this.data=[],this.loading=!0;var e={citation:this.value};this.except&&(e.except=this.except),C.a.get(route(this.route),{params:e}).then(function(e){e.data.data.forEach(function(e){return t.data.push(e)}),t.loading=!1},function(e){t.loading=!1})}},500),onSelect:function(t){this.selected=t,this.$emit("select",t)},onInput:function(t){var e=this.getValue(this.selected);e&&e!==t&&this.onSelect(null),this.$emit("input",t),this.fetchData()},focusOnInput:function(){this.$el.querySelector("input").focus()},getValue:function(t){if(t)return"object"===Q(t)?_.get(t,"citation"):t}}},et=Object(p.a)(tt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-field",{staticClass:"nz-publication-autocomplete",attrs:{label:t.label,type:t.error?"is-danger":null,message:t.message}},[n("b-field",{attrs:{grouped:""}},[n("b-autocomplete",{attrs:{value:t.value,data:t.data,field:"citation",loading:t.loading,icon:t.icon,placeholder:t.placeholder,expanded:"",autofocus:t.autofocus,disabled:t.disabled},on:{input:t.onInput,select:t.onSelect},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"media"},[n("div",{staticClass:"media-content"},[t._v("\n            "+t._s(e.option.citation)+"\n          ")])])]}}])}),t._v(" "),t._t("default")],2)],1)},[],!1,null,null,null).exports;function nt(t){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var at={name:"nzTaxonAutocomplete",props:{label:{type:String,default:"Taxon"},placeholder:{type:String,default:"Search for taxon..."},taxon:{type:Object,default:null},url:{type:String,default:function(){return route("api.taxa.index")}},value:{type:String,default:""},error:Boolean,message:{type:String,default:null},except:{},autofocus:Boolean},data:function(){return{data:[],selected:this.taxon||null,loading:!1}},computed:{haveThumbnail:function(){return this.selected&&this.selected.thumbnail_url},icon:function(){return this.selected?"check":"search"}},watch:{taxon:function(t){this.selected=t}},methods:{fetchData:_.debounce(function(){var t=this;if(this.value){this.data=[],this.loading=!0;var e={name:this.value,limit:20};this.except&&(e.except=this.except),C.a.get(this.url,{params:e}).then(function(e){e.data.data.forEach(function(e){return t.data.push(e)}),t.loading=!1},function(e){t.loading=!1})}},500),onSelect:function(t){this.selected=t,this.$emit("select",t)},onInput:function(t){var e=this.getValue(this.selected);e&&e!==t&&this.onSelect(null),this.$emit("input",t),this.fetchData()},focusOnInput:function(){this.$el.querySelector("input").focus()},getValue:function(t){if(t)return"object"===nt(t)?_.get(t,"name"):t},enterPressed:function(){this.$refs.autocomplete.isActive||this.$emit("enter")}}},it=Object(p.a)(at,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-field",{staticClass:"nz-taxon-autocomplete",attrs:{label:t.label,type:t.error?"is-danger":null,message:t.message}},[n("b-field",{attrs:{grouped:""}},[t.haveThumbnail?n("img",{attrs:{width:"32",src:this.selected.thumbnail_url}}):t._e(),t._v(" "),n("b-autocomplete",{ref:"autocomplete",attrs:{value:t.value,data:t.data,field:"name",loading:t.loading,icon:t.icon,placeholder:t.placeholder,expanded:"",autofocus:t.autofocus},on:{input:t.onInput,select:t.onSelect},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.enterPressed(e)}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"media"},[n("div",{staticClass:"media-left"},[e.option.thumbnail_url?n("img",{attrs:{width:"32",src:e.option.thumbnail_url}}):t._e()]),t._v(" "),n("div",{staticClass:"media-content"},[t._v("\n            "+t._s(e.option.name)+t._s(e.option.native_name?" ("+e.option.native_name+")":"")+"\n          ")])])]}}])})],1)],1)},[],!1,null,null,null).exports;function st(t){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var ot={name:"nzUserAutocomplete",props:{label:{type:String,default:"User"},placeholder:{type:String,default:"Search for user..."},user:{type:Object,default:null},route:{type:String,default:"api.autocomplete.users.index"},value:{type:String,default:""},error:Boolean,message:{type:String,default:null},except:{},autofocus:Boolean,disabled:Boolean},data:function(){return{data:[],selected:this.user||null,loading:!1}},computed:{icon:function(){return this.selected?"check":null}},watch:{user:function(t){this.selected=t}},methods:{fetchData:_.debounce(function(){var t=this;if(this.value){this.data=[],this.loading=!0;var e={name:this.value};this.except&&(e.except=this.except),C.a.get(route(this.route),{params:e}).then(function(e){e.data.data.forEach(function(e){return t.data.push(e)}),t.loading=!1},function(e){t.loading=!1})}},500),onSelect:function(t){this.selected=t,this.$emit("select",t)},onInput:function(t){var e=this.getValue(this.selected);e&&e!==t&&this.onSelect(null),this.$emit("input",t),this.fetchData()},focusOnInput:function(){this.$el.querySelector("input").focus()},getValue:function(t){if(t)return"object"===st(t)?_.get(t,"full_name"):t}}},rt=Object(p.a)(ot,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-field",{staticClass:"nz-user-autocomplete",attrs:{label:t.label,type:t.error?"is-danger":null,message:t.message}},[n("b-field",{attrs:{grouped:""}},[n("b-autocomplete",{attrs:{value:t.value,data:t.data,field:"full_name",loading:t.loading,icon:t.icon,placeholder:t.placeholder,expanded:"",autofocus:t.autofocus,disabled:t.disabled},on:{input:t.onInput,select:t.onSelect},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"media"},[n("div",{staticClass:"media-content"},[t._v("\n            "+t._s(e.option.full_name)+" "),n("small",[t._v("<"+t._s(e.option.email)+">")])])])]}}])})],1)],1)},[],!1,null,null,null).exports,lt=n("rX62"),ct=n.n(lt),ut=ct.a.config.lang;function dt(){for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<5;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}ct.a.config.toolbar={getDefaultHTML:function(){return'\n    <div class="trix-button-row">\n      <span class="trix-button-group trix-button-group--text-tools" data-trix-button-group="text-tools">\n        <button type="button" class="trix-button trix-button--icon trix-button--icon-bold" data-trix-attribute="bold" data-trix-key="b" title="'.concat(ut.bold,'" tabindex="-1">').concat(ut.bold,'</button>\n        <button type="button" class="trix-button trix-button--icon trix-button--icon-italic" data-trix-attribute="italic" data-trix-key="i" title="').concat(ut.italic,'" tabindex="-1">').concat(ut.italic,'</button>\n        <button type="button" class="trix-button trix-button--icon trix-button--icon-strike" data-trix-attribute="strike" title="#{lang.strike}" tabindex="-1">').concat(ut.strike,'</button>\n        <button type="button" class="trix-button trix-button--icon trix-button--icon-link" data-trix-attribute="href" data-trix-action="link" data-trix-key="k" title="').concat(ut.link,'" tabindex="-1">').concat(ut.link,'</button>\n      </span>\n      <span class="trix-button-group trix-button-group--history-tools" data-trix-button-group="history-tools">\n        <button type="button" class="trix-button trix-button--icon trix-button--icon-undo" data-trix-action="undo" data-trix-key="z" title="').concat(ut.undo,'" tabindex="-1">').concat(ut.undo,'</button>\n        <button type="button" class="trix-button trix-button--icon trix-button--icon-redo" data-trix-action="redo" data-trix-key="shift+z" title="').concat(ut.redo,'" tabindex="-1">').concat(ut.redo,'</button>\n      </span>\n    </div>\n    <div class="trix-dialogs" data-trix-dialogs>\n      <div class="trix-dialog trix-dialog--link" data-trix-dialog="href" data-trix-dialog-attribute="href">\n        <div class="trix-dialog__link-fields">\n          <input type="url" name="href" class="trix-input trix-input--dialog" placeholder="').concat(ut.urlPlaceholder,'" required data-trix-input>\n          <div class="trix-button-group">\n            <input type="button" class="trix-button trix-button--dialog" value="').concat(ut.link,'" data-trix-method="setAttribute">\n            <input type="button" class="trix-button trix-button--dialog" value="').concat(ut.unlink,'" data-trix-method="removeAttribute">\n          </div>\n        </div>\n      </div>\n    </div>\n  ')}};var ft={name:"nzWysiwyg",props:{name:String,value:String},data:function(){return{inputId:dt()}},mounted:function(){this.$refs.trix.addEventListener("trix-change",this.onInput)},beforeDestroy:function(){this.$refs.trix.removeEventListener("trix-change",this.onInput)},methods:{onInput:function(t){this.$emit("input",t.target.innerHTML)},focus:function(){this.$refs.trix.focus()}}},mt=Object(p.a)(ft,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"wysiwyg"},[e("input",{ref:"input",attrs:{id:this.inputId,type:"hidden",name:this.name},domProps:{value:this.value}}),this._v(" "),e("trix-editor",{ref:"trix",attrs:{input:this.inputId}})],1)},[],!1,null,null,null).exports,ht={render:function(){return this.$slots.default[0]},inject:["handleClass"],mounted:function(){this.$el.classList.add(this.handleClass)}},pt=Object(p.a)(ht,void 0,void 0,!1,null,null,null).exports,bt={render:function(){return this.$slots.default[0]},inject:["itemClass"],mounted:function(){this.$el.classList.add(this.itemClass)}},vt=Object(p.a)(bt,void 0,void 0,!1,null,null,null).exports,gt=n("RmOr");function _t(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var yt={props:{value:{required:!0},itemClass:{default:"sortable-item"},handleClass:{default:"sortable-handle"}},provide:function(){return{itemClass:this.itemClass,handleClass:this.handleClass}},render:function(){return this.$scopedSlots.default({items:this.value})},mounted:function(){var t=this,e=new gt.Sortable(this.$el,{draggable:".".concat(this.itemClass),handle:".".concat(this.handleClass),mirror:{constrainDimensions:!0}}).on("sortable:stop",function(e){var n=e.oldIndex,a=e.newIndex;t.$emit("input",function(t,e,n){var a=[].concat(_t(t.slice(0,e)),_t(t.slice(e+1,t.length)));return[].concat(_t(a.slice(0,n)),[t[e]],_t(a.slice(n,a.length)))}(t.value,n,a))});this.$once("hook:beforeDestroy",function(){e.destroy()})}},xt={name:"nzColumnsPicker",components:{SortableHandle:pt,SortableItem:vt,SortableList:Object(p.a)(yt,void 0,void 0,!1,null,null,null).exports},props:{value:{type:Array,default:function(){return[]}},columns:{type:Array,required:!0},title:{type:String,default:function(){return"Columns"}}},data:function(){return{allColumns:this.columns,checkedColumns:_.uniq(this.value.concat(this.columns.filter(function(t){return t.required}).map(function(t){return t.value})))}},computed:{allChecked:function(){return this.checkedColumns.length&&this.checkedColumns.length===this.columns.length},checked:function(){var t=this;return this.allColumns.map(function(t){return t.value}).filter(function(e){return t.checkedColumns.includes(e)})},required:function(){return this.allColumns.filter(function(t){return t.required})}},watch:{checked:{immediate:!0,handler:function(){this.$emit("input",this.checked)}}},methods:{checkAll:function(t){t.target.checked?this.checkedColumns=this.allColumns.map(function(t){return t.value}):this.checkedColumns=this.required.map(function(t){return t.value})}}},Ct=(n("uDn1"),Object(p.a)(xt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("sortable-list",{staticClass:"columns-picker",scopedSlots:t._u([{key:"default",fn:function(e){var a=e.items;return n("div",{staticClass:"panel"},[n("div",{staticClass:"panel-heading"},[n("b-checkbox",{attrs:{value:t.allChecked},nativeOn:{change:function(e){return t.checkAll(e)}}}),t._v(t._s(t.title)+"\n    ")],1),t._v(" "),t._l(a,function(e,a){return n("sortable-item",{key:e.value},[n("sortable-handle",[n("div",{staticClass:"panel-block"},[n("label",{staticClass:"b-checkbox checkbox",attrs:{tabindex:!e.required&&0},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"])?null:(e.preventDefault(),e.target.click())}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.checkedColumns,expression:"checkedColumns"}],attrs:{type:"checkbox",disabled:e.required,required:e.required},domProps:{value:e.value,checked:Array.isArray(t.checkedColumns)?t._i(t.checkedColumns,e.value)>-1:t.checkedColumns},on:{change:function(n){var a=t.checkedColumns,i=n.target,s=!!i.checked;if(Array.isArray(a)){var o=e.value,r=t._i(a,o);i.checked?r<0&&(t.checkedColumns=a.concat([o])):r>-1&&(t.checkedColumns=a.slice(0,r).concat(a.slice(r+1)))}else t.checkedColumns=s}}}),t._v(" "),n("span",{staticClass:"check"}),t._v(" "),n("span",{staticClass:"control-label"},[t._v(t._s(e.label))])]),t._v(" "),n("b-icon",{attrs:{icon:"arrows-v",size:"is-small"}})],1)])],1)})],2)}}]),model:{value:t.allColumns,callback:function(e){t.allColumns=e},expression:"allColumns"}})},[],!1,null,null,null).exports),kt=n("is/s"),wt=n("DNgW"),St=n("wq27"),At=n("L/01");var Ot,Dt,Pt,jt=function(t){return(t<10?"0":"")+t},It={name:"nzDatetimePicker",components:(Ot={},Dt=At.a.name,Pt=At.a,Dt in Ot?Object.defineProperty(Ot,Dt,{value:Pt,enumerable:!0,configurable:!0,writable:!0}):Ot[Dt]=Pt,Ot),mixins:[kt.a],inheritAttrs:!1,props:{value:Date,dayNames:{type:Array,default:function(){return Array.isArray(St.a.defaultDayNames)?St.a.defaultDayNames:moment.weekdaysShort()}},monthNames:{type:Array,default:function(){return Array.isArray(St.a.defaultMonthNames)?St.a.defaultMonthNames:moment.months()}},firstDayOfWeek:{type:Number,default:function(){return"number"==typeof St.a.defaultFirstDayOfWeek?St.a.defaultFirstDayOfWeek:0}},inline:Boolean,minDate:Date,maxDate:Date,focusedDate:Date,placeholder:String,readonly:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},unselectableDates:Array,unselectableDaysOfWeek:{type:Array,default:function(){return St.a.defaultUnselectableDaysOfWeek}},selectableDates:Array,displayFormat:{type:String,default:"MM/DD/YYYY HH:mm"},dateFormatter:{type:Function,default:function(t){return"function"==typeof St.a.defaultDateFormatter?St.a.defaultDateFormatter(t):moment(t).format("MM/DD/YYYY HH:mm")}},dateParser:{type:Function,default:function(t){return"function"==typeof St.a.defaultDateParser?St.a.defaultDateParser(t):new Date(Date.parse(t))}},mobileNative:{type:Boolean,default:function(){return St.a.defaultDatepickerMobileNative}},position:String,events:Array,indicators:{type:String,default:"dots"},hourFormat:{type:String,default:"24",validator:function(t){return"24"===t||"12"===t}},incrementMinutes:{type:Number,default:1}},data:function(){var t=this.value||this.focusedDate||new Date;return{dateSelected:this.value,focusedDateData:{month:t.getMonth(),year:t.getFullYear()},hoursSelected:null,minutesSelected:null,meridienSelected:null,_elementRef:"input",_isDatepicker:!0}},computed:{listOfYears:function(){for(var t=this.maxDate?this.maxDate.getFullYear():Math.max((new Date).getFullYear(),this.focusedDateData.year)+3,e=[],n=this.minDate?this.minDate.getFullYear():1900;n<=t;n++)e.push(n);return e.reverse()},isFirstMonth:function(){return!!this.minDate&&new Date(this.focusedDateData.year,this.focusedDateData.month)<=new Date(this.minDate.getFullYear(),this.minDate.getMonth())},isLastMonth:function(){return!!this.maxDate&&new Date(this.focusedDateData.year,this.focusedDateData.month)>=new Date(this.maxDate.getFullYear(),this.maxDate.getMonth())},isMobile:function(){return this.mobileNative&&wt.c.any()},hours:function(){for(var t=[],e=this.isHourFormat24?24:12,n=0;n<e;n++){var a=n,i=a;this.isHourFormat24||(i=a=n+1,"AM"===this.meridienSelected?12===a&&(a=0):"PM"===this.meridienSelected&&12!==a&&(a+=12)),t.push({label:jt(i),value:a})}return t},minutes:function(){for(var t=[],e=0;e<60;e+=this.incrementMinutes)t.push({label:jt(e),value:e});return t},meridiens:function(){return["AM","PM"]},isHourFormat24:function(){return"24"===this.hourFormat}},watch:{dateSelected:function(t){var e=t||new Date;this.focusedDateData={month:e.getMonth(),year:e.getFullYear()},this.$emit("input",t),this.$refs.dropdown&&(this.$refs.dropdown.isActive=!0)},value:function(t){this.dateSelected=t,!this.isValid&&this.$refs.input.checkHtml5Validity()},focusedDate:function(t){t&&(this.focusedDateData={month:t.getMonth(),year:t.getFullYear()})},"focusedDateData.month":function(t){this.$emit("change-month",t)},"focusedDateData.year":function(t){this.$emit("change-year",t)},hourFormat:function(t){null!==this.hoursSelected&&(this.meridienSelected=this.hoursSelected>=12?"PM":"AM")}},methods:{updateSelectedDate:function(t){this.dateSelected=t},onChange:function(t){var e=this.dateParser(t);e&&!isNaN(e)?this.dateSelected=e:(this.dateSelected=null,this.$refs.input.newValue=this.dateSelected)},formatValue:function(t){if(t&&!isNaN(t))return this.dateFormatter(t)},decrementMonth:function(){this.disabled||(this.focusedDateData.month>0?this.focusedDateData.month-=1:(this.focusedDateData.month=11,this.focusedDateData.year-=1))},incrementMonth:function(){this.disabled||(this.focusedDateData.month<11?this.focusedDateData.month+=1:(this.focusedDateData.month=0,this.focusedDateData.year+=1))},formatYYYYMMDD:function(t){var e=new Date(t);if(t&&!isNaN(e)){var n=e.getFullYear(),a=e.getMonth()+1,i=e.getDate();return n+"-"+(a<10?"0":"")+a+"-"+(i<10?"0":"")+i}return""},onDateInput:function(t){this.dateSelected&&(t.setHours(this.dateSelected.getHours()),t.setMinutes(this.dateSelected.getMinutes())),this.dateSelected=t},onChangeNativePicker:function(t){var e=t.target.value;this.dateSelected=e?new Date(e):null},onMeridienChange:function(t){null!==this.hoursSelected&&("PM"===t?0===this.hoursSelected?this.hoursSelected=12:this.hoursSelected+=12:"AM"===t&&(12===this.hoursSelected?this.hoursSelected=0:this.hoursSelected-=12)),this.updateDateSelected(this.hoursSelected,this.minutesSelected,t)},onHoursChange:function(t){this.updateDateSelected(parseInt(t,10),this.minutesSelected,this.meridienSelected)},onMinutesChange:function(t){this.updateDateSelected(this.hoursSelected,parseInt(t,10),this.meridienSelected)},updateDateSelected:function(t,e,n){null!=t&&null!=e&&(!this.isHourFormat24&&null!==n||this.isHourFormat24)&&(this.dateSelected&&!isNaN(this.dateSelected)?this.dateSelected=new Date(this.dateSelected):(this.dateSelected=new Date,this.dateSelected.setMilliseconds(0),this.dateSelected.setSeconds(0)),this.dateSelected.setHours(t),this.dateSelected.setMinutes(e))},isHourDisabled:function(t){var e=this,n=!1;if(this.minTime){var a=this.minTime.getHours();n=t<a}if(this.maxTime&&!n){var i=this.maxTime.getHours();n=t>i}this.unselectableTimes&&!n&&(n=null!==this.minutesSelected?this.unselectableTimes.filter(function(n){return n.getHours()===t&&n.getMinutes()===e.minutesSelected}).length>0:this.unselectableTimes.filter(function(e){return e.getHours()===t}).length===this.minutes.length);return n},isMinuteDisabled:function(t){var e=this,n=!1;if(null!==this.hoursSelected){if(this.isHourDisabled(this.hoursSelected))n=!0;else if(this.minTime){var a=this.minTime.getHours(),i=this.minTime.getMinutes();n=this.hoursSelected===a&&t<i}else if(this.maxTime&&!n){var s=this.maxTime.getHours(),o=this.maxTime.getMinutes();n=this.hoursSelected===s&&t>o}if(this.unselectableTimes&&!n)n=this.unselectableTimes.filter(function(n){return n.getHours()===e.hoursSelected&&n.getMinutes()===t}).length>0}return n}}},Tt=Object(p.a)(It,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"datepicker control",class:[t.size,{"is-expanded":t.expanded}]},[!t.isMobile||t.inline?n("b-dropdown",{ref:"dropdown",attrs:{position:t.position,disabled:t.disabled,inline:t.inline}},[t._v('" custom>\n        '),n("header",{staticClass:"datepicker-header"},[void 0!==t.$slots.header&&t.$slots.header.length?[t._t("header")]:n("div",{staticClass:"pagination field is-centered"},[t.isFirstMonth||t.disabled?t._e():n("a",{staticClass:"pagination-previous",attrs:{role:"button",href:"#",disabled:t.disabled},on:{click:function(e){return e.preventDefault(),t.decrementMonth(e)},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.decrementMonth(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"])?null:(e.preventDefault(),t.decrementMonth(e))}]}},[n("b-icon",{attrs:{icon:"chevron-left",pack:t.iconPack,both:"",type:"is-primary is-clickable"}})],1),t._v(" "),n("a",{directives:[{name:"show",rawName:"v-show",value:!t.isLastMonth&&!t.disabled,expression:"!isLastMonth && !disabled"}],staticClass:"pagination-next",attrs:{role:"button",href:"#",disabled:t.disabled},on:{click:function(e){return e.preventDefault(),t.incrementMonth(e)},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.incrementMonth(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"])?null:(e.preventDefault(),t.incrementMonth(e))}]}},[n("b-icon",{attrs:{icon:"chevron-right",pack:t.iconPack,both:"",type:"is-primary is-clickable"}})],1),t._v(" "),n("div",{staticClass:"pagination-list"},[n("b-field",[n("b-select",{attrs:{disabled:t.disabled},model:{value:t.focusedDateData.month,callback:function(e){t.$set(t.focusedDateData,"month",e)},expression:"focusedDateData.month"}},t._l(t.monthNames,function(e,a){return n("option",{key:e,domProps:{value:a}},[t._v("\n                  "+t._s(e)+"\n                ")])}),0),t._v(" "),n("b-select",{attrs:{disabled:t.disabled},model:{value:t.focusedDateData.year,callback:function(e){t.$set(t.focusedDateData,"year",e)},expression:"focusedDateData.year"}},t._l(t.listOfYears,function(e){return n("option",{key:e,domProps:{value:e}},[t._v("\n                  "+t._s(e)+"\n                ")])}),0)],1)],1)])],2),t._v(" "),n("b-datepicker-table",{attrs:{value:t.dateSelected,"day-names":t.dayNames,"month-names":t.monthNames,"first-day-of-week":t.firstDayOfWeek,"min-date":t.minDate,"max-date":t.maxDate,focused:t.focusedDateData,disabled:t.disabled,"unselectable-dates":t.unselectableDates,"unselectable-days-of-week":t.unselectableDaysOfWeek,"selectable-dates":t.selectableDates,events:t.events,indicators:t.indicators},on:{input:t.onDateInput,close:function(e){t.$refs.dropdown.isActive=!0}}}),t._v(" "),n("b-field",{attrs:{expanded:""}},[n("b-select",{attrs:{disabled:t.disabled,placeholder:"00",expanded:""},nativeOn:{change:function(e){return t.onHoursChange(e.target.value)}},model:{value:t.hoursSelected,callback:function(e){t.hoursSelected=e},expression:"hoursSelected"}},t._l(t.hours,function(e){return n("option",{key:e.value,attrs:{disabled:t.isHourDisabled(e.value)},domProps:{value:e.value}},[t._v("\n            "+t._s(e.label)+"\n          ")])}),0),t._v(" "),n("b-select",{attrs:{disabled:t.disabled,placeholder:"00",expanded:""},nativeOn:{change:function(e){return t.onMinutesChange(e.target.value)}},model:{value:t.minutesSelected,callback:function(e){t.minutesSelected=e},expression:"minutesSelected"}},t._l(t.minutes,function(e){return n("option",{key:e.value,attrs:{disabled:t.isMinuteDisabled(e.value)},domProps:{value:e.value}},[t._v("\n            "+t._s(e.label)+"\n          ")])}),0),t._v(" "),t.isHourFormat24?t._e():n("b-select",{attrs:{disabled:t.disabled},nativeOn:{change:function(e){return t.onMeridienChange(e.target.value)}},model:{value:t.meridienSelected,callback:function(e){t.meridienSelected=e},expression:"meridienSelected"}},t._l(t.meridiens,function(e){return n("option",{key:e,domProps:{value:e}},[t._v("\n            "+t._s(e)+"\n          ")])}),0)],1),t._v(" "),void 0!==t.$slots.default&&t.$slots.default.length?n("footer",{staticClass:"datepicker-footer"},[t._t("default")],2):t._e()],1):n("b-input",t._b({ref:"input",attrs:{type:"datetime",autocomplete:"off",value:t.formatYYYYMMDD(t.value),placeholder:t.placeholder,size:t.size,icon:t.icon,"icon-pack":t.iconPack,loading:t.loading,max:t.formatYYYYMMDD(t.maxDate),min:t.formatYYYYMMDD(t.minDate),disabled:t.disabled,readonly:!1},on:{focus:function(e){return t.$emit("focus",e)},blur:function(e){t.$emit("blur",e)&&t.checkHtml5Validity()}},nativeOn:{change:function(e){return t.onChangeNativePicker(e)}}},"b-input",t.$attrs,!1))],1)},[],!1,null,null,null).exports,Rt={name:"nzTableMobileSort",props:{currentSortColumn:Object,isAsc:Boolean,columns:Array},data:function(){return{mobileSort:this.currentSortColumn}},watch:{mobileSort:function(t){this.currentSortColumn!==t&&this.$emit("sort",t)},currentSortColumn:function(t){this.mobileSort=t}},methods:{sort:function(){this.$emit("sort",this.mobileSort)}}};function $t(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Et={name:"nzTable",components:{NzTableMobileSort:Object(p.a)(Rt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"field table-mobile-sort"},[n("div",{staticClass:"field has-addons"},[n("b-select",{attrs:{expanded:""},model:{value:t.mobileSort,callback:function(e){t.mobileSort=e},expression:"mobileSort"}},t._l(t.columns,function(e,a){return e.sortable?n("option",{key:a,domProps:{value:e}},[t._v("\n                "+t._s(e.label)+"\n            ")]):t._e()}),0),t._v(" "),n("div",{staticClass:"control"},[n("button",{staticClass:"button is-primary",on:{click:t.sort}},[n("b-icon",{directives:[{name:"show",rawName:"v-show",value:t.currentSortColumn===t.mobileSort,expression:"currentSortColumn === mobileSort"}],class:{"is-desc":!t.isAsc},attrs:{icon:"arrow-up",size:"is-small",both:""}})],1)])],1)])},[],!1,null,null,null).exports},props:{data:{type:Array,default:function(){return[]}},bordered:Boolean,striped:Boolean,narrowed:Boolean,hoverable:Boolean,loading:Boolean,detailed:Boolean,checkable:Boolean,selected:Object,focusable:Boolean,customIsChecked:Function,checkedRows:{type:Array,default:function(){return[]}},mobileCards:{type:Boolean,default:!0},defaultSort:[String,Array],defaultSortDirection:{type:String,default:"asc"},paginated:Boolean,currentPage:{type:Number,default:1},perPage:{type:[Number,String],default:15},perPageOptions:{type:Array,default:function(){return[15,30,50,100]},validator:function(t){return t.length}},paginationSimple:Boolean,paginationSize:String,backendSorting:Boolean,rowClass:{type:Function,default:function(){return""}},openedDetailed:{type:Array,default:function(){return[]}},hasDetailedVisible:{type:Function,default:function(){return!0}},detailKey:{type:String,default:""},backendPagination:Boolean,total:{type:[Number,String],default:0},paginationOnTop:Boolean},data:function(){return{newColumns:[],visibleDetailRows:this.openedDetailed,newData:this.data,newDataTotal:this.backendPagination?this.total:this.data.length,newCheckedRows:$t(this.checkedRows),lastCheckedRowIndex:null,newCurrentPage:this.currentPage,currentSortColumn:{},isAsc:!0,firstTimeSort:!0,_isTable:!0}},watch:{data:function(t){var e=this,n=this.newColumns;this.newColumns=[],this.newData=t,this.$nextTick(function(){e.newColumns.length||(e.newColumns=n)}),this.backendSorting||this.sort(this.currentSortColumn,!0),this.backendPagination||(this.newDataTotal=t.length)},total:function(t){this.backendPagination&&(this.newDataTotal=t)},checkedRows:function(t){this.newCheckedRows=$t(t)},newColumns:function(t){if(t.length&&this.firstTimeSort)this.initSort(),this.firstTimeSort=!1;else if(t.length)for(var e=0;e<t.length;e++)if(t[e].newKey===this.currentSortColumn.newKey){this.currentSortColumn=t[e];break}},openedDetailed:function(t){this.visibleDetailRows=t},currentPage:function(t){this.newCurrentPage=t}},computed:{tableClasses:function(){return{"is-bordered":this.bordered,"is-striped":this.striped,"is-narrow":this.narrowed,"has-mobile-cards":this.mobileCards,"is-hoverable":(this.hoverable||this.focusable)&&this.visibleData.length}},visibleData:function(){if(!this.paginated)return this.newData;var t=this.newCurrentPage,e=this.perPage;if(this.newData.length<=e)return this.newData;var n=(t-1)*e,a=parseInt(n,10)+parseInt(e,10);return this.newData.slice(n,a)},isAllChecked:function(){var t=this,e=this.visibleData.some(function(e){return Object(wt.b)(t.checkedRows,e,t.customIsChecked)<0});return!e},hasSortableColumns:function(){return this.newColumns.some(function(t){return t.sortable})},columnCount:function(){var t=this.newColumns.length;return t+=this.checkable?1:0,t+=this.detailed?1:0},showing:function(){var t=this.newCurrentPage*this.perPage<=this.total?this.newCurrentPage*this.perPage:this.total,e=this.newCurrentPage>1?(this.newCurrentPage-1)*this.perPage+1:1;return this.total?this.trans("labels.tables.from_to_total",{total:this.total,from:e,to:t}):""}},methods:{sortBy:function(t,e,n,a){return n&&"function"==typeof n?$t(t).sort(function(t,e){return n(t,e,a)}):$t(t).sort(function(t,n){var i=Object(wt.a)(t,e),s=Object(wt.a)(n,e);return i||0===i?s||0===s?i===s?0:(i="string"==typeof i?i.toUpperCase():i,s="string"==typeof s?s.toUpperCase():s,a?i>s?1:-1:i>s?-1:1):-1:1})},sort:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&t.sortable&&(e||(this.isAsc=t===this.currentSortColumn?!this.isAsc:"desc"!==this.defaultSortDirection.toLowerCase()),this.firstTimeSort||this.$emit("sort",t.field,this.isAsc?"asc":"desc"),this.backendSorting||(this.newData=this.sortBy(this.newData,t.field,t.customSort,this.isAsc)),this.currentSortColumn=t)},isRowChecked:function(t){return Object(wt.b)(this.checkedRows,t,this.customIsChecked)>=0},removeCheckedRow:function(t){var e=Object(wt.b)(this.newCheckedRows,t,this.customIsChecked);e>=0&&this.newCheckedRows.splice(e,1)},checkAll:function(){var t=this,e=this.isAllChecked;this.visibleData.forEach(function(n){t.removeCheckedRow(n),e||t.newCheckedRows.push(n)}),this.$emit("check",this.newCheckedRows),this.$emit("check-all",this.newCheckedRows),this.$emit("update:checkedRows",this.newCheckedRows)},checkRow:function(t,e,n){var a=this.lastCheckedRowIndex;this.lastCheckedRowIndex=n,t.shiftKey&&null!==a&&n!==a?this.shiftCheckRow(e,n,a):this.isRowChecked(e)?this.removeCheckedRow(e):this.newCheckedRows.push(e),this.$emit("check",this.newCheckedRows,e),this.$emit("update:checkedRows",this.newCheckedRows)},shiftCheckRow:function(t,e,n){var a=this;this.visibleData.slice(Math.min(e,n),Math.max(e,n)+1).forEach(function(e){a.removeCheckedRow(e),a.isRowChecked(t)||a.newCheckedRows.push(e)})},selectRow:function(t,e){this.$emit("click",t),this.selected!==t&&(this.$emit("select",t,this.selected),this.$emit("update:selected",t))},pageChanged:function(t){this.newCurrentPage=t>0?t:1,this.$emit("page-change",this.newCurrentPage),this.$emit("update:currentPage",this.newCurrentPage)},toggleDetails:function(t){this.isVisibleDetailRow(t)?(this.closeDetailRow(t),this.$emit("details-close",t)):(this.openDetailRow(t),this.$emit("details-open",t)),this.$emit("update:openedDetailed",this.visibleDetailRows)},openDetailRow:function(t){var e=this.handleDetailKey(t);this.visibleDetailRows.push(e)},closeDetailRow:function(t){var e=this.handleDetailKey(t),n=this.visibleDetailRows.indexOf(e);this.visibleDetailRows.splice(n,1)},isVisibleDetailRow:function(t){var e=this.handleDetailKey(t);return this.visibleDetailRows.indexOf(e)>=0},handleDetailKey:function(t){var e=this.detailKey;return e.length?t[e]:t},checkPredefinedDetailedRows:function(){if(this.openedDetailed.length>0&&!this.detailKey.length)throw new Error('If you set a predefined opened-detailed, you must provide an unique key using the prop "detail-key"')},hasCustomFooterSlot:function(){if(this.$slots.footer.length>1)return!0;var t=this.$slots.footer[0].tag;return"th"===t||"td"===t},pressedArrow:function(t){if(this.visibleData.length){var e=this.visibleData.indexOf(this.selected)+t;e=e<0?0:e>this.visibleData.length-1?this.visibleData.length-1:e,this.selectRow(this.visibleData[e])}},focus:function(){this.focusable&&this.$el.querySelector("table").focus()},initSort:function(){var t=this;if(this.defaultSort){var e="",n=this.defaultSortDirection;Array.isArray(this.defaultSort)?(e=this.defaultSort[0],this.defaultSort[1]&&(n=this.defaultSort[1])):e=this.defaultSort,this.newColumns.forEach(function(a){a.field===e&&(t.isAsc="desc"!==n.toLowerCase(),t.sort(a,!0))})}},sortIcon:function(t){return this.currentSortColumn!==t?"sort":this.isAsc?"sort-asc":"sort-desc"},onPerPageChange:function(t){this.$emit("per-page-change",t)}},mounted:function(){this.checkPredefinedDetailedRows()}},Ft=Object(p.a)(Et,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"b-table",class:{"is-loading":t.loading}},[t.mobileCards&&t.hasSortableColumns?n("nz-table-mobile-sort",{attrs:{"current-sort-column":t.currentSortColumn,"is-asc":t.isAsc,columns:t.newColumns},on:{sort:function(e){return t.sort(e)}}}):t._e(),t._v(" "),t.paginated&&t.paginationOnTop?n("div",{staticClass:"level"},[n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item"},[n("b-field",[n("b-select",{attrs:{value:t.perPage,placeholder:"Per page"},on:{input:t.onPerPageChange}},t._l(t.perPageOptions,function(e,a){return n("option",{key:a,domProps:{value:e,textContent:t._s(e)}})}),0)],1)],1),t._v(" "),n("div",{staticClass:"level-item"},[t._v(t._s(t.showing))])]),t._v(" "),n("div",{staticClass:"level-right"},[n("div",{staticClass:"level-item"},[n("b-pagination",{attrs:{total:t.newDataTotal,"per-page":t.perPage,simple:t.paginationSimple,size:t.paginationSize,current:t.newCurrentPage},on:{change:t.pageChanged}})],1)])]):t._e(),t._v(" "),n("div",{staticClass:"table-wrapper"},[n("table",{staticClass:"table",class:t.tableClasses,attrs:{tabindex:!!t.focusable&&0},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.preventDefault(),t.pressedArrow(-1))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.preventDefault(),t.pressedArrow(1))}]}},[t.newColumns.length?n("thead",[n("tr",[t.detailed?n("th",{attrs:{width:"40px"}}):t._e(),t._v(" "),t.checkable?n("th",{staticClass:"checkbox-cell"},[n("b-checkbox",{attrs:{value:t.isAllChecked},nativeOn:{change:function(e){return t.checkAll(e)}}})],1):t._e(),t._v(" "),t._l(t.newColumns,function(e,a){return e.visible?n("th",{key:a,class:{"is-current-sort":t.currentSortColumn===e,"is-sortable":e.sortable},style:{width:e.width+"px"},on:{click:function(n){return n.stopPropagation(),t.sort(e)}}},[n("div",{staticClass:"th-wrap",class:{"is-numeric":e.numeric,"is-centered":e.centered}},[t.$scopedSlots.header?t._t("header",null,{column:e,index:a}):[t._v(t._s(e.label))],t._v(" "),e.sortable?n("b-icon",{class:{"has-text-grey-light":t.currentSortColumn!==e},attrs:{icon:t.sortIcon(e),size:"is-small"}}):t._e()],2)]):t._e()})],2)]):t._e(),t._v(" "),t.visibleData.length?n("tbody",[t._l(t.visibleData,function(e,a){return[n("tr",{key:a,class:[t.rowClass(e,a),{"is-selected":e===t.selected,"is-checked":t.isRowChecked(e)}],on:{click:function(n){return t.selectRow(e)},dblclick:function(n){return t.$emit("dblclick",e)}}},[t.detailed?n("td",{staticClass:"chevron-cell"},[t.hasDetailedVisible(e)?n("a",{attrs:{role:"button"},on:{click:function(n){return n.stopPropagation(),t.toggleDetails(e)}}},[n("b-icon",{class:{"is-expanded":t.isVisibleDetailRow(e)},attrs:{icon:"chevron-right",both:""}})],1):t._e()]):t._e(),t._v(" "),t.checkable?n("td",{staticClass:"checkbox-cell"},[n("b-checkbox",{attrs:{value:t.isRowChecked(e)},nativeOn:{click:function(n){return n.preventDefault(),t.checkRow(n,e,a)}}})],1):t._e(),t._v(" "),t.$scopedSlots.default?t._t("default",null,{row:e,index:a}):t._l(t.newColumns,function(a){return n("b-table-column",t._b({key:a.field,attrs:{internal:""}},"b-table-column",a,!1),[a.renderHtml?n("span",{domProps:{innerHTML:t._s(t.getValueByPath(e,a.field))}}):[t._v("\n                                    "+t._s(t.getValueByPath(e,a.field))+"\n                                ")]],2)})],2),t._v(" "),t.detailed&&t.isVisibleDetailRow(e)?n("tr",{staticClass:"detail"},[n("td",{attrs:{colspan:t.columnCount}},[n("div",{staticClass:"detail-container"},[t._t("detail",null,{row:e,index:a})],2)])]):t._e()]})],2):n("tbody",[n("tr",{staticClass:"is-empty"},[n("td",{attrs:{colspan:t.columnCount}},[t._t("empty")],2)])]),t._v(" "),void 0!==t.$slots.footer?n("tfoot",[n("tr",{staticClass:"table-footer"},[t.hasCustomFooterSlot()?t._t("footer"):n("th",{attrs:{colspan:t.columnCount}},[t._t("footer")],2)],2)]):t._e()])]),t._v(" "),t.checkable||t.paginated?n("div",{staticClass:"level"},[n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item"},[n("b-field",[n("b-select",{attrs:{value:t.perPage,placeholder:"Per page"},on:{input:t.onPerPageChange}},t._l(t.perPageOptions,function(e,a){return n("option",{key:a,domProps:{value:e,textContent:t._s(e)}})}),0)],1)],1),t._v(" "),n("div",{staticClass:"level-item"},[t._v(t._s(t.showing))])]),t._v(" "),n("div",{staticClass:"level-right"},[t.paginated?n("div",{staticClass:"level-item"},[n("b-pagination",{attrs:{total:t.newDataTotal,"per-page":t.perPage,simple:t.paginationSimple,size:t.paginationSize,current:t.newCurrentPage},on:{change:t.pageChanged}})],1):t._e()])]):t._e()],1)},[],!1,null,null,null).exports,Mt={data:function(){return{showFilter:!1,filter:this.filterDefaults(),newFilter:this.filterDefaults(),filterIsActive:!1}},methods:{filterDefaults:function(){return{}},clearFilter:function(){this.newFilter=this.filterDefaults(),this.applyFilter(!1)},applyFilter:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=!1;Object.keys(this.newFilter).forEach(function(e){t.filter[e]!==t.newFilter[e]&&(n=!0),t.filter[e]=t.newFilter[e]}),this.filterIsActive=e,n&&this.$emit("filter")}}};function zt(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var Lt=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,a;return e=t,(n=[{key:"get",value:function(t){var e=JSON.parse(localStorage.getItem(t));return e?new Date(e.expires)<new Date?(localStorage.removeItem(t),null):e.value:null}},{key:"has",value:function(t){return null!==this.get(t)}},{key:"set",value:function(t,e,n){var a=(new Date).getTime(),i=new Date(a+6e4*n);localStorage.setItem(t,JSON.stringify({value:e,expires:i}))}},{key:"delete",value:function(t){this.get(t)&&localStorage.removeItem(t)}}])&&zt(e.prototype,n),a&&zt(e,a),t}()),Nt={props:{cacheKey:{default:null},cacheLifetime:{default:1440}},computed:{storageKey:function(){return this.cacheKey?"nz-table.".concat(this.cacheKey):"nz-table.".concat(window.location.host).concat(window.location.pathname)}},methods:{getPersistantKeys:function(){return["sortField","sortOrder","perPage"]},saveState:function(){Lt.set(this.storageKey,_.pick(this.$data,this.getPersistantKeys()),this.cacheLifetime)},restoreState:function(){var t=this,e=Lt.get(this.storageKey);null!=e&&(this.getPersistantKeys().forEach(function(n){void 0!==e[n]&&t.$set(t,n,e[n])}),this.saveState())}}};function Ut(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Wt={name:"nzTaxaTable",mixins:[Mt,Nt],props:{perPageOptions:{type:Array,default:function(){return[15,30,50,100]},validator:function(t){return t.length}},listRoute:String,editRoute:String,deleteRoute:String,empty:{type:String,default:"Nothing here."},ranks:Array,showActivityLog:Boolean},data:function(){return{data:[],total:0,loading:!1,sortField:"id",sortOrder:"desc",defaultSortOrder:"asc",page:1,perPage:this.perPageOptions[0],checkedRows:[],activityLog:[]}},created:function(){this.restoreState(),this.loadAsyncData(),this.$on("filter",this.loadAsyncData)},methods:{loadAsyncData:function(){var t=this;return this.loading=!0,axios.get(route(this.listRoute,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){Ut(t,e,n[e])})}return t}({sort_by:"".concat(this.sortField,".").concat(this.sortOrder),page:this.page,per_page:this.perPage},this.filter))).then(function(e){var n=e.data;t.data=[],t.total=n.meta.total,n.data.forEach(function(e){return t.data.push(e)}),t.loading=!1},function(e){t.data=[],t.total=0,t.loading=!1})},onPageChange:function(t){this.page=t,this.loadAsyncData()},onSort:function(t,e){this.sortField=t,this.sortOrder=e,this.loadAsyncData()},onPerPageChange:function(t){t!==this.perPage&&(this.perPage=t,this.loadAsyncData())},confirmRemove:function(t){var e=this;this.$dialog.confirm({message:this.trans("Are you sure you want to delete this record?"),confirmText:this.trans("buttons.delete"),cancelText:this.trans("buttons.cancel"),type:"is-danger",onConfirm:function(){e.remove(t)}})},remove:function(t){var e=this;return axios.delete(route(this.deleteRoute,t.id)).then(function(t){e.$toast.open({message:e.trans("Record deleted"),type:"is-success"}),e.loadAsyncData()}).catch(function(t){console.error(t)})},editLink:function(t){return route(this.editRoute,t.id)},openActivityLogModal:function(t){this.activityLog=t.activity},filterDefaults:function(){return{name:"",rank:""}}}},Yt=Object(p.a)(Wt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"taxa-table"},[n("div",{staticClass:"level"},[n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item"},[n("button",{staticClass:"button is-touch-full",attrs:{type:"button"},on:{click:function(e){t.showFilter=!t.showFilter}}},[n("b-icon",{class:[t.filterIsActive?"has-text-primary":"has-text-grey-light"],attrs:{icon:"filter"}}),t._v(" "),n("span",[t._v(t._s(t.trans("buttons.filters")))])],1)])])]),t._v(" "),n("b-collapse",{staticClass:"mt-4",attrs:{open:t.showFilter}},[n("form",{on:{submit:function(e){return e.preventDefault(),t.applyFilter(e)}}},[n("div",{staticClass:"columns"},[n("b-field",{staticClass:"column",attrs:{label:t.trans("labels.taxa.rank")}},[n("b-select",{attrs:{expanded:""},model:{value:t.newFilter.rank,callback:function(e){t.$set(t.newFilter,"rank",e)},expression:"newFilter.rank"}},[n("option",{attrs:{value:""}}),t._v(" "),t._l(t.ranks,function(e,a){return n("option",{key:a,domProps:{value:e.value,textContent:t._s(e.label)}})})],2)],1),t._v(" "),n("b-field",{staticClass:"column",attrs:{label:t.trans("labels.taxa.name")}},[n("b-input",{model:{value:t.newFilter.name,callback:function(e){t.$set(t.newFilter,"name",e)},expression:"newFilter.name"}})],1)],1),t._v(" "),n("button",{staticClass:"button is-primary is-outlined",attrs:{type:"submit"},on:{click:t.applyFilter}},[t._v(t._s(t.trans("buttons.apply")))]),t._v(" "),n("button",{staticClass:"button",attrs:{type:"button"},on:{click:t.clearFilter}},[t._v(t._s(t.trans("buttons.clear")))])])]),t._v(" "),n("hr"),t._v(" "),n("nz-table",{attrs:{data:t.data,loading:t.loading,paginated:"","backend-pagination":"",total:t.total,"per-page":t.perPage,"per-page-options":t.perPageOptions,"pagination-on-top":"","backend-sorting":"","default-sort-direction":t.defaultSortOrder,"default-sort":[t.sortField,t.sortOrder],"mobile-cards":!0},on:{"page-change":t.onPageChange,"per-page-change":t.onPerPageChange,sort:t.onSort},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("b-table-column",{attrs:{field:"id",label:t.trans("labels.id"),width:"40",numeric:"",sortable:""}},[t._v("\n        "+t._s(a.id)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"rank_level",label:t.trans("labels.taxa.rank"),sortable:""}},[t._v("\n        "+t._s(a.rank_translation)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"name",label:t.trans("labels.taxa.name"),sortable:""}},[t._v("\n        "+t._s(a.name+(a.native_name?" ("+a.native_name+")":""))+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{width:"150",numeric:""}},[t.showActivityLog&&a.activity&&a.activity.length>0?n("a",{attrs:{title:t.trans("Activity Log")},on:{click:function(e){return t.openActivityLogModal(a)}}},[n("b-icon",{attrs:{icon:"history"}})],1):t._e(),t._v(" "),a.can_edit?n("a",{attrs:{href:t.editLink(a)}},[n("b-icon",{attrs:{icon:"edit"}})],1):t._e(),t._v(" "),a.can_delete?n("a",{on:{click:function(e){return t.confirmRemove(a)}}},[n("b-icon",{attrs:{icon:"trash"}})],1):t._e()])]}}])},[t._v(" "),n("template",{slot:"empty"},[n("section",{staticClass:"section"},[n("div",{staticClass:"content has-text-grey has-text-centered"},[n("p",[t._v(t._s(t.empty))])])])])],2),t._v(" "),n("b-modal",{attrs:{active:t.activityLog.length>0},on:{close:function(e){t.activityLog=[]}}},[n("div",{staticClass:"modal-card"},[n("div",{staticClass:"modal-card-head"},[n("b-icon",{attrs:{icon:"history"}}),t._v(" "),n("p",{staticClass:"modal-card-title"},[t._v(t._s(t.trans("Activity Log")))])],1),t._v(" "),n("div",{staticClass:"modal-card-body"},[n("nz-taxon-activity-log",{attrs:{activities:t.activityLog}})],1)])])],1)},[],!1,null,null,null).exports,Ht={name:"nzUsersTable",mixins:[Nt],props:{perPageOptions:{type:Array,default:function(){return[15,30,50,100]},validator:function(t){return t.length}},listRoute:String,editRoute:String,deleteRoute:String,empty:{type:String,default:"Nothing here."},ranks:Array},data:function(){return{data:[],total:0,loading:!1,sortField:"id",sortOrder:"asc",defaultSortOrder:"asc",page:1,perPage:this.perPageOptions[0],checkedRows:[],search:""}},created:function(){this.restoreState(),this.loadAsyncData()},methods:{loadAsyncData:function(){var t=this;return this.loading=!0,axios.get(route(this.listRoute,{sort_by:"".concat(this.sortField,".").concat(this.sortOrder),page:this.page,per_page:this.perPage,search:this.search})).then(function(e){var n=e.data;t.data=[],t.total=n.meta.total,n.data.forEach(function(e){return t.data.push(e)}),t.loading=!1},function(e){t.data=[],t.total=0,t.loading=!1})},onPageChange:function(t){this.page=t,this.loadAsyncData()},onSort:function(t,e){this.sortField=t,this.sortOrder=e,this.saveState(),this.loadAsyncData()},clearFilter:function(){for(var t in this.newFilter)this.newFilter[t]="";this.onFilter()},onFilter:function(){var t=!1;for(var e in this.newFilter)this.filter[e]!==this.newFilter[e]&&(t=!0),this.filter[e]=this.newFilter[e];t&&this.loadAsyncData()},onPerPageChange:function(t){t!==this.perPage&&(this.perPage=t,this.saveState(),this.loadAsyncData())},confirmRemove:function(t){var e=this;this.$dialog.confirm({message:this.trans("Are you sure you want to delete this record?"),confirmText:this.trans("buttons.delete"),cancelText:this.trans("buttons.cancel"),type:"is-danger",onConfirm:function(){e.remove(t)}})},remove:function(t){var e=this;return axios.delete(route(this.deleteRoute,t.id)).then(function(t){e.$toast.open({message:e.trans("Record deleted"),type:"is-success"}),e.loadAsyncData()}).catch(function(t){console.error(t)})},editLink:function(t){return route(this.editRoute,t.id)},performSearch:_.debounce(function(t){this.search!==t&&(this.search=t,this.loadAsyncData())},500),clearSearch:function(){this.search="",this.loadAsyncData()}}},qt=Object(p.a)(Ht,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"users-table"},[n("div",{staticClass:"level"},[n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item"},[n("b-field",[n("b-input",{attrs:{placeholder:t.trans("labels.users.search"),value:t.search,icon:"search",expanded:""},on:{input:t.performSearch}}),t._v(" "),t.search?n("p",{staticClass:"control"},[n("span",{staticClass:"button",on:{click:t.clearSearch}},[n("b-icon",{attrs:{icon:"close"}})],1)]):t._e()],1)],1)])]),t._v(" "),n("hr"),t._v(" "),n("nz-table",{attrs:{data:t.data,loading:t.loading,paginated:"","backend-pagination":"",total:t.total,"per-page":t.perPage,"per-page-options":t.perPageOptions,"pagination-on-top":"","backend-sorting":"","default-sort-direction":t.defaultSortOrder,"default-sort":[t.sortField,t.sortOrder],"mobile-cards":!0},on:{"page-change":t.onPageChange,"per-page-change":t.onPerPageChange,sort:t.onSort},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-table-column",{attrs:{field:"id",label:t.trans("labels.id"),width:"40",numeric:"",sortable:""}},[t._v("\n        "+t._s(e.row.id)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"first_name",label:t.trans("labels.users.first_name"),sortable:""}},[t._v("\n        "+t._s(e.row.first_name)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"last_name",label:t.trans("labels.users.last_name"),sortable:""}},[t._v("\n        "+t._s(e.row.last_name)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"email",label:t.trans("labels.users.email"),sortable:""}},[t._v("\n        "+t._s(e.row.email)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"institution",label:t.trans("labels.users.institution"),sortable:""}},[t._v("\n        "+t._s(e.row.institution)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{width:"150",numeric:""}},[n("a",{attrs:{href:t.editLink(e.row)}},[n("b-icon",{attrs:{icon:"edit"}})],1),t._v(" "),n("a",{on:{click:function(n){return t.confirmRemove(e.row)}}},[n("b-icon",{attrs:{icon:"trash"}})],1)])]}}])},[t._v(" "),n("template",{slot:"empty"},[n("section",{staticClass:"section"},[n("div",{staticClass:"content has-text-grey has-text-centered"},[n("p",[t._v(t._s(t.empty))])])])])],2)],1)},[],!1,null,null,null).exports;function Bt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Vt,Kt={name:"nzViewGroupsTable",mixins:[Nt],props:{perPageOptions:{type:Array,default:function(){return[15,30,50,100]},validator:function(t){return t.length}},listRoute:String,editRoute:String,deleteRoute:String,empty:{type:String,default:"Nothing here."},ranks:Array,showActivityLog:Boolean},data:function(){return{data:[],total:0,loading:!1,sortField:"id",sortOrder:"desc",defaultSortOrder:"asc",page:1,perPage:this.perPageOptions[0],checkedRows:[]}},created:function(){this.restoreState(),this.loadAsyncData()},methods:{loadAsyncData:function(){var t=this;return this.loading=!0,axios.get(route(this.listRoute,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){Bt(t,e,n[e])})}return t}({sort_by:"".concat(this.sortField,".").concat(this.sortOrder),page:this.page,per_page:this.perPage},this.filter))).then(function(e){var n=e.data;t.data=[],t.total=n.meta.total,n.data.forEach(function(e){return t.data.push(e)}),t.loading=!1},function(e){t.data=[],t.total=0,t.loading=!1})},onPageChange:function(t){this.page=t,this.loadAsyncData()},onSort:function(t,e){this.sortField=t,this.sortOrder=e,this.saveState(),this.loadAsyncData()},onPerPageChange:function(t){t!==this.perPage&&(this.perPage=t,this.saveState(),this.loadAsyncData())},confirmRemove:function(t){var e=this;this.$dialog.confirm({message:this.trans("Are you sure you want to delete this record?"),confirmText:this.trans("buttons.delete"),cancelText:this.trans("buttons.cancel"),type:"is-danger",onConfirm:function(){e.remove(t)}})},remove:function(t){var e=this;return axios.delete(route(this.deleteRoute,t.id)).then(function(t){e.$toast.open({message:e.trans("Record deleted"),type:"is-success"}),e.loadAsyncData()}).catch(function(t){console.error(t)})},editLink:function(t){return route(this.editRoute,t.id)}}},Zt=Object(p.a)(Kt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"view-groups-table"},[n("nz-table",{attrs:{data:t.data,loading:t.loading,paginated:"","backend-pagination":"",total:t.total,"per-page":t.perPage,"per-page-options":t.perPageOptions,"pagination-on-top":"","backend-sorting":"","default-sort-direction":t.defaultSortOrder,"default-sort":[t.sortField,t.sortOrder],"mobile-cards":!0},on:{"page-change":t.onPageChange,"per-page-change":t.onPerPageChange,sort:t.onSort},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("b-table-column",{attrs:{field:"id",label:t.trans("labels.id"),width:"40",numeric:"",sortable:""}},[t._v("\n        "+t._s(a.id)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"name",label:t.trans("labels.view_groups.name")}},[t._v("\n        "+t._s(a.name)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{width:"150",numeric:""}},[n("a",{attrs:{href:t.editLink(a)}},[n("b-icon",{attrs:{icon:"edit"}})],1),t._v(" "),n("a",{on:{click:function(e){return t.confirmRemove(a)}}},[n("b-icon",{attrs:{icon:"trash"}})],1)])]}}])},[t._v(" "),n("template",{slot:"empty"},[n("section",{staticClass:"section"},[n("div",{staticClass:"content has-text-grey has-text-centered"},[n("p",[t._v(t._s(t.empty))])])])])],2)],1)},[],!1,null,null,null).exports,Xt={name:"nzAnnouncementsTable",mixins:[Nt],props:{perPageOptions:{type:Array,default:function(){return[15,30,50,100]},validator:function(t){return t.length}},listRoute:String,editRoute:String,deleteRoute:String,empty:{type:String,default:"Nothing here."},ranks:Array},data:function(){return{data:[],meta:null,total:0,loading:!1,sortField:"name",sortOrder:"asc",defaultSortOrder:"asc",page:1,perPage:this.perPageOptions[0],checkedRows:[]}},computed:{showing:function(){if(this.meta)return this.trans("labels.tables.from_to_total",{from:_.get(this.meta,"from")||0,to:_.get(this.meta,"to")||0,total:_.get(this.meta,"total")||0})}},created:function(){this.restoreState(),this.loadAsyncData()},methods:{loadAsyncData:function(){var t=this;return this.loading=!0,axios.get(route(this.listRoute,{sort_by:"".concat(this.sortField,".").concat(this.sortOrder),page:this.page,per_page:this.perPage})).then(function(e){var n=e.data;t.data=[],t.total=n.meta.total,n.data.forEach(function(e){return t.data.push(e)}),t.meta=n.meta,t.loading=!1},function(e){t.data=[],t.meta=null,t.total=0,t.loading=!1})},onPageChange:function(t){this.page=t,this.loadAsyncData()},onSort:function(t,e){this.sortField=t,this.sortOrder=e,this.saveState(),this.loadAsyncData()},clearFilter:function(){for(var t in this.newFilter)this.newFilter[t]="";this.onFilter()},onFilter:function(){var t=!1;for(var e in this.newFilter)this.filter[e]!==this.newFilter[e]&&(t=!0),this.filter[e]=this.newFilter[e];t&&this.loadAsyncData()},onPerPageChange:function(t){t!==this.perPage&&(this.perPage=t,this.saveState(),this.loadAsyncData())},confirmRemove:function(t){var e=this;this.$dialog.confirm({message:this.trans("Are you sure you want to delete this record?"),confirmText:this.trans("buttons.delete"),cancelText:this.trans("buttons.cancel"),type:"is-danger",onConfirm:function(){e.remove(t)}})},remove:function(t){var e=this;return axios.delete(route(this.deleteRoute,t.id)).then(function(t){e.$toast.open({message:e.trans("Record deleted"),type:"is-success"}),e.loadAsyncData()}).catch(function(t){console.error(t)})},editLink:function(t){return route(this.editRoute,t.id)}},filters:{formatDateTime:function(t){var e=moment(t);return e.isValid()?e.format("D.M.YYYY HH:mm"):""}}},Gt=Object(p.a)(Xt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"announcements-table"},[n("nz-table",{attrs:{data:t.data,loading:t.loading,paginated:"","backend-pagination":"",total:t.total,"per-page":t.perPage,"backend-sorting":"","default-sort-direction":t.defaultSortOrder,"default-sort":[t.sortField,t.sortOrder],"mobile-cards":!0},on:{"page-change":t.onPageChange,"per-page-change":t.onPerPageChange,sort:t.onSort},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-table-column",{attrs:{field:"id",label:t.trans("labels.id"),width:"40",numeric:"",sortable:""}},[t._v("\n        "+t._s(e.row.id)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"title",label:t.trans("labels.announcements.title"),sortable:""}},[t._v("\n        "+t._s(e.row.title||"--")+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"created_at",label:t.trans("labels.created_at"),sortable:""}},[t._v("\n        "+t._s(t._f("formatDateTime")(e.row.created_at))+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{width:"150",numeric:""}},[n("a",{attrs:{href:t.editLink(e.row)}},[n("b-icon",{attrs:{icon:"edit"}})],1),t._v(" "),n("a",{on:{click:function(n){return t.confirmRemove(e.row)}}},[n("b-icon",{attrs:{icon:"trash"}})],1)])]}}])},[t._v(" "),n("template",{slot:"empty"},[n("section",{staticClass:"section"},[n("div",{staticClass:"content has-text-grey has-text-centered"},[n("p",[t._v(t._s(t.empty))])])])])],2)],1)},[],!1,null,null,null).exports,Jt={name:"nzExportDownloadModal",props:{url:{type:String,required:!0}},computed:{filename:function(){var t=this.url.substring(this.url.lastIndexOf("/")+1);return"export-".concat(t)}}},Qt=Object(p.a)(Jt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-card"},[n("div",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[t._v(t._s(t.trans("labels.exports.title")))])]),t._v(" "),n("div",{staticClass:"modal-card-body"},[t._v("\n    "+t._s(t.trans("labels.exports.finished"))+"\n\n    "),n("a",{attrs:{href:t.url,download:t.filename}},[t._v(t._s(t.trans("buttons.download")))])]),t._v(" "),n("div",{staticClass:"modal-card-foot"},[n("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}},[t._v(t._s(t.trans("buttons.close")))])])])},[],!1,null,null,null).exports;function te(t,e){if(null==t)return{};var n,a,i=function(t,e){if(null==t)return{};var n,a,i={},s=Object.keys(t);for(a=0;a<s.length;a++)n=s[a],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)n=s[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function ee(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ne={name:"nzFieldObservationsTable",mixins:[Mt,Nt],props:{perPageOptions:{type:Array,default:function(){return[15,30,50,100]},validator:function(t){return t.length}},listRoute:String,viewRoute:String,editRoute:String,deleteRoute:String,approveRoute:String,markAsUnidentifiableRoute:String,moveToPendingRoute:String,empty:{type:String,default:"Nothing here."},approvable:Boolean,markableAsUnidentifiable:Boolean,movableToPending:Boolean,showStatus:Boolean,showActivityLog:Boolean,showObserver:Boolean,exportUrl:String,exportColumns:{type:Array,default:function(){return[]}}},data:function(){return{data:[],total:0,loading:!1,sortField:"id",sortOrder:"desc",defaultSortOrder:"desc",page:1,perPage:this.perPageOptions[0],isImageModalActive:!1,modalImages:[],modalImageIndex:0,checkedRows:[],approving:!1,markingAsUnidentifiable:!1,movingToPending:!1,activityLog:[],showExportModal:!1}},computed:(Vt={hasActions:function(){return this.approvable||this.markableAsUnidentifiable||this.movableToPending},months:function(){return moment.months()},days:function(){return _.range(1,31)}},ee(Vt,"hasActions",function(){return this.approvable||this.markableAsUnidentifiable||this.movableToPending||this.exportable}),ee(Vt,"actionRunning",function(){return this.approving||this.movingToPending||this.markingAsUnidentifiable}),ee(Vt,"checkedIds",function(){return this.checkedRows.map(function(t){return t.id})}),ee(Vt,"exportable",function(){return!(!this.exportUrl||!this.exportColumns.length)}),Vt),created:function(){var t=this;this.restoreState(),this.loadAsyncData(),this.$on("filter",function(){t.saveState(),t.loadAsyncData()})},methods:{loadAsyncData:function(){var t=this;this.loading=!0;var e=this.filter,n=(e.selectedTaxon,te(e,["selectedTaxon"]));return axios.get(route(this.listRoute,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){ee(t,e,n[e])})}return t}({},n,{sort_by:"".concat(this.sortField,".").concat(this.sortOrder),page:this.page,per_page:this.perPage}))).then(function(e){var n=e.data;t.data=[],t.total=n.meta.total,n.data.forEach(function(e){return t.data.push(e)}),t.loading=!1},function(){t.data=[],t.total=0,t.loading=!1})},getPersistantKeys:function(){return["sortField","sortOrder","perPage","page","newFilter","filter","filterIsActive"]},onPageChange:function(t){this.page=t,this.saveState(),this.loadAsyncData()},onSort:function(t,e){this.sortField=t,this.sortOrder=e,this.saveState(),this.loadAsyncData()},onPerPageChange:function(t){t!==this.perPage&&(this.perPage=t,this.saveState(),this.loadAsyncData())},confirmRemove:function(t){var e=this;this.$dialog.confirm({message:this.trans("Are you sure you want to delete this record?"),confirmText:this.trans("buttons.delete"),cancelText:this.trans("buttons.cancel"),type:"is-danger",onConfirm:function(){e.remove(t)}})},remove:function(t){var e=this;return axios.delete(route(this.deleteRoute,t.id)).then(function(t){e.$toast.open({message:e.trans("Record deleted"),type:"is-success"}),e.loadAsyncData()}).catch(function(t){console.error(t)})},editLink:function(t){return route(this.editRoute,t.id)},viewLink:function(t){return this.viewRoute?route(this.viewRoute,t.id):null},openImageModal:function(t,e){this.modalImageIndex=e,this.modalImages=t.map(function(t){return t.url})},onCarouselClose:function(){this.modalImages=[],this.modalImagesIndex=0},confirmApprove:function(){this.$dialog.confirm({message:this.trans("You are about to approve checked observations.<br/>Those of them that cannot be approved, will not be approved."),confirmText:this.trans("buttons.approve"),cancelText:this.trans("buttons.cancel"),type:"is-primary",onConfirm:this.approve.bind(this)})},approve:function(){this.approving=!0,axios.post(route(this.approveRoute),{field_observation_ids:this.checkedRows.map(function(t){return t.id})}).then(this.successfullyApproved).catch(this.failedToApprove)},successfullyApproved:function(){this.checkedRows=[],this.approving=!1,this.$toast.open({message:this.trans("Observations have been approved"),type:"is-success"}),this.loadAsyncData()},failedToApprove:function(t){this.approving=!1,this.$toast.open({message:this.trans("Observations cannot be approved"),type:"is-danger",duration:5e3})},confirmMarkingAsUnidentifiable:function(){var t=this,e=this.$dialog.prompt({message:this.trans("You are about to mark checked observations as unidentifiable. What's the reason?"),confirmText:this.trans("buttons.mark_unidentifiable"),cancelText:this.trans("buttons.cancel"),type:"is-warning",inputAttrs:{placeholder:this.trans("Reason"),required:!0,maxlength:255},onConfirm:this.markAsUnidentifiable.bind(this)});e.$nextTick(function(){t.validateReason(e)})},markAsUnidentifiable:function(t){this.markingAsUnidentifiable=!0,axios.post(route(this.markAsUnidentifiableRoute),{field_observation_ids:this.checkedRows.map(function(t){return t.id}),reason:t}).then(this.successfullyMarkedAsUnidentifiable).catch(this.failedToMarkAsUnidentifiable)},successfullyMarkedAsUnidentifiable:function(){this.checkedRows=[],this.markingAsUnidentifiable=!1,this.$toast.open({message:this.trans("Observations have been marked as unidentifiable"),type:"is-success"}),this.loadAsyncData()},failedToMarkAsUnidentifiable:function(t){this.markingAsUnidentifiable=!1,this.$toast.open({message:this.trans("Some of the observations cannot be marked as unidentifiable"),type:"is-danger",duration:5e3})},determineStatusIcon:function(t){return"unidentifiable"===t?"times":"approved"===t?"check":"question"},determineStatusClass:function(t){return"unidentifiable"===t?"has-text-danger":"approved"===t?"has-text-success":"has-text-info"},openActivityLogModal:function(t){this.activityLog=t.activity},validateReason:function(t){var e=this;t.$refs.input.addEventListener("invalid",function(t){t.target.setCustomValidity(""),t.target.validity.valid||t.target.setCustomValidity(e.trans("This field is required and can contain max 255 chars."))}),t.$refs.input.addEventListener("input",function(e){t.validationMessage=null})},confirmMoveToPending:function(){var t=this,e=this.$dialog.prompt({message:this.trans("You are about to move checked observations to pending. What's the reason?"),confirmText:this.trans("buttons.move_to_pending"),cancelText:this.trans("buttons.cancel"),type:"is-warning",inputAttrs:{placeholder:this.trans("Reason"),required:!0,maxlength:255},onConfirm:this.moveToPending.bind(this)});e.$nextTick(function(){t.validateReason(e)})},moveToPending:function(t){this.movingToPending=!0,axios.post(route(this.moveToPendingRoute),{field_observation_ids:this.checkedRows.map(function(t){return t.id}),reason:t}).then(this.successfullyMovedToPending).catch(this.failedToMoveToPending)},successfullyMovedToPending:function(){this.checkedRows=[],this.movingToPending=!1,this.$toast.open({message:this.trans("Observations have been moved to pending"),type:"is-success"}),this.loadAsyncData()},failedToMoveToPending:function(t){this.movingToPending=!1,this.$toast.open({message:this.trans("Whoops, looks like something went wrong."),type:"is-danger",duration:5e3}),this.loadAsyncData()},filterDefaults:function(){return{status:null,taxon:null,taxonId:null,year:null,month:null,day:null,photos:null,observer:null,includeChildTaxa:!1,selectedTaxon:null,project:null}},openExportModal:function(){this.showExportModal=!0},onExportDone:function(t){this.showExportModal=!1,t.url?this.$modal.open({parent:this,component:Qt,canCancel:[],hasModalCard:!0,props:{url:t.url}}):this.$toast.open({duration:0,message:"Something's not good, also I'm on bottom",type:"is-danger"})},onTaxonSelect:function(t){this.newFilter.taxonId=t?t.id:null,this.newFilter.selectedTaxon=t}},filters:{truncate:function(t,e){return t.length>e?t.substr(0,e)+"...":t}}},ae=Object(p.a)(ne,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"field-observations-table"},[n("div",{staticClass:"level"},[n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item"},[n("button",{staticClass:"button is-touch-full",attrs:{type:"button"},on:{click:function(e){t.showFilter=!t.showFilter}}},[n("b-icon",{class:[t.filterIsActive?"has-text-primary":"has-text-grey"],attrs:{icon:"filter",size:t.filterIsActive?null:"is-small"}}),t._v(" "),n("span",[t._v(t._s(t.trans("buttons.filters")))])],1)])]),t._v(" "),t.hasActions?n("div",{staticClass:"level-right"},[n("div",{staticClass:"level-item"},[n("b-dropdown",{attrs:{position:"is-bottom-left"}},[n("button",{staticClass:"button is-touch-full",class:{"is-loading":t.actionRunning},attrs:{slot:"trigger"},slot:"trigger"},[n("span",[t._v(t._s(t.trans("labels.actions")))]),t._v(" "),n("span",{staticClass:"icon has-text-grey"},[n("i",{staticClass:"fa fa-angle-down"})])]),t._v(" "),t.approvable?n("b-dropdown-item",{attrs:{disabled:!t.checkedRows.length},on:{click:t.confirmApprove}},[n("b-icon",{staticClass:"has-text-success",attrs:{icon:"check"}}),t._v(" "),n("span",[t._v(t._s(t.trans("buttons.approve")))])],1):t._e(),t._v(" "),t.markableAsUnidentifiable?n("b-dropdown-item",{attrs:{disabled:!t.checkedRows.length},on:{click:t.confirmMarkingAsUnidentifiable}},[n("b-icon",{staticClass:"has-text-danger",attrs:{icon:"times"}}),t._v(" "),n("span",[t._v(t._s(t.trans("buttons.unidentifiable")))])],1):t._e(),t._v(" "),t.movableToPending?n("b-dropdown-item",{attrs:{disabled:!t.checkedRows.length},on:{click:t.confirmMoveToPending}},[n("b-icon",{staticClass:"has-text-warning",attrs:{icon:"question"}}),t._v(" "),n("span",[t._v(t._s(t.trans("buttons.move_to_pending")))])],1):t._e(),t._v(" "),t.exportable?n("b-dropdown-item",{on:{click:t.openExportModal}},[n("b-icon",{staticClass:"has-text-grey",attrs:{icon:"download"}}),t._v(" "),n("span",[t._v(t._s(t.trans("buttons.export")))])],1):t._e()],1)],1)]):t._e()]),t._v(" "),n("b-collapse",{staticClass:"mt-4",attrs:{open:t.showFilter}},[n("form",{on:{submit:function(e){return e.preventDefault(),t.applyFilter(e)}}},[n("div",{staticClass:"columns is-multiline"},[n("div",{staticClass:"column is half"},[n("nz-taxon-autocomplete",{attrs:{taxon:t.newFilter.selectedTaxon,label:t.trans("labels.field_observations.taxon"),placeholder:t.trans("labels.field_observations.search_for_taxon")},on:{select:t.onTaxonSelect},model:{value:t.newFilter.taxon,callback:function(e){t.$set(t.newFilter,"taxon",e)},expression:"newFilter.taxon"}}),t._v(" "),n("b-checkbox",{model:{value:t.newFilter.includeChildTaxa,callback:function(e){t.$set(t.newFilter,"includeChildTaxa",e)},expression:"newFilter.includeChildTaxa"}},[t._v(t._s(t.trans("labels.field_observations.include_lower_taxa")))])],1),t._v(" "),n("b-field",{staticClass:"column is-half",attrs:{label:t.trans("labels.field_observations.date")}},[n("b-field",{attrs:{expanded:"",grouped:""}},[n("b-field",{attrs:{expanded:""}},[n("b-input",{attrs:{placeholder:t.trans("labels.field_observations.year")},model:{value:t.newFilter.year,callback:function(e){t.$set(t.newFilter,"year",e)},expression:"newFilter.year"}})],1),t._v(" "),n("b-field",{attrs:{expanded:""}},[n("b-select",{attrs:{placeholder:t.trans("labels.field_observations.month"),expanded:""},model:{value:t.newFilter.month,callback:function(e){t.$set(t.newFilter,"month",e)},expression:"newFilter.month"}},[n("option",{domProps:{value:null}}),t._v(" "),t._l(t.months,function(e,a){return n("option",{key:a,domProps:{value:a+1,textContent:t._s(e)}})})],2)],1),t._v(" "),n("b-field",{attrs:{expanded:""}},[n("b-select",{attrs:{placeholder:t.trans("labels.field_observations.day"),expanded:""},model:{value:t.newFilter.day,callback:function(e){t.$set(t.newFilter,"day",e)},expression:"newFilter.day"}},[n("option",{domProps:{value:null}}),t._v(" "),t._l(t.days,function(e){return n("option",{key:e,domProps:{value:e,textContent:t._s(e)}})})],2)],1)],1)],1),t._v(" "),t.showObserver?n("nz-user-autocomplete",{staticClass:"column is-half",attrs:{label:t.trans("labels.field_observations.observer"),placeholder:""},model:{value:t.newFilter.observer,callback:function(e){t.$set(t.newFilter,"observer",e)},expression:"newFilter.observer"}}):t._e(),t._v(" "),t.showStatus?n("b-field",{staticClass:"column is-half",attrs:{label:t.trans("labels.field_observations.status")}},[n("b-select",{attrs:{expanded:""},model:{value:t.newFilter.status,callback:function(e){t.$set(t.newFilter,"status",e)},expression:"newFilter.status"}},[n("option",{domProps:{value:null}}),t._v(" "),t._l(["approved","unidentifiable","pending"],function(e,a){return n("option",{key:a,domProps:{value:e,textContent:t._s(t.trans("labels.field_observations.statuses."+e))}})})],2)],1):t._e(),t._v(" "),n("b-field",{staticClass:"column is-half",attrs:{label:t.trans("labels.field_observations.photos")}},[n("b-select",{attrs:{expanded:""},model:{value:t.newFilter.photos,callback:function(e){t.$set(t.newFilter,"photos",e)},expression:"newFilter.photos"}},[n("option",{domProps:{value:null}}),t._v(" "),n("option",{attrs:{value:"yes"}},[t._v(t._s(t.trans("Yes")))]),t._v(" "),n("option",{attrs:{value:"no"}},[t._v(t._s(t.trans("No")))])])],1),t._v(" "),n("b-field",{staticClass:"column is-half",attrs:{label:t.trans("labels.field_observations.project")}},[n("b-input",{attrs:{expanded:""},model:{value:t.newFilter.project,callback:function(e){t.$set(t.newFilter,"project",e)},expression:"newFilter.project"}})],1)],1),t._v(" "),n("button",{staticClass:"button is-primary is-outlined",attrs:{type:"button"},on:{click:t.applyFilter}},[t._v(t._s(t.trans("buttons.apply")))]),t._v(" "),n("button",{staticClass:"button",attrs:{type:"button"},on:{click:t.clearFilter}},[t._v(t._s(t.trans("buttons.clear")))])])]),t._v(" "),n("hr"),t._v(" "),n("nz-table",{attrs:{data:t.data,loading:t.loading,paginated:"","backend-pagination":"",total:t.total,"per-page":t.perPage,"current-page":t.page,"per-page-options":t.perPageOptions,"pagination-on-top":"","backend-sorting":"","default-sort-direction":t.defaultSortOrder,"default-sort":[t.sortField,t.sortOrder],detailed:"","mobile-cards":!0,checkable:t.hasActions,"checked-rows":t.checkedRows},on:{"page-change":t.onPageChange,"per-page-change":t.onPerPageChange,sort:t.onSort,"update:checkedRows":function(e){t.checkedRows=e},"update:checked-rows":function(e){t.checkedRows=e}},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("b-table-column",{attrs:{field:"id",label:t.trans("labels.id"),width:"40",numeric:"",sortable:""}},[t._v("\n        "+t._s(a.id)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"taxon_name",label:t.trans("labels.field_observations.taxon"),sortable:""}},[t._v("\n        "+t._s(a.taxon?a.taxon.name:"")+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"year",label:t.trans("labels.field_observations.year"),numeric:"",sortable:""}},[t._v("\n        "+t._s(a.year)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"month",label:t.trans("labels.field_observations.month"),numeric:"",sortable:""}},[t._v("\n        "+t._s(a.month)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"day",label:t.trans("labels.field_observations.day"),numeric:"",sortable:""}},[t._v("\n        "+t._s(a.day)+"\n      ")]),t._v(" "),t.showObserver?n("b-table-column",{attrs:{field:"observer",label:t.trans("labels.field_observations.observer"),sortable:""}},[t._v("\n        "+t._s(a.observer)+"\n      ")]):t._e(),t._v(" "),t.showStatus?n("b-table-column",{attrs:{field:"status",label:t.trans("labels.field_observations.status")}},[n("span",{class:t.determineStatusClass(a.status),attrs:{title:t.trans("labels.field_observations.statuses."+a.status)}},[n("b-icon",{attrs:{icon:t.determineStatusIcon(a.status)}})],1)]):t._e(),t._v(" "),n("b-table-column",{attrs:{width:"150",numeric:""}},[a.photos.length?n("a",{on:{click:function(e){return t.openImageModal(a.photos)}}},[n("b-icon",{attrs:{icon:"photo"}})],1):t._e(),t._v(" "),t.showActivityLog?n("a",{attrs:{title:t.trans("Activity Log")},on:{click:function(e){return t.openActivityLogModal(a)}}},[n("b-icon",{attrs:{icon:"history"}})],1):t._e(),t._v(" "),t.viewRoute?n("a",{attrs:{href:t.viewLink(a),title:t.trans("buttons.view")}},[n("b-icon",{attrs:{icon:"eye"}})],1):t._e(),t._v(" "),n("a",{attrs:{href:t.editLink(a),title:t.trans("buttons.edit")}},[n("b-icon",{attrs:{icon:"edit"}})],1),t._v(" "),n("a",{attrs:{title:t.trans("buttons.delete")},on:{click:function(e){return t.confirmRemove(a)}}},[n("b-icon",{attrs:{icon:"trash"}})],1)])]}},{key:"detail",fn:function(e){var a=e.row;return[n("article",{staticClass:"media"},[n("figure",{staticClass:"media-left"},t._l(a.photos,function(e,i){return n("p",{key:e.id,staticClass:"image is-64x64"},[n("img",{staticClass:"is-clickable",attrs:{src:e.url},on:{click:function(e){return t.openImageModal(a.photos,i)}}})])}),0),t._v(" "),n("div",{staticClass:"media-content"},[n("div",{staticClass:"content"},[n("strong",[t._v(t._s(a.location))]),t._v(" "),n("small",[t._v(t._s(a.latitude)+", "+t._s(a.longitude))]),n("br"),t._v(" "),n("small",[t._v(t._s(t.trans("labels.field_observations.elevation"))+": "+t._s(a.elevation)+"m")]),n("br"),t._v(" "),a.accuracy?n("small",[t._v(t._s(t.trans("labels.field_observations.accuracy"))+": "+t._s(a.accuracy)+"m")]):t._e()])])])]}}])},[t._v(" "),n("template",{slot:"empty"},[n("section",{staticClass:"section"},[n("div",{staticClass:"content has-text-grey has-text-centered"},[n("p",[t._v(t._s(t.empty))])])])])],2),t._v(" "),t.modalImages.length?n("nz-image-modal",{attrs:{items:t.modalImages},on:{close:t.onCarouselClose},model:{value:t.modalImageIndex,callback:function(e){t.modalImageIndex=e},expression:"modalImageIndex"}}):t._e(),t._v(" "),n("b-modal",{attrs:{active:t.activityLog.length>0},on:{close:function(e){t.activityLog=[]}}},[n("div",{staticClass:"modal-card"},[n("div",{staticClass:"modal-card-head"},[n("b-icon",{attrs:{icon:"history"}}),t._v(" "),n("p",{staticClass:"modal-card-title"},[t._v(t._s(t.trans("Activity Log")))])],1),t._v(" "),n("div",{staticClass:"modal-card-body"},[n("nz-field-observation-activity-log",{attrs:{activities:t.activityLog}})],1)])]),t._v(" "),n("b-modal",{attrs:{active:t.showExportModal,"has-modal-card":"","can-cancel":[]},on:{close:function(e){t.showExportModal=!1}}},[n("nz-export-modal",{attrs:{checked:t.checkedIds,filter:t.filter,columns:t.exportColumns,url:t.exportUrl},on:{cancel:function(e){t.showExportModal=!1},done:t.onExportDone}})],1)],1)},[],!1,null,null,null).exports,ie={name:"nzLiteratureObservationsTable",mixins:[Nt],props:{perPageOptions:{type:Array,default:function(){return[15,30,50,100]},validator:function(t){return t.length}},listRoute:String,viewRoute:String,editRoute:String,deleteRoute:String,empty:{type:String,default:"Nothing here."},showActivityLog:Boolean,exportUrl:String,exportColumns:{type:Array,default:function(){return[]}}},data:function(){return{data:[],total:0,loading:!1,sortField:"id",sortOrder:"desc",defaultSortOrder:"desc",page:1,perPage:this.perPageOptions[0],checkedRows:[],activityLog:[],showExportModal:!1,exporting:!1}},computed:{hasActions:function(){return this.exportable},checkedIds:function(){return this.checkedRows.map(function(t){return t.id})},exportable:function(){return!(!this.exportUrl||!this.exportColumns.length)},actionRunning:function(){return this.exporting}},created:function(){this.restoreState(),this.loadAsyncData(),this.$on("filter",this.loadAsyncData)},methods:{loadAsyncData:function(){var t=this;return this.loading=!0,C.a.get(route(this.listRoute,{sort_by:"".concat(this.sortField,".").concat(this.sortOrder),page:this.page,per_page:this.perPage})).then(function(e){var n=e.data;t.data=[],t.total=n.meta.total,n.data.forEach(function(e){return t.data.push(e)}),t.loading=!1},function(e){t.data=[],t.total=0,t.loading=!1})},onPageChange:function(t){this.page=t,this.loadAsyncData()},onSort:function(t,e){this.sortField=t,this.sortOrder=e,this.saveState(),this.loadAsyncData()},onPerPageChange:function(t){t!==this.perPage&&(this.perPage=t,this.saveState(),this.loadAsyncData())},confirmRemove:function(t){var e=this;this.$dialog.confirm({message:this.trans("Are you sure you want to delete this record?"),confirmText:this.trans("buttons.delete"),cancelText:this.trans("buttons.cancel"),type:"is-danger",onConfirm:function(){e.remove(t)}})},remove:function(t){var e=this;return C.a.delete(route(this.deleteRoute,t.id)).then(function(t){e.$toast.open({message:e.trans("Record deleted"),type:"is-success"}),e.loadAsyncData()}).catch(function(t){console.error(t)})},editLink:function(t){return route(this.editRoute,t.id)},viewLink:function(t){return this.viewRoute?route(this.viewRoute,t.id):null},openActivityLogModal:function(t){this.activityLog=t.activity},openExportModal:function(){this.showExportModal=!0},onExportDone:function(t){this.showExportModal=!1,t.url?this.$modal.open({parent:this,component:Qt,canCancel:[],hasModalCard:!0,props:{url:t.url}}):this.$toast.open({duration:0,message:"Something's not good, also I'm on bottom",type:"is-danger"})}},filters:{truncate:function(t,e){return t.length>e?t.substr(0,e)+"...":t}}},se=Object(p.a)(ie,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"field-observations-table"},[n("div",{staticClass:"level"},[n("div",{staticClass:"level-left"}),t._v(" "),t.hasActions?n("div",{staticClass:"level-right"},[n("div",{staticClass:"level-item"},[n("b-dropdown",{attrs:{position:"is-bottom-left"}},[n("button",{staticClass:"button is-touch-full",class:{"is-loading":t.actionRunning},attrs:{slot:"trigger"},slot:"trigger"},[n("span",[t._v(t._s(t.trans("labels.actions")))]),t._v(" "),n("span",{staticClass:"icon has-text-grey"},[n("i",{staticClass:"fa fa-angle-down"})])]),t._v(" "),t.exportable?n("b-dropdown-item",{on:{click:t.openExportModal}},[n("b-icon",{staticClass:"has-text-grey",attrs:{icon:"download"}}),t._v(" "),n("span",[t._v(t._s(t.trans("buttons.export")))])],1):t._e()],1)],1)]):t._e()]),t._v(" "),n("hr"),t._v(" "),n("nz-table",{attrs:{data:t.data,loading:t.loading,paginated:"","backend-pagination":"",total:t.total,"per-page":t.perPage,"per-page-options":t.perPageOptions,"pagination-on-top":"","backend-sorting":"","default-sort-direction":t.defaultSortOrder,"default-sort":[t.sortField,t.sortOrder],detailed:"","mobile-cards":!0,checkable:t.hasActions,"checked-rows":t.checkedRows},on:{"page-change":t.onPageChange,"per-page-change":t.onPerPageChange,sort:t.onSort,"update:checkedRows":function(e){t.checkedRows=e},"update:checked-rows":function(e){t.checkedRows=e}},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("b-table-column",{attrs:{field:"id",label:t.trans("labels.id"),width:"40",numeric:"",sortable:""}},[t._v("\n        "+t._s(a.id)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"taxon_name",label:t.trans("labels.literature_observations.taxon"),sortable:""}},[t._v("\n        "+t._s(a.taxon?a.taxon.name:"")+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"year",label:t.trans("labels.literature_observations.year"),numeric:"",sortable:""}},[t._v("\n        "+t._s(a.year)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"month",label:t.trans("labels.literature_observations.month"),numeric:"",sortable:""}},[t._v("\n        "+t._s(a.month)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{field:"day",label:t.trans("labels.literature_observations.day"),numeric:"",sortable:""}},[t._v("\n        "+t._s(a.day)+"\n      ")]),t._v(" "),n("b-table-column",{attrs:{width:"150",numeric:""}},[t.showActivityLog&&a.activity?n("a",{attrs:{title:t.trans("Activity Log")},on:{click:function(e){return t.openActivityLogModal(a)}}},[n("b-icon",{attrs:{icon:"history"}})],1):t._e(),t._v(" "),t.viewRoute?n("a",{attrs:{href:t.viewLink(a),title:t.trans("buttons.view")}},[n("b-icon",{attrs:{icon:"eye"}})],1):t._e(),t._v(" "),n("a",{attrs:{href:t.editLink(a),title:t.trans("buttons.edit")}},[n("b-icon",{attrs:{icon:"edit"}})],1),t._v(" "),n("a",{attrs:{title:t.trans("buttons.delete")},on:{click:function(e){return t.confirmRemove(a)}}},[n("b-icon",{attrs:{icon:"trash"}})],1)])]}},{key:"detail",fn:function(e){var a=e.row;return[n("article",{staticClass:"media"},[n("div",{staticClass:"media-content"},[n("div",{staticClass:"content"},[n("strong",[t._v(t._s(a.location))]),t._v(" "),n("small",[t._v(t._s(a.latitude)+", "+t._s(a.longitude))]),n("br"),t._v(" "),n("small",[t._v(t._s(t.trans("labels.literature_observations.elevation"))+": "+t._s(a.elevation)+"m")]),n("br"),t._v(" "),a.accuracy?n("small",[t._v(t._s(t.trans("labels.literature_observations.accuracy"))+": "+t._s(a.accuracy)+"m")]):t._e()])])])]}}])},[t._v(" "),n("template",{slot:"empty"},[n("section",{staticClass:"section"},[n("div",{staticClass:"content has-text-grey has-text-centered"},[n("p",[t._v(t._s(t.empty))])])])])],2),t._v(" "),n("b-modal",{attrs:{active:t.activityLog.length>0},on:{close:function(e){t.activityLog=[]}}},[n("div",{staticClass:"modal-card"},[n("div",{staticClass:"modal-card-head"},[n("b-icon",{attrs:{icon:"history"}}),t._v(" "),n("p",{staticClass:"modal-card-title"},[t._v(t._s(t.trans("Activity Log")))])],1),t._v(" "),n("div",{staticClass:"modal-card-body"},[n("nz-literature-observation-activity-log",{attrs:{activities:t.activityLog}})],1)])]),t._v(" "),n("b-modal",{attrs:{active:t.showExportModal,"has-modal-card":"","can-cancel":[]},on:{close:function(e){t.showExportModal=!1}}},[n("nz-export-modal",{attrs:{checked:t.checkedIds,columns:t.exportColumns,url:t.exportUrl,types:["custom"]},on:{cancel:function(e){t.showExportModal=!1},done:t.onExportDone}})],1)],1)},[],!1,null,null,null).exports,oe={name:"nzRegistrationForm",props:{initPasswordError:String},data:function(){return{password:"",passwordWasOnceInvalid:!!this.initPasswordError,passwordIsInvalid:!!this.initPasswordError,passwordError:this.initPasswordError}},computed:{shouldBeDisabled:function(){return this.passwordIsInvalid}},methods:{validatePassword:function(){return this.password.length<8},checkPassword:function(){this.passwordIsInvalid=this.validatePassword(),this.passwordIsInvalid&&(this.passwordWasOnceInvalid=!0),this.passwordError=this.passwordIsInvalid?this.trans("validation.min.string",{attribute:this.trans("labels.register.password"),min:8}):""},checkIfFixedPassword:function(){this.passwordWasOnceInvalid&&this.checkPassword()}}},re=n("5YJQ"),le=n.n(re),ce={name:"nzUserForm",props:{action:String,method:{type:String,default:"post"},roles:Array,user:{type:Object,default:function(){return{first_name:"",last_name:"",institution:"",roles:[],curated_taxa:[]}}},redirect:String},data:function(){return{filteredTaxa:[],curatedTaxa:this.user.curated_taxa,form:new le.a({first_name:this.user.first_name,last_name:this.user.last_name,institution:this.user.institution,roles_ids:this.user.roles.map(function(t){return t.id}),curated_taxa_ids:this.user.curated_taxa.map(function(t){return t.id})},{resetOnSuccess:!1})}},computed:{isCurator:function(){return _.includes(this.form.roles_ids,_.find(this.roles,{name:"curator"}).id)}},watch:{curatedTaxa:function(t){this.form.curated_taxa_ids=t.map(function(t){return t.id})}},methods:{onTaxonNameInput:_.debounce(function(t){return this.fetchTaxa(t)},500),fetchTaxa:function(t){var e=this;axios.get(route("api.taxa.index"),{params:{name:t,page:1,per_page:10,except:this.curatedTaxa.map(function(t){return t.id})}}).then(function(t){var n=t.data;e.filteredTaxa=n.data})},submit:function(){this.form.processing||this.form[this.method.toLowerCase()](this.action).then(this.onSuccessfulSubmit).catch(this.onFailedSubmit)},onSuccessfulSubmit:function(){var t=this;this.form.processing=!0,this.$toast.open({message:this.trans("Saved successfully"),type:"is-success"}),setTimeout(function(){t.form.processing=!1,window.location.href=t.redirect},500)},onFailedSubmit:function(t){this.$toast.open({duration:2500,message:_.get(t,"response.data.message",t.message),type:"is-danger"})}}},ue=Object(p.a)(ce,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-form"},[n("form",{on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.users.first_name")}},[n("b-input",{model:{value:t.form.first_name,callback:function(e){t.$set(t.form,"first_name",e)},expression:"form.first_name"}})],1)],1),t._v(" "),n("div",{staticClass:"column"},[n("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.users.last_name")}},[n("b-input",{model:{value:t.form.last_name,callback:function(e){t.$set(t.form,"last_name",e)},expression:"form.last_name"}})],1)],1)]),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.users.institution")}},[n("b-input",{model:{value:t.form.institution,callback:function(e){t.$set(t.form,"institution",e)},expression:"form.institution"}})],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.users.roles")}},[n("div",{staticClass:"block"},t._l(t.roles,function(e){return n("b-checkbox",{key:e.id,attrs:{"native-value":e.id},model:{value:t.form.roles_ids,callback:function(e){t.$set(t.form,"roles_ids",e)},expression:"form.roles_ids"}},[t._v("\n          "+t._s(t.trans("roles."+e.name))+"\n        ")])}),1)]),t._v(" "),t.isCurator?n("b-field",{attrs:{label:t.trans("labels.users.curated_taxa")}},[n("b-taginput",{attrs:{data:t.filteredTaxa,autocomplete:"",field:"name",placeholder:"Type taxon name"},on:{typing:t.onTaxonNameInput},model:{value:t.curatedTaxa,callback:function(e){t.curatedTaxa=e},expression:"curatedTaxa"}})],1):t._e(),t._v(" "),n("hr"),t._v(" "),n("button",{staticClass:"button is-primary",attrs:{type:"submit"}},[t._v(t._s(t.trans("buttons.save")))])],1)])},[],!1,null,null,null).exports,de=n("j5l6"),fe=n.n(de);function me(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var he={name:"nzFieldObservationForm",props:{action:{type:String,required:!0},method:{type:String,default:"POST"},redirectUrl:String,cancelUrl:String,submitMore:Boolean,shouldConfirmSubmit:Boolean,confirmSubmitMessage:{type:String,default:function(){return this.trans("You are about to submit")}},shouldAskReason:Boolean,shouldConfirmCancel:Boolean,submitOnlyDirty:Boolean,submitOnlyDirtyMessage:{type:String,default:function(){return this.trans("There are no changes, the data will not be saved.")}}},data:function(){return{form:this.newForm(),keepAfterSubmit:[],submittingWithRedirect:!1,submittingWithoutRedirect:!1,confirmingSubmit:!1,confirmingCancel:!1,locale:window.App.locale}},created:function(){document.addEventListener("keyup",this.registerKeyListener)},beforeDestroy:function(){document.removeEventListener("keyup",this.registerKeyListener)},methods:{newForm:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new le.a(t,{resetOnSuccess:!1})},registerKeyListener:function(t){var e=13===(t.which||t.keyCode);t.ctrlKey&&t.shiftKey&&e?this.submitMore&&this.submitWithoutRedirect():t.ctrlKey&&e&&this.submitWithRedirect()},confirmSubmit:function(t){var e=this;if(!this.confirmingSubmit){this.confirmingSubmit=!0;var n={message:this.confirmSubmitMessage,confirmText:this.trans("buttons.save"),cancelText:this.trans("buttons.cancel"),onConfirm:t,onCancel:function(){e.confirmingSubmit=!1}};return this.shouldAskReason?this.promptForReason(n):this.$dialog.confirm(n)}},promptForReason:function(t){var e=this,n=this.$dialog.prompt(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){me(t,e,n[e])})}return t}({},t,{inputAttrs:{placeholder:this.trans("Reason"),required:!0,maxlength:255}}));return n.$nextTick(function(){n.$refs.input.addEventListener("invalid",function(t){t.target.setCustomValidity(""),t.target.validity.valid||t.target.setCustomValidity(e.trans("This field is required and can contain max 255 chars."))}),n.$refs.input.addEventListener("input",function(t){n.validationMessage=null})}),n},notifyNoChanges:function(){this.$toast.open({message:this.submitOnlyDirtyMessage,type:"is-info"})},notifyNoChangesAndRedirect:function(){var t=this;this.notifyNoChanges(),setTimeout(function(){t.redirectUrl&&(window.location.href=t.redirectUrl)},500)},submitWithRedirect:function(){if(!this.form.processing)return this.submitOnlyDirty&&!this.isDirty()?this.notifyNoChangesAndRedirect():this.shouldConfirmSubmit?this.confirmSubmit(this.performSubmitWithRedirect):void this.performSubmitWithRedirect()},performSubmitWithRedirect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.submittingWithRedirect=!0,this.confirmingSubmit=!1,this.shouldAskReason&&(this.form.reason=t),this.form[this.method.toLowerCase()](this.action).then(this.onSuccessfulSubmitWithRedirect).catch(this.onFailedSubmit)},onSuccessfulSubmitWithRedirect:function(){var t=this;this.form.processing=!0,this.$toast.open({message:this.trans("Saved successfully"),type:"is-success"}),setTimeout(function(){t.form.processing=!1,t.submittingWithRedirect=!1,t.hookAfterSubmitWithRedirect(),t.redirectUrl&&(window.location.href=t.redirectUrl)},500)},hookAfterSubmitWithRedirect:function(){},submitWithoutRedirect:function(){if(!this.form.processing)return this.submitOnlyDirty&&!this.isDirty()?this.notifyNoChanges():this.shouldConfirmSubmit?this.confirmSubmit(this.performSubmitWithoutRedirect):void this.performSubmitWithoutRedirect()},performSubmitWithoutRedirect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.submittingWithoutRedirect=!0,this.confirmingSubmit=!1,this.shouldAskReason&&(this.form.reason=t),this.form[this.method.toLowerCase()](this.action).then(this.onSuccessfulSubmitWithoutRedirect).catch(this.onFailedSubmit)},onSuccessfulSubmitWithoutRedirect:function(){this.submittingWithoutRedirect=!1,this.$toast.open({message:this.trans("Saved successfully"),type:"is-success"});var t=_.pick(this.form.data(),this.keepAfterSubmit);this.form.reset(),this.form.populate(t),this.hookAfterSubmitWithoutRedirect()},hookAfterSubmitWithoutRedirect:function(){},onFailedSubmit:function(t){this.submittingWithRedirect=!1,this.submittingWithoutRedirect=!1,this.$toast.open({duration:2500,message:_.get(t,"response.data.message",t.message),type:"is-danger"})},isDirty:function(){return!_.isEqual(this.form.data(),this.form.initial)},confirmCancel:function(){var t=this;this.confirmingCancel||(this.confirmingCancel=!0,this.$dialog.confirm({message:this.trans("If you leave this page changes will not be saved."),onConfirm:function(){t.confirmingCancel=!1,window.location.href=t.cancelUrl},onCancel:function(){t.confirmingCancel=!1},cancelText:this.trans("buttons.stay_on_page"),confirmText:this.trans("buttons.leave_page")}))},onCancel:function(t){this.shouldConfirmCancel&&this.isDirty()&&(t.preventDefault(),this.confirmCancel())}}};function pe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function be(){var t={};return _.keys(window.App.supportedLocales).forEach(function(e){t[e]=null}),t}var ve={name:"nzTaxonForm",mixins:[he],props:{taxon:{type:Object,default:function(){return pe({name:null,parent_id:null,rank:"species",rank_level:10,author:null,fe_id:null,fe_old_id:null,conservation_legislations:[],conservation_documents:[],red_lists:[],stages:[],restricted:!1,allochthonous:!1,invasive:!1},"restricted",!1)}},ranks:Array,conservationLegislations:Array,conservationDocuments:Array,redListCategories:Array,redLists:{type:Array,default:function(){return[]}},stages:Array,nativeNames:{type:Object,default:function(){return be()}},descriptions:{type:Object,default:function(){return be()}}},data:function(){return{form:this.newForm(),parentName:_.get(this.taxon,"parent.name"),selectedParent:null,chosenRedList:null}},computed:{rankOptions:function(){var t=this;return this.selectedParent?this.ranks.filter(function(e){return e.level<t.selectedParent.rank_level}):this.ranks},availableRedLists:function(){var t=fe()(this.form.red_lists_data);return this.redLists.filter(function(e){return!t.contains(function(t){return e.id==t.red_list_id})})},supportedLocales:function(){return window.App.supportedLocales}},watch:{selectedParent:function(t){this.shouldResetRank(t)&&(this.form.rank=null)}},methods:{newForm:function(){return new le.a(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){pe(t,e,n[e])})}return t}({},this.taxon,{stages_ids:this.taxon.stages.map(function(t){return t.id}),conservation_legislations_ids:this.taxon.conservation_legislations.map(function(t){return t.id}),conservation_documents_ids:this.taxon.conservation_documents.map(function(t){return t.id}),red_lists_data:this.taxon.red_lists.map(function(t){return{red_list_id:t.id,category:t.pivot.category}}),native_name:this.nativeNames,description:this.descriptions,reason:null}),{resetOnSuccess:!1})},addRedList:function(){this.chosenRedList&&(this.form.red_lists_data.push({red_list_id:this.chosenRedList.id,category:_.first(this.redListCategories)}),this.chosenRedList=null)},removeRedList:function(t){this.form.red_lists_data.splice(t,1)},getRedListName:function(t){return _.find(this.redLists,{id:t}).name},onTaxonSelect:function(t){this.selectedParent=t,this.form.parent_id=t?t.id:null,t.stages.length&&(this.form.stages_ids=t.stages.map(function(t){return t.id}))},shouldResetRank:function(t){return t&&this.getRankLevel(this.form.rank)>=t.rank_level},getRankLevel:function(t){return _.get(_.find(this.ranks,{value:t}),"level")},focusOnTranslation:function(t,e){var n=this,a=_.keys(this.supportedLocales),i="".concat(e,"-").concat(a[t]);setTimeout(function(){_.first(n.$refs[i]).focus()},500)}}},ge=Object(p.a)(ve,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{attrs:{action:t.action,method:"POST"},on:{submit:function(e){return e.preventDefault(),t.submitWithRedirect(e)}}},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-4"},[n("nz-taxon-autocomplete",{attrs:{label:t.trans("labels.taxa.parent"),error:t.form.errors.has("parent_id"),message:t.form.errors.first("parent_id"),taxon:t.taxon.parent||null,except:t.taxon.id,placeholder:t.trans("labels.taxa.search_for_taxon"),autofocus:""},on:{select:t.onTaxonSelect},model:{value:t.parentName,callback:function(e){t.parentName=e},expression:"parentName"}})],1),t._v(" "),n("div",{staticClass:"column is-5"},[n("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.taxa.name"),type:t.form.errors.has("name")?"is-danger":"",message:t.form.errors.has("name")?t.form.errors.first("name"):""}},[n("b-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),t._v(" "),n("div",{staticClass:"column is-3"},[n("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.taxa.rank"),type:t.form.errors.has("rank")?"is-danger":"",message:t.form.errors.has("rank")?t.form.errors.first("rank"):""}},[n("b-select",{attrs:{expanded:""},model:{value:t.form.rank,callback:function(e){t.$set(t.form,"rank",e)},expression:"form.rank"}},t._l(t.rankOptions,function(e,a){return n("option",{key:a,domProps:{value:e.value,textContent:t._s(e.label)}})}),0)],1)],1)]),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.taxa.author"),type:t.form.errors.has("author")?"is-danger":"",message:t.form.errors.has("author")?t.form.errors.first("author"):""}},[n("b-input",{model:{value:t.form.author,callback:function(e){t.$set(t.form,"author",e)},expression:"form.author"}})],1),t._v(" "),n("hr"),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.taxa.native_name")}},[n("b-tabs",{staticClass:"block",attrs:{size:"is-small"},on:{change:function(e){return t.focusOnTranslation(e,"native_name")}}},t._l(t.supportedLocales,function(e,a){return n("b-tab-item",{key:a,attrs:{label:t.trans("languages."+e.name)}},[n("b-input",{ref:"native_name-"+a,refInFor:!0,model:{value:t.form.native_name[a],callback:function(e){t.$set(t.form.native_name,a,e)},expression:"form.native_name[locale]"}})],1)}),1)],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.taxa.description")}},[n("b-tabs",{staticClass:"block",attrs:{size:"is-small"},on:{change:function(e){return t.focusOnTranslation(e,"description")}}},t._l(t.supportedLocales,function(e,a){return n("b-tab-item",{key:a,attrs:{label:t.trans("languages."+e.name)}},[n("nz-wysiwyg",{ref:"description-"+a,refInFor:!0,model:{value:t.form.description[a],callback:function(e){t.$set(t.form.description,a,e)},expression:"form.description[locale]"}})],1)}),1)],1),t._v(" "),n("hr"),t._v(" "),n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-half"},[n("b-field",{attrs:{label:t.trans("labels.taxa.fe_old_id"),type:t.form.errors.has("fe_old_id")?"is-danger":"",message:t.form.errors.has("fe_old_id")?t.form.errors.first("fe_old_id"):""}},[n("b-input",{model:{value:t.form.fe_old_id,callback:function(e){t.$set(t.form,"fe_old_id",e)},expression:"form.fe_old_id"}})],1)],1),t._v(" "),n("div",{staticClass:"column is-half"},[n("b-field",{attrs:{label:t.trans("labels.taxa.fe_id"),type:t.form.errors.has("fe_id")?"is-danger":"",message:t.form.errors.has("fe_id")?t.form.errors.first("fe_id"):""}},[n("b-input",{model:{value:t.form.fe_id,callback:function(e){t.$set(t.form,"fe_id",e)},expression:"form.fe_id"}})],1)],1)]),t._v(" "),n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("b-field",{attrs:{label:t.trans("labels.taxa.restricted")}},[n("div",{staticClass:"field"},[n("b-switch",{model:{value:t.form.restricted,callback:function(e){t.$set(t.form,"restricted",e)},expression:"form.restricted"}},[t._v("\n            "+t._s(t.form.restricted?t.trans("Yes"):t.trans("No"))+"\n          ")])],1)])],1),t._v(" "),n("div",{staticClass:"column"},[n("b-field",{attrs:{label:t.trans("labels.taxa.allochthonous")}},[n("b-switch",{model:{value:t.form.allochthonous,callback:function(e){t.$set(t.form,"allochthonous",e)},expression:"form.allochthonous"}},[t._v("\n          "+t._s(t.form.allochthonous?t.trans("Yes"):t.trans("No"))+"\n        ")])],1)],1),t._v(" "),n("div",{staticClass:"column"},[n("b-field",{attrs:{label:t.trans("labels.taxa.invasive")}},[n("b-switch",{model:{value:t.form.invasive,callback:function(e){t.$set(t.form,"invasive",e)},expression:"form.invasive"}},[t._v("\n          "+t._s(t.form.invasive?t.trans("Yes"):t.trans("No"))+"\n        ")])],1)],1)]),t._v(" "),t.stages.length?n("b-field",{attrs:{label:t.trans("labels.taxa.stages")}},[n("div",{staticClass:"block"},t._l(t.stages,function(e){return n("b-checkbox",{key:e.id,attrs:{"native-value":e.id},model:{value:t.form.stages_ids,callback:function(e){t.$set(t.form,"stages_ids",e)},expression:"form.stages_ids"}},[t._v("\n        "+t._s(t.trans("stages."+e.name))+"\n      ")])}),1)]):t._e(),t._v(" "),t.conservationLegislations.length?n("b-field",{attrs:{label:t.trans("labels.taxa.conservation_legislations")}},[n("div",{staticClass:"block"},[n("div",{staticClass:"columns is-multiline is-gapless"},t._l(t.conservationLegislations,function(e){return n("div",{key:e.id,staticClass:"column is-half"},[n("b-tooltip",{attrs:{label:e.description,multilined:""}},[n("b-checkbox",{attrs:{"native-value":e.id},model:{value:t.form.conservation_legislations_ids,callback:function(e){t.$set(t.form,"conservation_legislations_ids",e)},expression:"form.conservation_legislations_ids"}},[t._v("\n              "+t._s(e.name)+"\n            ")])],1)],1)}),0)])]):t._e(),t._v(" "),t.conservationDocuments.length?n("b-field",{attrs:{label:t.trans("labels.taxa.conservation_documents")}},[n("div",{staticClass:"block"},[n("div",{staticClass:"columns is-multiline is-gapless"},t._l(t.conservationDocuments,function(e){return n("div",{key:e.id,staticClass:"column is-half"},[n("b-tooltip",{attrs:{label:e.description,multilined:""}},[n("b-checkbox",{attrs:{"native-value":e.id},model:{value:t.form.conservation_documents_ids,callback:function(e){t.$set(t.form,"conservation_documents_ids",e)},expression:"form.conservation_documents_ids"}},[t._v("\n              "+t._s(e.name)+"\n            ")])],1)],1)}),0)])]):t._e(),t._v(" "),t.redLists.length?n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[t._v(t._s(t.trans("labels.taxa.red_lists")))]),t._v(" "),t._l(t.form.red_lists_data,function(e,a){return n("b-field",{key:a,attrs:{grouped:""}},[n("div",{staticClass:"control is-expanded"},[n("span",{domProps:{textContent:t._s(t.getRedListName(e.red_list_id))}})]),t._v(" "),n("b-select",{model:{value:e.category,callback:function(n){t.$set(e,"category",n)},expression:"addedRedList.category"}},t._l(t.redListCategories,function(e){return n("option",{key:e,domProps:{value:e,textContent:t._s(e)}})}),0),t._v(" "),n("div",{staticClass:"control"},[n("button",{staticClass:"button has-text-danger",attrs:{type:"button"},on:{click:function(e){return t.removeRedList(a)}}},[t._v("×")])])],1)}),t._v(" "),t.availableRedLists.length?n("b-field",{attrs:{grouped:""}},[n("b-select",{attrs:{expanded:""},model:{value:t.chosenRedList,callback:function(e){t.chosenRedList=e},expression:"chosenRedList"}},t._l(t.availableRedLists,function(e){return n("option",{key:e.id,domProps:{value:e,textContent:t._s(e.name)}})}),0),t._v(" "),n("div",{staticClass:"control"},[n("button",{staticClass:"button",attrs:{type:"button"},on:{click:t.addRedList}},[t._v(t._s(t.trans("labels.taxa.add_red_list")))])])],1):t._e()],2):t._e(),t._v(" "),n("hr"),t._v(" "),n("button",{staticClass:"button is-primary",class:{"is-loading":t.form.processing},attrs:{type:"submit"},on:{click:t.submitWithRedirect}},[t._v("\n    "+t._s(t.trans("buttons.save"))+"\n  ")]),t._v(" "),n("a",{staticClass:"button is-text",attrs:{href:t.cancelUrl},on:{click:t.onCancel}},[t._v(t._s(t.trans("buttons.cancel")))])],1)},[],!1,null,null,null).exports;function _e(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var ye=function(){function t(e){for(var n in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e)this[n]=e[n]}var e,n,a;return e=t,(n=[{key:"hasRole",value:function(t){return Array.isArray(t)||(t=[t]),!!_.intersection(this.roles.map(function(t){return t.name}),t).length}}])&&_e(e.prototype,n),a&&_e(e,a),t}();function xe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ce={name:"nzFieldObservationForm",mixins:[he,{data:function(){return{currentUser:new ye(window.App.User)}},computed:{isCuratorOrAdmin:function(){return this.currentUser.hasRole(["admin","curator"])}}}],props:{observation:{type:Object,default:function(){return{taxon:null,taxon_id:null,taxon_suggestion:"",year:moment().year(),month:moment().month()+1,day:moment().date(),latitude:null,longitude:null,accuracy:null,elevation:null,location:"",photos:[],observer:"",identifier:"",note:"",sex:null,number:null,project:null,habitat:null,found_on:null,stage_id:null,found_dead:!1,found_dead_note:"",data_license:null,image_license:null,time:null,types:[],observed_by_id:null,observed_by:null,identified_by_id:null,identified_by:null,dataset:null}}},licenses:{type:Object,default:function(){return{}}},sexes:{type:Array,default:function(){return[]}},observationTypes:{type:Array,default:function(){return[]}},showObserverIdentifier:Boolean},data:function(){return{keepAfterSubmit:this.getAttributesToKeep(),showMoreDetails:!1,locale:window.App.locale,observationTypeSearch:"",shouldClearType:!1,exifExtracted:!1}},computed:{stages:function(){return this.form.taxon?this.form.taxon.stages:[]},time:function(){return this.form.time?moment(this.form.time,"HH:mm").toDate():null},selectedObservationTypes:{get:function(){var t=this;return this.observationTypes.filter(function(e){return _.includes(t.form.observation_types_ids,e.id)})},set:function(t){this.form.observation_types_ids=t.map(function(t){return t.id})}},availableObservationTypes:function(){var t=this;return this.observationTypes.filter(function(e){return!_.includes(t.form.observation_types_ids,e.id)&&e.name.toLowerCase().includes(t.observationTypeSearch.toLowerCase())})},isIdentified:function(){return!(!this.form.taxon_id&&!this.form.taxon_suggestion)},identificationChanged:function(){return this.form.taxon_id!=this.observation.taxon_id||this.form.taxon_suggestion!=this.observation.taxon_suggestion}},created:function(){this.setDefaultObservationType()},methods:{newForm:function(){var t=this.observation;return t.photos.forEach(function(t){t.crop=null}),new le.a(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){xe(t,e,n[e])})}return t}({},t,{observation_types_ids:t.types.map(function(t){return t.id}),reason:null}),{resetOnSuccess:!1})},hookAfterSubmitWithoutRedirect:function(){this.setDefaultObservationType(),this.clearPhotos(),this.$refs.taxonAutocomplete.focusOnInput()},clearPhotos:function(){var t=this;_.range(1,3).forEach(function(e){t.$refs["photoUpload-".concat(e)].clearPhoto()})},onTaxonSelect:function(t){var e=this;this.form.taxon=t||null,this.form.taxon_id=t?t.id:null,this.form.taxon_suggestion=t?t.name:null,!fe()(this.stages).contains(function(t){return t.id===e.form.stage_id})&&(this.form.stage_id=null),this.updateIdentifier()},onTimeInput:function(t){this.form.time=t?moment(t).format("HH:mm"):null},onPhotoUploaded:function(t){this.form.photos.push(t);var e=_.find(this.availableObservationTypes,{slug:"photographed"});e&&this.pushSelectedObservationType(e),this.promptToExtractExifData(t)},onPhotoRemoved:function(t){_.remove(this.form.photos,{path:t.path});var e=_.findIndex(this.selectedObservationTypes,{slug:"photographed"});if(!this.form.photos.length&&e>=0){var n=this.selectedObservationTypes;n.splice(e,1),this.selectedObservationTypes=n}},onPhotoCropped:function(t){var e=_.findIndex(this.form.photos,{path:t.path});if(e>=0){var n=_.cloneDeep(this.form.photos[e]);n.crop=t.crop,this.form.photos.splice(e,1,n)}},getObservationPhotoAttribute:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"url";return _.get(this.observation,"photos.".concat(t,".").concat(e),"")},getAttributesToKeep:function(){return["location","accuracy","elevation","latitude","longitude","year","month","day","project","observer","observed_by","observed_by_id","data_license","image_license"]},onTypeTyping:function(t){this.observationTypeSearch=t},onTypeBackspace:function(){this.shouldClearType?(this.form.observation_types_ids.splice(-1,1),this.shouldClearType=!1):this.observationTypeSearch||(this.shouldClearType=!0)},pushSelectedObservationType:function(t){var e=this.selectedObservationTypes;e.push(t),this.selectedObservationTypes=e},promptToExtractExifData:function(t){var e=this;!this.exifExtracted&&t.exif&&this.$dialog.confirm({message:this.trans("Use data from photo to fill the form?"),cancelText:this.trans("No"),confirmText:this.trans("Yes"),onConfirm:function(){e.extractExifData(t)},onCancel:function(){e.exifExtracted=!0}})},extractExifData:function(t){for(var e in t.exif){var n=t.exif[e];n&&(this.form[e]=n)}this.exifExtracted=!0},onObserverSelect:function(t){this.form.observed_by=t||null,this.form.observed_by_id=t?t.id:null,this.form.observer=t?t.full_name:null},onIdentifierSelect:function(t){this.form.identified_by=t||null,this.form.identified_by_id=t?t.id:null,this.form.identifier=t?t.full_name:null},setDefaultObservationType:function(){this.selectedObservationTypes.length||this.pushSelectedObservationType(_.find(this.availableObservationTypes,{slug:"observed"}))},updateIdentifier:function(){var t=this.observation.identified_by;this.identificationChanged&&(t=this.isIdentified?window.App.User:null),this.onIdentifierSelect(t)},onLicenseChanged:function(t,e){var n=_.cloneDeep(this.form.photos[t]);n.license=e,this.form.photos[t]=n}}},ke=Object(p.a)(Ce,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{staticClass:"field-observation-form",attrs:{action:t.action,method:"POST",lang:t.locale}},[n("div",{staticClass:"columns is-desktop"},[n("div",{staticClass:"column is-half-desktop"},[n("nz-taxon-autocomplete",{ref:"taxonAutocomplete",attrs:{taxon:t.observation.taxon,error:t.form.errors.has("taxon_id"),message:t.form.errors.has("taxon_id")?t.form.errors.first("taxon_id"):null,autofocus:"",label:t.trans("labels.field_observations.taxon"),placeholder:t.trans("labels.field_observations.search_for_taxon")},on:{select:t.onTaxonSelect},model:{value:t.form.taxon_suggestion,callback:function(e){t.$set(t.form,"taxon_suggestion",e)},expression:"form.taxon_suggestion"}}),t._v(" "),n("nz-date-input",{attrs:{year:t.form.year,month:t.form.month,day:t.form.day,errors:t.form.errors,label:t.trans("labels.field_observations.date"),placeholders:{year:t.trans("labels.field_observations.year"),month:t.trans("labels.field_observations.month"),day:t.trans("labels.field_observations.day")}},on:{"update:year":function(e){return t.$set(t.form,"year",e)},"update:month":function(e){return t.$set(t.form,"month",e)},"update:day":function(e){return t.$set(t.form,"day",e)}}}),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.field_observations.photos")}},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-one-third"},[n("nz-photo-upload",{ref:"photoUpload-1",attrs:{"image-url":t.getObservationPhotoAttribute(0,"url"),"image-path":t.getObservationPhotoAttribute(0,"path"),"image-license":t.getObservationPhotoAttribute(0,"license"),licenses:t.licenses,text:t.trans("labels.field_observations.upload"),errors:t.form.errors},on:{uploaded:t.onPhotoUploaded,removed:t.onPhotoRemoved,cropped:t.onPhotoCropped,"license-changed":function(e){return t.onLicenseChanged(0,e)}}})],1),t._v(" "),n("div",{staticClass:"column is-one-third"},[n("nz-photo-upload",{ref:"photoUpload-2",attrs:{"image-url":t.getObservationPhotoAttribute(1,"url"),"image-path":t.getObservationPhotoAttribute(1,"path"),"image-license":t.getObservationPhotoAttribute(1,"license"),licenses:t.licenses,text:t.trans("labels.field_observations.upload"),errors:t.form.errors},on:{uploaded:t.onPhotoUploaded,removed:t.onPhotoRemoved,cropped:t.onPhotoCropped,"license-changed":function(e){return t.onLicenseChanged(1,e)}}})],1),t._v(" "),n("div",{staticClass:"column is-one-third"},[n("nz-photo-upload",{ref:"photoUpload-3",attrs:{"image-url":t.getObservationPhotoAttribute(2,"url"),"image-path":t.getObservationPhotoAttribute(2,"path"),"image-license":t.getObservationPhotoAttribute(2,"license"),licenses:t.licenses,text:t.trans("labels.field_observations.upload"),errors:t.form.errors},on:{uploaded:t.onPhotoUploaded,removed:t.onPhotoRemoved,cropped:t.onPhotoCropped,"license-changed":function(e){return t.onLicenseChanged(2,e)}}})],1)])])],1),t._v(" "),n("div",{staticClass:"column is-half-desktop"},[n("nz-spatial-input",{attrs:{latitude:t.form.latitude,longitude:t.form.longitude,location:t.form.location,accuracy:t.form.accuracy,elevation:t.form.elevation,errors:t.form.errors},on:{"update:latitude":function(e){return t.$set(t.form,"latitude",e)},"update:longitude":function(e){return t.$set(t.form,"longitude",e)},"update:location":function(e){return t.$set(t.form,"location",e)},"update:accuracy":function(e){return t.$set(t.form,"accuracy",e)},"update:elevation":function(e){return t.$set(t.form,"elevation",e)}}})],1)]),t._v(" "),n("button",{staticClass:"button is-text",attrs:{type:"button"},on:{click:function(e){t.showMoreDetails=!t.showMoreDetails}}},[t._v("\n    "+t._s(t.showMoreDetails?t.trans("labels.field_observations.less_details"):t.trans("labels.field_observations.more_details"))+"\n  ")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showMoreDetails,expression:"showMoreDetails"}],staticClass:"mt-4"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("b-field",{attrs:{label:t.trans("labels.field_observations.stage"),"label-for":"stage",type:t.form.errors.has("stage_id")?"is-danger":null,message:t.form.errors.has("stage_id")?t.form.errors.first("stage_id"):null}},[n("b-select",{attrs:{id:"stage",disabled:!t.stages.length,expanded:""},model:{value:t.form.stage_id,callback:function(e){t.$set(t.form,"stage_id",e)},expression:"form.stage_id"}},[n("option",{domProps:{value:null}},[t._v(t._s(t.trans("labels.field_observations.choose_a_stage")))]),t._v(" "),t._l(t.stages,function(e){return n("option",{key:e.id,domProps:{value:e.id,textContent:t._s(t.trans("stages."+e.name))}})})],2)],1)],1),t._v(" "),n("div",{staticClass:"column"},[n("b-field",{attrs:{label:t.trans("labels.field_observations.sex"),type:t.form.errors.has("sex")?"is-danger":null,message:t.form.errors.has("sex")?t.form.errors.first("sex"):null}},[n("b-select",{attrs:{expanded:""},model:{value:t.form.sex,callback:function(e){t.$set(t.form,"sex",e)},expression:"form.sex"}},[n("option",{domProps:{value:null}},[t._v(t._s(t.trans("labels.field_observations.choose_a_value")))]),t._v(" "),t._l(t.sexes,function(e){return n("option",{domProps:{value:e,textContent:t._s(t.trans("labels.sexes."+e))}})})],2)],1)],1)]),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.field_observations.types"),error:t.form.errors.has("observation_types_ids"),message:t.form.errors.has("observation_types_ids")?t.form.errors.first("observation_types_ids"):null}},[n("b-taginput",{attrs:{data:t.availableObservationTypes,autocomplete:"",allowNew:!1,field:"name",icon:"tag",placeholder:t.trans("labels.field_observations.types_placeholder"),"open-on-focus":""},on:{typing:t.onTypeTyping},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.onTypeBackspace(e)}},model:{value:t.selectedObservationTypes,callback:function(e){t.selectedObservationTypes=e},expression:"selectedObservationTypes"}})],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.field_observations.number"),"label-for":"number",type:t.form.errors.has("number")?"is-danger":null,message:t.form.errors.has("number")?t.form.errors.first("number"):null}},[n("b-input",{attrs:{id:"number",type:"number"},model:{value:t.form.number,callback:function(e){t.$set(t.form,"number",e)},expression:"form.number"}})],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.field_observations.note"),"label-for":"note",error:t.form.errors.has("note"),message:t.form.errors.has("note")?t.form.errors.first("note"):null}},[n("b-input",{attrs:{id:"note",type:"textarea"},model:{value:t.form.note,callback:function(e){t.$set(t.form,"note",e)},expression:"form.note"}})],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.field_observations.habitat"),"label-for":"habitat",error:t.form.errors.has("habitat"),message:t.form.errors.has("habitat")?t.form.errors.first("habitat"):null}},[n("b-input",{attrs:{id:"habitat",name:"habitat"},model:{value:t.form.habitat,callback:function(e){t.$set(t.form,"habitat",e)},expression:"form.habitat"}})],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.literature_observations.found_on"),type:t.form.errors.has("found_on")?"is-danger":null,message:t.form.errors.has("found_on")?t.form.errors.first("found_on"):null}},[n("label",{staticClass:"label",attrs:{slot:"label",for:"found_on"},slot:"label"},[n("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.trans("labels.literature_observations.found_on_tooltip")},expression:"{content: trans('labels.literature_observations.found_on_tooltip')}"}],staticClass:"is-dashed"},[t._v("\n          "+t._s(t.trans("labels.literature_observations.found_on"))+"\n        ")])]),t._v(" "),n("b-input",{attrs:{id:"found_on",name:"found_on"},model:{value:t.form.found_on,callback:function(e){t.$set(t.form,"found_on",e)},expression:"form.found_on"}})],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.field_observations.time"),"label-for":"time",type:t.form.errors.has("time")?"is-danger":null,message:t.form.errors.has("time")?t.form.errors.first("time"):null}},[n("b-timepicker",{attrs:{id:"time",value:t.time,placeholder:t.trans("labels.field_observations.click_to_select"),icon:"clock-o","mobile-native":!1},on:{input:t.onTimeInput}},[n("button",{staticClass:"button is-danger",attrs:{type:"button"},on:{click:function(e){t.form.time=null}}},[n("b-icon",{attrs:{icon:"close"}})],1)])],1),t._v(" "),n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("b-field",{attrs:{label:t.trans("labels.literature_observations.project"),type:t.form.errors.has("project")?"is-danger":null,message:t.form.errors.has("project")?t.form.errors.first("project"):null}},[n("label",{staticClass:"label",attrs:{slot:"label",for:"project"},slot:"label"},[n("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.trans("labels.literature_observations.project_tooltip")},expression:"{content: trans('labels.literature_observations.project_tooltip')}"}],staticClass:"is-dashed"},[t._v("\n              "+t._s(t.trans("labels.literature_observations.project"))+"\n            ")])]),t._v(" "),n("b-input",{attrs:{id:"project",name:"project"},model:{value:t.form.project,callback:function(e){t.$set(t.form,"project",e)},expression:"form.project"}})],1)],1),t._v(" "),n("div",{staticClass:"column"},[n("b-field",{attrs:{label:t.trans("labels.field_observations.dataset"),"label-for":"dataset",type:t.form.errors.has("dataset")?"is-danger":null,message:t.form.errors.has("dataset")?t.form.errors.first("dataset"):null}},[n("b-input",{attrs:{id:"dataset",name:"dataset"},model:{value:t.form.dataset,callback:function(e){t.$set(t.form,"dataset",e)},expression:"form.dataset"}})],1)],1)]),t._v(" "),n("b-checkbox",{model:{value:t.form.found_dead,callback:function(e){t.$set(t.form,"found_dead",e)},expression:"form.found_dead"}},[t._v(t._s(t.trans("labels.field_observations.found_dead")))]),t._v(" "),t.form.found_dead?n("b-field",{attrs:{label:t.trans("labels.field_observations.found_dead_note"),"label-for":"found_dead_note",error:t.form.errors.has("found_dead_note"),message:t.form.errors.has("found_dead_note")?t.form.errors.first("found_dead_note"):null}},[n("b-input",{attrs:{id:"found_dead_note",type:"textarea"},model:{value:t.form.found_dead_note,callback:function(e){t.$set(t.form,"found_dead_note",e)},expression:"form.found_dead_note"}})],1):t._e(),t._v(" "),t.showObserverIdentifier?[n("nz-user-autocomplete",{attrs:{error:t.form.errors.has("observer"),message:t.form.errors.has("observer")?t.form.errors.first("observer"):null,user:t.form.observed_by,label:t.trans("labels.field_observations.observer"),placeholder:t.currentUser.full_name},on:{select:t.onObserverSelect},model:{value:t.form.observer,callback:function(e){t.$set(t.form,"observer",e)},expression:"form.observer"}}),t._v(" "),n("nz-user-autocomplete",{attrs:{error:t.form.errors.has("identifier"),message:t.form.errors.has("identifier")?t.form.errors.first("identifier"):null,user:t.form.identified_by,label:t.trans("labels.field_observations.identifier"),disabled:!t.isIdentified},on:{select:t.onIdentifierSelect},model:{value:t.form.identifier,callback:function(e){t.$set(t.form,"identifier",e)},expression:"form.identifier"}})]:t._e(),t._v(" "),n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("b-field",{attrs:{label:t.trans("labels.field_observations.data_license"),"label-for":"data_license",type:t.form.errors.has("data_license")?"is-danger":null,message:t.form.errors.has("data_license")?t.form.errors.first("data_license"):null}},[n("b-select",{attrs:{id:"data_license",expanded:""},model:{value:t.form.data_license,callback:function(e){t.$set(t.form,"data_license",e)},expression:"form.data_license"}},[n("option",{domProps:{value:null}},[t._v(t._s(t.trans("labels.field_observations.default")))]),t._v(" "),t._l(t.licenses,function(e,a){return n("option",{domProps:{value:a,textContent:t._s(e)}})})],2)],1)],1)])],2),t._v(" "),n("hr"),t._v(" "),n("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.trans("labels.field_observations.save_tooltip")},expression:"{content: trans('labels.field_observations.save_tooltip')}"}],staticClass:"button is-primary",class:{"is-loading":t.submittingWithRedirect},attrs:{type:"submit"},on:{click:function(e){return e.preventDefault(),t.submitWithRedirect(e)}}},[t._v("\n    "+t._s(t.trans("buttons.save"))+"\n  ")]),t._v(" "),t.submitMore?n("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.trans("labels.field_observations.save_more_tooltip")},expression:"{content: trans('labels.field_observations.save_more_tooltip')}"}],staticClass:"button is-primary",class:{"is-outlined":!t.submittingWithoutRedirect,"is-loading":t.submittingWithoutRedirect},attrs:{type:"submit"},on:{click:function(e){return e.preventDefault(),t.submitWithoutRedirect(e)}}},[t._v("\n    "+t._s(t.trans("buttons.save_more"))+"\n  ")]):t._e(),t._v(" "),n("a",{staticClass:"button is-text",attrs:{href:t.cancelUrl},on:{click:t.onCancel}},[t._v(t._s(t.trans("buttons.cancel")))])])},[],!1,null,null,null).exports;function we(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Se(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ae={name:"nzLiteratureObservationForm",mixins:[{props:{cacheKey:{default:null},cacheLifetime:{default:1440}},computed:{storageKey:function(){return this.cacheKey?"nz-form.".concat(this.cacheKey):"nz-form.".concat(window.location.host).concat(window.location.pathname)}},methods:{getFormKey:function(){return"form"},otherPersistentKeys:function(){return[]},saveState:function(){var t=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){we(t,e,n[e])})}return t}({},_.pick(this.$data,this.otherPersistentKeys()),{form:this[this.getFormKey()].data()});Lt.set(this.storageKey,t,this.cacheLifetime)},restoreState:function(){var t=this,e=Lt.get(this.storageKey);null!==e&&(this[this.getFormKey()].populate(e.form),this.otherPersistentKeys().forEach(function(n){void 0!==e[n]&&t.$set(t,n,e[n])}),this.clearPersistedState())},clearPersistedState:function(){Lt.delete(this.storageKey)}}},he],props:{submitMoreWithSameTaxon:Boolean,observation:{type:Object,default:function(){return{original_date:null,original_locality:null,original_elevation:null,original_coordinates:null,original_identification:null,original_identification_validity:null,place_where_referenced_in_publication:null,publication_id:null,taxon_id:null,year:moment().year(),month:moment().month()+1,day:moment().date(),is_original_data:!0,cited_publication_id:null,latitude:null,longitude:null,location:null,accuracy:null,elevation:null,minimum_elevation:null,maximum_elevation:null,georeferenced_by:null,georeferenced_date:null,observer:null,identifier:null,note:null,sex:null,number:null,project:null,found_on:null,habitat:null,stage_id:null,time:null,dataset:null,taxon:null,publication:null,cited_publication:null}}},sexes:{type:Array,default:function(){return[]}},validityOptions:{type:[Array,Object],default:function(){return[]}}},data:function(){return{keepAfterSubmit:this.getAttributesToKeep(),submittingWithoutRedirectWithSameTaxon:!1,locale:window.App.locale,taxonName:_.get(this.observation,"taxon.name",""),publicationCitation:_.get(this.observation,"publication.citation",""),citedPublication:_.get(this.observation,"cited_publication.citation","")}},computed:{stages:function(){return this.form.taxon?this.form.taxon.stages:[]},time:function(){return this.form.time?moment(this.form.time,"HH:mm").toDate():null},georeferencedDate:{get:function(){var t=moment(this.form.georeferenced_date);return t.isValid()?t.toDate():null},set:function(t){this.form.georeferenced_date=moment(t).format("YYYY-MM-DD")}}},created:function(){this.restoreState()},methods:{otherPersistentKeys:function(){return["taxonName","publicationCitation","citedPublication"]},newForm:function(){return new le.a(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){Se(t,e,n[e])})}return t}({},this.observation,{reason:null}),{resetOnSuccess:!1})},onTaxonSelect:function(t){var e=this;this.form.taxon=t||null,this.form.taxon_id=t?t.id:null,this.taxonName=t?t.name:null,!fe()(this.stages).contains(function(t){return t.id===e.form.stage_id})&&(this.form.stage_id=null)},onPublicationSelect:function(t){this.form.publication=t||null,this.form.publication_id=t?t.id:null,this.publicationCitation=t?t.citation:null},onCitedPublicationSelect:function(t){this.form.cited_publication=t||null,this.form.cited_publication_id=t?t.id:null,this.citedPublication=t?t.citation:null},onTimeInput:function(t){this.form.time=t?moment(t).format("HH:mm"):null},getAttributesToKeep:function(){return["location","accuracy","elevation","latitude","longitude","year","month","day","project","observer","identifier","dataset","publication","publication_id","cited_publication","cited_publication_id","is_original_data","minimum_elevation","maximum_elevation","original_locality","original_elevation","original_coordinates","georeferenced_by","georeferenced_date"]},hookAfterSubmitWithoutRedirect:function(){this.taxonName=""},handleIsOriginalDataInput:function(t){t||this.onCitedPublicationSelect(null),this.form.is_original_data=t},addNewPublication:function(){this.saveState(),window.location.href=route("admin.publications.create")},dateFormater:function(t){return moment(t).format("DD.MM.YYYY")},handleElevationFetched:function(t){this.form.minimum_elevation=t,this.form.maximum_elevation=t},submitWithoutRedirectWithSameTaxon:function(){if(!this.form.processing)return this.submitOnlyDirty&&!this.isDirty()?this.notifyNoChanges():this.shouldConfirmSubmit?this.confirmSubmit(this.performSubmitWithoutRedirectWithSameTaxon):void this.performSubmitWithoutRedirectWithSameTaxon()},performSubmitWithoutRedirectWithSameTaxon:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.submittingWithoutRedirectWithSameTaxon=!0,this.confirmingSubmit=!1,this.shouldAskReason&&(this.form.reason=e),this.form[this.method.toLowerCase()](this.action).then(this.onSuccessfulSubmitWithoutRedirectWithSameTaxon).catch(function(e){t.submittingWithoutRedirectWithSameTaxon=!1,t.onFailedSubmit(e)})},onSuccessfulSubmitWithoutRedirectWithSameTaxon:function(){this.submittingWithoutRedirectWithSameTaxon=!1,this.$toast.open({message:this.trans("Saved successfully"),type:"is-success"});var t=_.pick(this.form.data(),this.keepAfterSubmit.concat(["original_identification_validity","place_where_referenced_in_publication","taxon","taxon_id","original_identification"]));this.form.reset(),this.form.populate(t)}}},Oe=Object(p.a)(Ae,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{staticClass:"literature-observation-form",attrs:{action:t.action,method:"POST",lang:t.locale}},[n("div",{staticClass:"mb-8"},[n("nz-publication-autocomplete",{ref:"publicationAutocomplete",staticClass:"is-required",attrs:{publication:t.form.publication,error:t.form.errors.has("publication_id"),message:t.form.errors.has("publication_id")?t.form.errors.first("publication_id"):null,autofocus:"autofocus",label:t.trans("labels.literature_observations.publication"),placeholder:t.trans("labels.literature_observations.search_for_publication")},on:{select:t.onPublicationSelect},model:{value:t.publicationCitation,callback:function(e){t.publicationCitation=e},expression:"publicationCitation"}},[n("a",{staticClass:"button",attrs:{title:t.trans("labels.literature_observations.add_new_publication"),href:t.$ziggy("admin.publications.create")},on:{click:function(e){return e.preventDefault(),t.addNewPublication(e)}}},[n("b-icon",{attrs:{icon:"plus"}})],1)]),t._v(" "),n("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.literature_observations.is_original_data"),error:t.form.errors.has("is_original_data"),message:t.form.errors.has("is_original_data")?t.form.errors.first("is_original_data"):null}},[n("b-select",{attrs:{value:t.form.is_original_data,expanded:""},on:{input:t.handleIsOriginalDataInput}},[n("option",{domProps:{value:!0}},[t._v(t._s(t.trans("labels.literature_observations.original_data")))]),t._v(" "),n("option",{domProps:{value:!1}},[t._v(t._s(t.trans("labels.literature_observations.citation")))])])],1),t._v(" "),n("nz-publication-autocomplete",{directives:[{name:"show",rawName:"v-show",value:!t.form.is_original_data,expression:"!form.is_original_data"}],staticClass:"is-required",attrs:{publication:t.form.cited_publication,error:t.form.errors.has("cited_publication_id"),message:t.form.errors.has("cited_publication_id")?t.form.errors.first("cited_publication_id"):null,label:t.trans("labels.literature_observations.cited_publication"),placeholder:t.trans("labels.literature_observations.search_for_publication")},on:{select:t.onCitedPublicationSelect},model:{value:t.citedPublication,callback:function(e){t.citedPublication=e},expression:"citedPublication"}},[n("a",{staticClass:"button",attrs:{title:t.trans("labels.literature_observations.add_new_publication"),href:t.$ziggy("admin.publications.create")},on:{click:function(e){return e.preventDefault(),t.addNewPublication(e)}}},[n("b-icon",{attrs:{icon:"plus"}})],1)]),t._v(" "),n("nz-taxon-autocomplete",{ref:"taxonAutocomplete",staticClass:"is-required",attrs:{taxon:t.form.taxon,error:t.form.errors.has("taxon_id"),message:t.form.errors.has("taxon_id")?t.form.errors.first("taxon_id"):null,autofocus:"autofocus",label:t.trans("labels.literature_observations.taxon"),placeholder:t.trans("labels.literature_observations.search_for_taxon")},on:{select:t.onTaxonSelect},model:{value:t.taxonName,callback:function(e){t.taxonName=e},expression:"taxonName"}}),t._v(" "),n("nz-date-input",{attrs:{year:t.form.year,month:t.form.month,day:t.form.day,errors:t.form.errors,label:t.trans("labels.literature_observations.date"),placeholders:{year:t.trans("labels.literature_observations.year"),month:t.trans("labels.literature_observations.month"),day:t.trans("labels.literature_observations.day")}},on:{"update:year":function(e){return t.$set(t.form,"year",e)},"update:month":function(e){return t.$set(t.form,"month",e)},"update:day":function(e){return t.$set(t.form,"day",e)}}}),t._v(" "),n("div",[n("h2",{staticClass:"is-size-4"},[t._v(t._s(t.trans("labels.literature_observations.verbatim_data")))]),t._v(" "),n("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.literature_observations.original_identification"),type:t.form.errors.has("original_identification")?"is-danger":null,message:t.form.errors.has("original_identification")?t.form.errors.first("original_identification"):null}},[n("b-input",{attrs:{name:"original_identification"},model:{value:t.form.original_identification,callback:function(e){t.$set(t.form,"original_identification",e)},expression:"form.original_identification"}})],1),t._v(" "),n("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.literature_observations.original_identification_validity"),type:t.form.errors.has("original_identification_validity")?"is-danger":null,message:t.form.errors.has("original_identification_validity")?t.form.errors.first("original_identification_validity"):null}},[n("b-select",{attrs:{name:"original_identification_validity",expanded:""},model:{value:t.form.original_identification_validity,callback:function(e){t.$set(t.form,"original_identification_validity",e)},expression:"form.original_identification_validity"}},t._l(t.validityOptions,function(e,a){return n("option",{domProps:{value:a}},[t._v(t._s(e))])}),0)],1),t._v(" "),n("div",{staticClass:"columns"},[n("b-field",{staticClass:"column",attrs:{label:t.trans("labels.literature_observations.original_date"),type:t.form.errors.has("original_date")?"is-danger":null,message:t.form.errors.has("original_date")?t.form.errors.first("original_date"):null}},[n("b-input",{attrs:{name:"original_date"},model:{value:t.form.original_date,callback:function(e){t.$set(t.form,"original_date",e)},expression:"form.original_date"}})],1),t._v(" "),n("b-field",{staticClass:"column",attrs:{label:t.trans("labels.literature_observations.original_locality"),type:t.form.errors.has("original_locality")?"is-danger":null,message:t.form.errors.has("original_locality")?t.form.errors.first("original_locality"):null}},[n("b-input",{model:{value:t.form.original_locality,callback:function(e){t.$set(t.form,"original_locality",e)},expression:"form.original_locality"}})],1)],1),t._v(" "),n("div",{staticClass:"columns"},[n("b-field",{staticClass:"column",attrs:{label:t.trans("labels.literature_observations.original_coordinates"),type:t.form.errors.has("original_coordinates")?"is-danger":null,message:t.form.errors.has("original_coordinates")?t.form.errors.first("original_coordinates"):null}},[n("b-input",{model:{value:t.form.original_coordinates,callback:function(e){t.$set(t.form,"original_coordinates",e)},expression:"form.original_coordinates"}})],1),t._v(" "),n("b-field",{staticClass:"column",attrs:{label:t.trans("labels.literature_observations.original_elevation"),type:t.form.errors.has("original_elevation")?"is-danger":null,message:t.form.errors.has("original_elevation")?t.form.errors.first("original_elevation"):null}},[n("b-input",{attrs:{placeholder:t.trans("labels.literature_observations.original_elevation_placeholder")},model:{value:t.form.original_elevation,callback:function(e){t.$set(t.form,"original_elevation",e)},expression:"form.original_elevation"}})],1)],1)],1),t._v(" "),n("nz-spatial-input",{staticClass:"mb-4",attrs:{latitude:t.form.latitude,longitude:t.form.longitude,location:t.form.location,accuracy:t.form.accuracy,elevation:t.form.elevation,errors:t.form.errors,"has-other-errors":t.form.errors.has("minimum_elevation")||t.form.errors.has("maximum_elevation")},on:{"update:latitude":function(e){return t.$set(t.form,"latitude",e)},"update:longitude":function(e){return t.$set(t.form,"longitude",e)},"update:location":function(e){return t.$set(t.form,"location",e)},"update:accuracy":function(e){return t.$set(t.form,"accuracy",e)},"update:elevation":function(e){return t.$set(t.form,"elevation",e)},"elevation-fetched":t.handleElevationFetched}},[n("b-field",{attrs:{label:t.trans("labels.literature_observations.minimum_elevation_m"),type:t.form.errors.has("minimum_elevation")?"is-danger":null,message:t.form.errors.has("minimum_elevation")?t.form.errors.first("minimum_elevation"):null,"custom-class":"is-small"}},[n("b-input",{attrs:{type:"number",size:"is-small"},model:{value:t.form.minimum_elevation,callback:function(e){t.$set(t.form,"minimum_elevation",t._n(e))},expression:"form.minimum_elevation"}})],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.literature_observations.maximum_elevation_m"),type:t.form.errors.has("maximum_elevation")?"is-danger":null,message:t.form.errors.has("maximum_elevation")?t.form.errors.first("maximum_elevation"):null,"custom-class":"is-small"}},[n("b-input",{attrs:{type:"number",size:"is-small"},model:{value:t.form.maximum_elevation,callback:function(e){t.$set(t.form,"maximum_elevation",t._n(e))},expression:"form.maximum_elevation"}})],1)],1),t._v(" "),n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("b-field",{attrs:{label:t.trans("labels.literature_observations.georeferenced_by"),type:t.form.errors.has("georeferenced_by")?"is-danger":null,message:t.form.errors.has("georeferenced_by")?t.form.errors.first("georeferenced_by"):null}},[n("b-input",{model:{value:t.form.georeferenced_by,callback:function(e){t.$set(t.form,"georeferenced_by",t._n(e))},expression:"form.georeferenced_by"}})],1)],1),t._v(" "),n("div",{staticClass:"column"},[n("b-field",{attrs:{label:t.trans("labels.literature_observations.georeferenced_date"),type:t.form.errors.has("georeferenced_date")?"is-danger":null,message:t.form.errors.has("georeferenced_date")?t.form.errors.first("georeferenced_date"):null}},[n("b-datepicker",{attrs:{"max-date":new Date,"mobile-native":!1,"date-formatter":t.dateFormater,"first-day-of-week":1,placeholder:"DD.MM.YYYY"},model:{value:t.georeferencedDate,callback:function(e){t.georeferencedDate=e},expression:"georeferencedDate"}},[n("button",{staticClass:"button is-danger",attrs:{type:"button"},on:{click:function(e){t.form.georeferenced_date=null}}},[n("b-icon",{attrs:{icon:"close"}}),t._v(" "),n("span",[t._v("Clear")])],1)])],1)],1)]),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.literature_observations.stage"),type:t.form.errors.has("stage_id")?"is-danger":null,message:t.form.errors.has("stage_id")?t.form.errors.first("stage_id"):null}},[n("b-select",{attrs:{disabled:!t.stages.length,expanded:"expanded"},model:{value:t.form.stage_id,callback:function(e){t.$set(t.form,"stage_id",e)},expression:"form.stage_id"}},[n("option",{domProps:{value:null}},[t._v(t._s(t.trans("labels.literature_observations.choose_a_stage")))]),t._v(" "),t._l(t.stages,function(e){return n("option",{key:e.id,domProps:{value:e.id,textContent:t._s(t.trans("stages."+e.name))}})})],2)],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.literature_observations.sex"),type:t.form.errors.has("sex")?"is-danger":null,message:t.form.errors.has("sex")?t.form.errors.first("sex"):null}},[n("b-select",{attrs:{expanded:"expanded"},model:{value:t.form.sex,callback:function(e){t.$set(t.form,"sex",e)},expression:"form.sex"}},[n("option",{domProps:{value:null}},[t._v(t._s(t.trans("labels.literature_observations.choose_a_value")))]),t._v(" "),t._l(t.sexes,function(e){return n("option",{domProps:{value:e,textContent:t._s(t.trans("labels.sexes."+e))}})})],2)],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.literature_observations.number"),type:t.form.errors.has("number")?"is-danger":null,message:t.form.errors.has("number")?t.form.errors.first("number"):null}},[n("b-input",{attrs:{type:"number"},model:{value:t.form.number,callback:function(e){t.$set(t.form,"number",e)},expression:"form.number"}})],1),t._v(" "),n("div",{staticClass:"mt-4"},[n("b-field",{attrs:{label:t.trans("labels.literature_observations.note"),error:t.form.errors.has("note"),message:t.form.errors.has("note")?t.form.errors.first("note"):null}},[n("b-input",{attrs:{type:"textarea"},model:{value:t.form.note,callback:function(e){t.$set(t.form,"note",e)},expression:"form.note"}})],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.literature_observations.habitat"),type:t.form.errors.has("habitat")?"is-danger":null,message:t.form.errors.has("habitat")?t.form.errors.first("habitat"):null}},[n("b-input",{model:{value:t.form.habitat,callback:function(e){t.$set(t.form,"habitat",e)},expression:"form.habitat"}})],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.literature_observations.found_on"),type:t.form.errors.has("found_on")?"is-danger":null,message:t.form.errors.has("found_on")?t.form.errors.first("found_on"):null}},[n("label",{staticClass:"label",attrs:{slot:"label",for:"found_on"},slot:"label"},[n("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.trans("labels.literature_observations.found_on_tooltip")},expression:"{content: trans('labels.literature_observations.found_on_tooltip')}"}],staticClass:"is-dashed"},[t._v("\n            "+t._s(t.trans("labels.literature_observations.found_on"))+"\n          ")])]),t._v(" "),n("b-input",{attrs:{id:"found_on",name:"found_on"},model:{value:t.form.found_on,callback:function(e){t.$set(t.form,"found_on",e)},expression:"form.found_on"}})],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.literature_observations.time"),type:t.form.errors.has("time")?"is-danger":null,message:t.form.errors.has("time")?t.form.errors.first("time"):null}},[n("b-timepicker",{attrs:{value:t.time,placeholder:t.trans("labels.literature_observations.click_to_select"),icon:"clock-o","mobile-native":!1},on:{input:t.onTimeInput}},[n("button",{staticClass:"button is-danger",attrs:{type:"button"},on:{click:function(e){t.form.time=null}}},[n("b-icon",{attrs:{icon:"close"}})],1)])],1),t._v(" "),n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("div",{staticClass:"field"},[n("label",{staticClass:"label",attrs:{for:"project"}},[n("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.trans("labels.literature_observations.project_tooltip")},expression:"{content: trans('labels.literature_observations.project_tooltip')}"}],staticClass:"is-dashed"},[t._v("\n                "+t._s(t.trans("labels.literature_observations.project"))+"\n              ")])]),t._v(" "),n("b-input",{attrs:{id:"project",name:"project"},model:{value:t.form.project,callback:function(e){t.$set(t.form,"project",e)},expression:"form.project"}}),t._v(" "),t.form.errors.has("project")?n("p",{staticClass:"help",class:{"is-danger":t.form.errors.has("project")},domProps:{innerHTML:t._s(t.form.errors.first("project"))}}):t._e()],1)]),t._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"field"},[n("label",{staticClass:"label",attrs:{for:"dataset"}},[t._v("\n              "+t._s(t.trans("labels.literature_observations.dataset"))+"\n            ")]),t._v(" "),n("b-input",{attrs:{id:"dataset",name:"dataset"},model:{value:t.form.dataset,callback:function(e){t.$set(t.form,"dataset",e)},expression:"form.dataset"}}),t._v(" "),t.form.errors.has("dataset")?n("p",{staticClass:"help",class:{"is-danger":t.form.errors.has("dataset")},domProps:{innerHTML:t._s(t.form.errors.first("dataset"))}}):t._e()],1)])]),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.literature_observations.observer"),type:t.form.errors.has("observer")?"is-danger":null,message:t.form.errors.has("observer")?t.form.errors.first("observer"):null}},[n("b-input",{attrs:{name:"observer"},model:{value:t.form.observer,callback:function(e){t.$set(t.form,"observer",e)},expression:"form.observer"}})],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.literature_observations.identifier"),type:t.form.errors.has("identifier")?"is-danger":null,message:t.form.errors.has("identifier")?t.form.errors.first("identifier"):null}},[n("b-input",{attrs:{name:"identifier"},model:{value:t.form.identifier,callback:function(e){t.$set(t.form,"identifier",e)},expression:"form.identifier"}})],1)],1)],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.literature_observations.place_where_referenced_in_publication"),type:t.form.errors.has("place_where_referenced_in_publication")?"is-danger":null,message:t.form.errors.has("place_where_referenced_in_publication")?t.form.errors.first("place_where_referenced_in_publication"):null}},[n("b-input",{attrs:{placeholder:t.trans("labels.literature_observations.place_where_referenced_in_publication_placeholder")},model:{value:t.form.place_where_referenced_in_publication,callback:function(e){t.$set(t.form,"place_where_referenced_in_publication",e)},expression:"form.place_where_referenced_in_publication"}})],1),t._v(" "),n("hr"),t._v(" "),n("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.trans("labels.literature_observations.save_tooltip")},expression:"{content: trans('labels.literature_observations.save_tooltip')}"}],staticClass:"button is-primary",class:{"is-loading":t.submittingWithRedirect},attrs:{type:"submit"},on:{click:function(e){return e.preventDefault(),t.submitWithRedirect(e)}}},[t._v("\n    "+t._s(t.trans("buttons.save"))+"\n  ")]),t._v(" "),t.submitMore?n("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.trans("labels.literature_observations.save_more_tooltip")},expression:"{content: trans('labels.literature_observations.save_more_tooltip')}"}],staticClass:"button is-primary",class:{"is-outlined":!t.submittingWithoutRedirect,"is-loading":t.submittingWithoutRedirect},attrs:{type:"submit"},on:{click:function(e){return e.preventDefault(),t.submitWithoutRedirect(e)}}},[t._v("\n    "+t._s(t.trans("buttons.save_more"))+"\n  ")]):t._e(),t._v(" "),t.submitMoreWithSameTaxon?n("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.trans("labels.literature_observations.save_more_same_taxon_tooltip")},expression:"{content: trans('labels.literature_observations.save_more_same_taxon_tooltip')}"}],staticClass:"button is-primary",class:{"is-outlined":!t.submittingWithoutRedirectWithSameTaxon,"is-loading":t.submittingWithoutRedirectWithSameTaxon},attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.submitWithoutRedirectWithSameTaxon(e)}}},[t._v("\n    "+t._s(t.trans("labels.literature_observations.save_more_same_taxon"))+"\n  ")]):t._e(),t._v(" "),n("a",{staticClass:"button is-text",attrs:{href:t.cancelUrl},on:{click:t.onCancel}},[t._v(t._s(t.trans("buttons.cancel")))])],1)},[],!1,null,null,null).exports;function De(){var t={};return _.keys(window.App.supportedLocales).forEach(function(e){t[e]=null}),t}var Pe={name:"nzViewGroupForm",mixins:[he],props:{group:{type:Object,default:function(){return{parent_id:null,only_observed_taxa:!1,taxa:[]}}},rootGroups:Array,names:{type:Object,default:function(){return De()}},descriptions:{type:Object,default:function(){return De()}}},data:function(){return{form:this.newForm(),taxa:this.group.taxa,filteredTaxa:[]}},computed:{supportedLocales:function(){return window.App.supportedLocales},parent:{get:function(){return _.find(this.rootGroups,{id:this.form.parent_id})},set:function(t){this.form.parent_id=_.get(t,"id")}},isRoot:function(){return!this.form.parent_id}},watch:{taxa:function(t){this.form.taxa_ids=t.map(function(t){return t.id})}},methods:{newForm:function(){return new le.a({parent_id:this.group.parent_id,name:this.names,description:this.descriptions,image_url:this.group.image_url,image_path:this.group.image_path,only_observed_taxa:this.group.only_observed_taxa,taxa_ids:this.group.taxa.map(function(t){return t.id})},{resetOnSuccess:!1})},focusOnTranslation:function(t,e){var n=this,a=_.keys(this.supportedLocales),i="#".concat(e,"-").concat(a[t]);setTimeout(function(){n.$el.querySelector(i).focus()},500)},fetchTaxa:function(t){var e=this;axios.get(route("api.taxa.index"),{params:{name:t,page:1,per_page:10,except:this.taxa.map(function(t){return t.id})}}).then(function(t){var n=t.data;e.filteredTaxa=n.data})},onTaxonNameInput:_.debounce(function(t){return this.fetchTaxa(t)},500),onImageUploaded:function(t){this.form.image_path=t.path},onImageRemoved:function(){this.form.image_url=null,this.form.image_path=null}}},je=Object(p.a)(Pe,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{attrs:{action:t.action,method:"POST"},on:{submit:function(e){return e.preventDefault(),t.submitWithRedirect(e)}}},[n("b-field",{attrs:{label:t.trans("labels.view_groups.parent")}},[n("b-select",{model:{value:t.parent,callback:function(e){t.parent=e},expression:"parent"}},[n("option"),t._v(" "),t._l(t.rootGroups,function(e){return n("option",{domProps:{value:e}},[t._v(t._s(e.name))])})],2)],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.view_groups.name")}},[n("b-tabs",{staticClass:"block",attrs:{size:"is-small"},on:{change:function(e){return t.focusOnTranslation(e,"name")}}},t._l(t.supportedLocales,function(e,a){return n("b-tab-item",{key:a,attrs:{label:t.trans("languages."+e.name)}},[n("b-input",{attrs:{id:"name-"+a},model:{value:t.form.name[a],callback:function(e){t.$set(t.form.name,a,e)},expression:"form.name[locale]"}})],1)}),1)],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.view_groups.description")}},[n("b-tabs",{staticClass:"block",attrs:{size:"is-small"},on:{change:function(e){return t.focusOnTranslation(e,"description")}}},t._l(t.supportedLocales,function(e,a){return n("b-tab-item",{key:a,attrs:{label:t.trans("languages."+e.name)}},[n("b-input",{attrs:{type:"textarea",id:"description-"+a},model:{value:t.form.description[a],callback:function(e){t.$set(t.form.description,a,e)},expression:"form.description[locale]"}})],1)}),1)],1),t._v(" "),t.isRoot?t._e():[n("b-field",{attrs:{label:t.trans("labels.view_groups.taxa")}},[n("b-taginput",{attrs:{data:t.filteredTaxa,autocomplete:"",field:"name"},on:{typing:t.onTaxonNameInput},model:{value:t.taxa,callback:function(e){t.taxa=e},expression:"taxa"}})],1),t._v(" "),n("b-field",[n("b-checkbox",{model:{value:t.form.only_observed_taxa,callback:function(e){t.$set(t.form,"only_observed_taxa",e)},expression:"form.only_observed_taxa"}},[t._v(t._s(t.trans("labels.view_groups.only_observed_taxa")))])],1)],t._v(" "),n("b-field",{attrs:{label:t.trans("labels.view_groups.image")}},[n("nz-photo-upload",{attrs:{"image-url":t.form.image_url,"image-path":t.form.image_path,licenses:{},"with-license":!1,"with-crop":!1},on:{uploaded:t.onImageUploaded,removed:t.onImageRemoved}})],1),t._v(" "),n("hr"),t._v(" "),n("button",{staticClass:"button is-primary",class:{"is-loading":t.form.processing},attrs:{type:"submit"},on:{click:t.submitWithRedirect}},[t._v("\n    "+t._s(t.trans("buttons.save"))+"\n  ")]),t._v(" "),n("a",{staticClass:"button is-text",attrs:{href:t.cancelUrl},on:{click:t.onCancel}},[t._v(t._s(t.trans("buttons.cancel")))])],2)},[],!1,null,null,null).exports;function Ie(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Te(){var t={};return _.keys(window.App.supportedLocales).forEach(function(e){t[e]=null}),t}var Re={name:"nzAnnouncementForm",props:{action:String,method:{type:String,default:"post"},types:{type:Array,default:function(){return[]}},announcement:{type:Object,default:function(){return{private:!1}}},title:{type:Object,default:function(){return Te()}},message:{type:Object,default:function(){return Te()}},redirectUrl:String,cancelUrl:String},data:function(){return{form:this.newForm()}},computed:{supportedLocales:function(){return window.App.supportedLocales},isEdit:function(){return"put"===this.method.toLowerCase()}},methods:{submit:function(){this.form.processing||this.form[this.method.toLowerCase()](this.action).then(this.onSuccessfulSubmit).catch(this.onFailedSubmit)},onSuccessfulSubmit:function(){var t=this;this.form.processing=!0,this.$toast.open({message:this.trans("Saved successfully"),type:"is-success"}),setTimeout(function(){t.form.processing=!1,window.location.href=t.redirectUrl},500)},onFailedSubmit:function(t){this.$toast.open({duration:2500,message:_.get(t,"response.data.message",t.message),type:"is-danger"})},newForm:function(){return new le.a(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){Ie(t,e,n[e])})}return t}({},this.announcement,{title:this.title,message:this.message}),{resetOnSuccess:!1})},focusOnTranslation:function(t,e){var n=this,a=_.keys(this.supportedLocales),i="".concat(e,"-").concat(a[t]);setTimeout(function(){_.first(n.$refs[i]).focus()},500)}}},$e=Object(p.a)(Re,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{staticClass:"announcement-form",on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[n("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.announcements.title"),type:t.form.errors.has("title")?"is-danger":"",message:t.form.errors.has("title")?t.form.errors.first("title"):""}},[n("b-tabs",{staticClass:"block",attrs:{size:"is-small"},on:{change:function(e){return t.focusOnTranslation(e,"title")}}},t._l(t.supportedLocales,function(e,a){return n("b-tab-item",{key:a,attrs:{label:t.trans("languages."+e.name)}},[n("b-input",{ref:"title-"+a,refInFor:!0,attrs:{autofocus:""},model:{value:t.form.title[a],callback:function(e){t.$set(t.form.title,a,e)},expression:"form.title[locale]"}})],1)}),1)],1),t._v(" "),n("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.announcements.message"),type:t.form.errors.has("message")?"is-danger":"",message:t.form.errors.has("message")?t.form.errors.first("message"):""}},[n("b-tabs",{staticClass:"block",attrs:{size:"is-small"},on:{change:function(e){return t.focusOnTranslation(e,"message")}}},t._l(t.supportedLocales,function(e,a){return n("b-tab-item",{key:a,attrs:{label:t.trans("languages."+e.name)}},[n("nz-wysiwyg",{ref:"message-"+a,refInFor:!0,model:{value:t.form.message[a],callback:function(e){t.$set(t.form.message,a,e)},expression:"form.message[locale]"}})],1)}),1)],1),t._v(" "),n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("b-field",{attrs:{label:t.trans("labels.announcements.private")}},[n("b-switch",{model:{value:t.form.private,callback:function(e){t.$set(t.form,"private",e)},expression:"form.private"}},[t._v("\n            "+t._s(t.form.private?t.trans("Yes"):t.trans("No"))+"\n        ")])],1)],1)]),t._v(" "),n("hr"),t._v(" "),n("button",{staticClass:"button is-primary",attrs:{type:"submit"}},[t._v(t._s(t.isEdit?t.trans("buttons.save"):t.trans("labels.announcements.publish")))]),t._v(" "),n("a",{staticClass:"button",attrs:{href:t.cancelUrl}},[t._v(t._s(t.trans("buttons.cancel")))])],1)},[],!1,null,null,null).exports,Ee=(n("wd/R"),{name:"nzPublicationAttachmentUpload",props:{attachmentName:String},data:function(){return{attachmentFileName:this.attachmentName,reader:null,uploading:!1,progress:0,error:null}},computed:{hasAttachment:function(){return!!this.attachmentFileName}},methods:{onInput:function(t){this.error=null,t?this.upload(t):this.remove()},upload:function(t){var e=this;return this.uploading=!0,axios.post(route("api.publication-attachments.store"),this.makeForm(t),{headers:{"Content-Type":"multipart/form-data",Accept:"application/json"},onUploadProgress:function(t){e.progress=Math.floor(100*t.loaded/t.total)}}).then(function(t){var n=t.data.data;e.attachmentFileName=n.original_name,e.uploading=!1,e.progress=0,e.$emit("uploaded",n)}).catch(this.handleError)},makeForm:function(t){var e=new FormData;return e.append("attachment",t),e},remove:function(){this.$emit("removed",this.attachment),this.attachmentFileName=null},handleError:function(t){if(this.uploading=!1,this.progress=0,this.$el.querySelector('input[type="file"]').value="",!t.response)return this.$toast.open({duration:5e3,message:t.message,position:"is-top",type:"is-danger"});this.error=t.response.data.errors.attachment[0]||this.trans("Error")}}}),Fe=Object(p.a)(Ee,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-field",{attrs:{message:t.error||null,type:t.error?"is-danger":null,expanded:""}},[n("b-field",{staticClass:"file"},[t.uploading?n("progress",{staticClass:"progress is-primary is-small",attrs:{max:"100"},domProps:{value:t.progress}},[t._v(t._s(t.progress)+"%")]):t._e(),t._v(" "),t.hasAttachment?n("div",{staticClass:"flex items-center justify-between w-full"},[n("div",{staticClass:"mr-4"},[t._v("\n        "+t._s(t.attachmentFileName)+"\n      ")]),t._v(" "),n("button",{staticClass:"button is-danger is-outlined",attrs:{type:"button"},on:{click:t.remove}},[n("b-icon",{attrs:{icon:"times"}})],1)]):n("b-upload",{directives:[{name:"show",rawName:"v-show",value:!t.uploading,expression:"!uploading"}],attrs:{accept:".pdf,.odt,.doc,.docx"},on:{input:t.onInput}},[n("button",{staticClass:"button is-secondary",attrs:{type:"button"}},[n("b-icon",{attrs:{icon:"upload"}}),t._v(" "),n("span",[t._v("Upload Document")])],1)])],1)],1)},[],!1,null,null,null).exports;function Me(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ze(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){Le(t,e,n[e])})}return t}function Le(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ne={name:"nzPublicationForm",components:Le({},Fe.name,Fe),mixins:[he],props:{publication:{type:Object,default:function(){return{type:null,year:null,name:null,title:null,publisher:null,issue:null,place:null,page_count:null,page_range:null,doi:null,citation:null,authors:[],editors:[],link:null,attachment:null,attachment_id:null}}},publicationTypes:{type:Array,default:function(){return[]}}},data:function(){return{form:new le.a(ze({},this.publication),{resetOnSuccess:!1})}},computed:{chosenType:function(){return _.find(this.publicationTypes,{value:this.form.type})},typeHasName:function(){return!!this.chosenType&&this.chosenType.has_name},typeHasEditors:function(){return!!this.chosenType&&this.chosenType.has_editors},typeRequiresEditors:function(){return!!this.chosenType&&this.chosenType.requires_editors},typeHasPublisher:function(){return!!this.chosenType&&this.chosenType.has_publisher},typeRequiresPublisher:function(){return!!this.chosenType&&this.chosenType.requires_publisher},typeHasIssue:function(){return!!this.chosenType&&this.chosenType.has_issue},typeRequiresIssue:function(){return!!this.chosenType&&this.chosenType.requires_issue},typeHasPlace:function(){return!!this.chosenType&&this.chosenType.has_place},typeRequiresPlace:function(){return!!this.chosenType&&this.chosenType.requires_place},typeHasPageRange:function(){return!!this.chosenType&&this.chosenType.has_page_range},nameLabel:function(){var t=this.form.type;return this.trans("labels.publications.".concat(t,"_name"),{},this.trans("labels.publications.name"))},titleLabel:function(){var t=this.form.type;return this.trans("labels.publications.".concat(t,"_title"),{},this.trans("labels.publications.title"))}},methods:{addAuthor:function(){this.form.authors.push({first_name:"",last_name:""})},addEditor:function(){this.form.editors.push({first_name:"",last_name:""})},removeAuthor:function(t){this.removeItemFromField("authors",t)},removeEditor:function(t){this.removeItemFromField("editors",t)},removeItemFromField:function(t,e){this.form[t]=[].concat(Me(this.form[t].slice(0,e)),Me(this.form[t].slice(e+1))),this.removeErrorForItem(t,e)},removeErrorForItem:function(t,e){var n=this.form.errors.all(),a={};Object.keys(n).forEach(function(i){var s=i.match(new RegExp("^".concat(t,".(\\d+)$")));s&&s[1]>e?a["".concat(t,".").concat(s[1]-1)]=n[i]:s||(a[i]=n[i])}),this.form.errors.record(a)},handleAttachmentUploaded:function(t){this.form.attachment=t,this.form.attachment_id=t.id},handleRemovedAttachment:function(){this.form.attachment=null,this.form.attachment_id=null},authorHasError:function(t){return this.form.errors.has("authors.".concat(t))||this.form.errors.has("authors.".concat(t,".first_name"))||this.form.errors.has("authors.".concat(t,".last_name"))},getAuthorError:function(t){return this.form.errors.first("authors.".concat(t))||this.form.errors.first("authors.".concat(t,".first_name"))||this.form.errors.first("authors.".concat(t,".last_name"))},editorHasError:function(t){return this.form.errors.has("editors.".concat(t))||this.form.errors.has("editors.".concat(t,".first_name"))||this.form.errors.has("editors.".concat(t,".last_name"))},getEditorError:function(t){return this.form.errors.first("editors.".concat(t))||this.form.errors.first("editors.".concat(t,".first_name"))||this.form.errors.first("editors.".concat(t,".last_name"))}}},Ue=Object(p.a)(Ne,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{staticClass:"publication-form",attrs:{action:t.action,method:t.method,lang:t.locale},on:{submit:function(e){return e.preventDefault(),t.submitWithRedirect(e)}}},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.publications.type"),"label-for":"type",type:t.form.errors.has("type")?"is-danger":null,message:t.form.errors.has("type")?t.form.errors.first("type"):null}},[n("b-select",{attrs:{id:"type",name:"type",expanded:""},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.publicationTypes,function(e){return n("option",{key:e.value,domProps:{value:e.value}},[t._v("\n            "+t._s(e.label)+"\n          ")])}),0)],1),t._v(" "),n("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.publications.year"),"label-for":"year",type:t.form.errors.has("year")?"is-danger":null,message:t.form.errors.has("year")?t.form.errors.first("year"):null}},[n("b-input",{attrs:{id:"year",name:"year",type:"number",expanded:""},model:{value:t.form.year,callback:function(e){t.$set(t.form,"year",e)},expression:"form.year"}})],1),t._v(" "),t.typeHasName?n("b-field",{staticClass:"is-required",attrs:{label:t.nameLabel,"label-for":"name",type:t.form.errors.has("name")?"is-danger":null,message:t.form.errors.has("name")?t.form.errors.first("name"):null}},[n("b-input",{attrs:{id:"name",name:"name",expanded:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1):t._e(),t._v(" "),n("b-field",{staticClass:"is-required",attrs:{label:t.titleLabel,"label-for":"title",type:t.form.errors.has("title")?"is-danger":null,message:t.form.errors.has("title")?t.form.errors.first("title"):null}},[n("b-input",{attrs:{id:"title",name:"title",expanded:""},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),t.typeHasPublisher?n("b-field",{class:{"is-required":t.typeRequiresPublisher},attrs:{label:t.trans("labels.publications.publisher"),"label-for":"publisher",type:t.form.errors.has("publisher")?"is-danger":null,message:t.form.errors.has("publisher")?t.form.errors.first("publisher"):null}},[n("b-input",{attrs:{id:"publisher",name:"publisher",expanded:""},model:{value:t.form.publisher,callback:function(e){t.$set(t.form,"publisher",e)},expression:"form.publisher"}})],1):t._e(),t._v(" "),t.typeHasIssue?n("b-field",{class:{"is-required":t.typeRequiresIssue},attrs:{label:t.trans("labels.publications.issue"),"label-for":"issue",type:t.form.errors.has("issue")?"is-danger":null,message:t.form.errors.has("issue")?t.form.errors.first("issue"):null}},[n("b-input",{attrs:{id:"issue",name:"issue",expanded:""},model:{value:t.form.issue,callback:function(e){t.$set(t.form,"issue",e)},expression:"form.issue"}})],1):t._e(),t._v(" "),t.typeHasPlace?n("b-field",{class:{"is-required":t.typeRequiresPlace},attrs:{label:t.trans("labels.publications.place"),"label-for":"place",type:t.form.errors.has("place")?"is-danger":null,message:t.form.errors.has("place")?t.form.errors.first("place"):null}},[n("b-input",{attrs:{id:"place",name:"place",expanded:""},model:{value:t.form.place,callback:function(e){t.$set(t.form,"place",e)},expression:"form.place"}})],1):t._e(),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.publications.page_count"),"label-for":"page_count",type:t.form.errors.has("page_count")?"is-danger":null,message:t.form.errors.has("page_count")?t.form.errors.first("page_count"):null}},[n("b-input",{attrs:{id:"page_count",name:"page_count",expanded:""},model:{value:t.form.page_count,callback:function(e){t.$set(t.form,"page_count",e)},expression:"form.page_count"}})],1),t._v(" "),t.typeHasPageRange?n("b-field",{attrs:{label:t.trans("labels.publications.page_range"),"label-for":"page_range",type:t.form.errors.has("page_range")?"is-danger":null,message:t.form.errors.has("page_range")?t.form.errors.first("page_range"):null}},[n("b-input",{attrs:{id:"page_range",name:"page_range",expanded:""},model:{value:t.form.page_range,callback:function(e){t.$set(t.form,"page_range",e)},expression:"form.page_range"}})],1):t._e(),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.publications.doi"),"label-for":"doi",type:t.form.errors.has("doi")?"is-danger":null,message:t.form.errors.has("doi")?t.form.errors.first("doi"):null}},[n("b-input",{attrs:{id:"doi",name:"doi",expanded:""},model:{value:t.form.doi,callback:function(e){t.$set(t.form,"doi",e)},expression:"form.doi"}})],1),t._v(" "),n("b-field",{attrs:{"label-for":"citation",type:t.form.errors.has("citation")?"is-danger":null,message:t.form.errors.has("citation")?t.form.errors.first("citation"):null}},[n("label",{staticClass:"label",attrs:{slot:"label",for:"citation"},slot:"label"},[n("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.trans("labels.publications.citation_tooltip")},expression:"{content: trans('labels.publications.citation_tooltip')}"}],staticClass:"is-dashed"},[t._v("\n            "+t._s(t.trans("labels.publications.citation"))+"\n          ")])]),t._v(" "),n("b-input",{attrs:{id:"citation",type:"textarea",name:"citation",expanded:""},model:{value:t.form.citation,callback:function(e){t.$set(t.form,"citation",e)},expression:"form.citation"}})],1)],1),t._v(" "),n("div",{staticClass:"column"},[n("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.publications.authors"),type:t.form.errors.has("authors")?"is-danger":null,message:t.form.errors.has("authors")?t.form.errors.first("authors"):null,addons:!1}},[t._l(t.form.authors,function(e,a){return n("b-field",{key:a,attrs:{type:t.authorHasError(a)?"is-danger":null,message:t.authorHasError(a)?t.getAuthorError(a):null,expanded:"",addons:!1}},[n("b-field",{attrs:{type:t.authorHasError(a)?"is-danger":null,expanded:""}},[n("b-input",{attrs:{name:"authors["+a+"][first_name]",placeholder:t.trans("labels.publications.first_name"),expanded:""},model:{value:t.form.authors[a].first_name,callback:function(e){t.$set(t.form.authors[a],"first_name",e)},expression:"form.authors[i].first_name"}}),t._v(" "),n("b-input",{attrs:{name:"authors["+a+"][last_name]",placeholder:t.trans("labels.publications.last_name"),expanded:""},model:{value:t.form.authors[a].last_name,callback:function(e){t.$set(t.form.authors[a],"last_name",e)},expression:"form.authors[i].last_name"}}),t._v(" "),n("p",{staticClass:"control"},[n("button",{staticClass:"button is-danger is-outlined",attrs:{type:"button"},on:{click:function(e){return t.removeAuthor(a)}}},[n("b-icon",{attrs:{icon:"times",size:"is-small"}})],1)])],1)],1)}),t._v(" "),n("button",{staticClass:"button is-secondary is-outlined",attrs:{type:"button"},on:{click:t.addAuthor}},[t._v("\n          "+t._s(t.trans("labels.publications.add_author"))+"\n        ")])],2),t._v(" "),t.typeHasEditors?n("b-field",{class:{"is-required":t.typeRequiresEditors},attrs:{label:t.trans("labels.publications.editors"),type:t.form.errors.has("editors")?"is-danger":null,message:t.form.errors.has("editors")?t.form.errors.first("editors"):null,addons:!1}},[t._l(t.form.editors,function(e,a){return n("b-field",{key:a,attrs:{type:t.editorHasError(a)?"is-danger":null,message:t.editorHasError(a)?t.getEditorError(a):null,expanded:"",addons:!1}},[n("b-field",{attrs:{type:t.editorHasError(a)?"is-danger":null,expanded:""}},[n("b-input",{attrs:{name:"editors["+a+"][first_name]",placeholder:t.trans("labels.publications.first_name"),expanded:""},model:{value:t.form.editors[a].first_name,callback:function(e){t.$set(t.form.editors[a],"first_name",e)},expression:"form.editors[i].first_name"}}),t._v(" "),n("b-input",{attrs:{name:"editors["+a+"][last_name]",placeholder:t.trans("labels.publications.last_name"),expanded:""},model:{value:t.form.editors[a].last_name,callback:function(e){t.$set(t.form.editors[a],"last_name",e)},expression:"form.editors[i].last_name"}}),t._v(" "),n("p",{staticClass:"control"},[n("button",{staticClass:"button is-danger is-outlined",attrs:{type:"button"},on:{click:function(e){return t.removeEditor(a)}}},[n("b-icon",{attrs:{icon:"times",size:"is-small"}})],1)])],1)],1)}),t._v(" "),n("button",{staticClass:"button is-secondary is-outlined",attrs:{type:"button"},on:{click:t.addEditor}},[t._v("\n          "+t._s(t.trans("labels.publications.add_editor"))+"\n        ")])],2):t._e(),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.publications.link"),type:t.form.errors.has("link")?"is-danger":null,message:t.form.errors.has("link")?t.form.errors.first("link"):null}},[n("b-input",{attrs:{name:"link",expanded:""},model:{value:t.form.link,callback:function(e){t.$set(t.form,"link",e)},expression:"form.link"}})],1),t._v(" "),n("b-field",{attrs:{label:t.trans("labels.publications.attachment")}},[n("nz-publication-attachment-upload",{attrs:{"attachment-name":t.form.attachment?t.form.attachment.original_name:null},on:{uploaded:t.handleAttachmentUploaded,removed:t.handleRemovedAttachment}})],1)],1)]),t._v(" "),n("hr"),t._v(" "),n("button",{staticClass:"button is-primary",attrs:{type:"submit"}},[t._v(t._s(t.trans("buttons.save")))]),t._v(" "),n("a",{staticClass:"button",attrs:{href:t.cancelUrl}},[t._v(t._s(t.trans("buttons.cancel")))])])},[],!1,null,null,null).exports,We={name:"nzActivityFieldObservationApproved",props:{activity:{type:Object,required:!0}}},Ye=Object(p.a)(We,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"activity-log-item"},[t._v("\n  "+t._s(t._f("formatDateTime")(t.activity.created_at))+" "+t._s(t.activity.causer.full_name)+" "+t._s(t.trans("activityLog.approved"))+"\n")])},[],!1,null,null,null).exports,He={name:"nzActivityFieldObservationCreated",props:{activity:{type:Object,required:!0}}},qe=Object(p.a)(He,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"activity-log-item"},[t._v("\n  "+t._s(t._f("formatDateTime")(t.activity.created_at))+" "+t._s(t.activity.causer.full_name)+" "+t._s(t.trans("activityLog.added_record"))+" "+t._s(t.activity.subject_id)+"\n")])},[],!1,null,null,null).exports,Be={name:"nzActivityFieldObservationMarkedUnidentifiable",props:{activity:{type:Object,required:!0}}},Ve=Object(p.a)(Be,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"activity-log-item"},[t._v("\n  "+t._s(t._f("formatDateTime")(t.activity.created_at))+" "+t._s(t.activity.causer.full_name)+" "+t._s(t.trans("activityLog.marked_unidentifiable"))+": "+t._s(t.activity.properties.reason)+"\n")])},[],!1,null,null,null).exports,Ke={name:"nzActivityFieldObservationMovedToPending",props:{activity:{type:Object,required:!0}}},Ze=Object(p.a)(Ke,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"activity-log-item"},[t._v("\n  "+t._s(t._f("formatDateTime")(t.activity.created_at))+" "+t._s(t.activity.causer.full_name)+" "+t._s(t.trans("activityLog.moved_to_pending"))+": "+t._s(t.activity.properties.reason)+"\n")])},[],!1,null,null,null).exports;function Xe(t){return(Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Ge,Je={name:"nzActivityFieldObservationUpdated",props:{activity:{type:Object,required:!0}},computed:{formatedChanges:function(){var t=this,e=this.activity.properties.old;return Object.keys(e).map(function(n){var a=t.oldValue(e,n);return"".concat(t.trans("labels.field_observations."+n))+(a?" (".concat(a,")"):"")}).join(", ")}},methods:{oldValue:function(t,e){var n=t[e];return null==n?null:"object"===Xe(n)?n.label?this.trans(n.label):null:n}}},Qe=Object(p.a)(Je,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"activity-log-item"},[t._v("\n  "+t._s(t._f("formatDateTime")(t.activity.created_at))+" "+t._s(t.activity.causer.full_name)+" "+t._s(t.trans("activityLog.changed"))+" "+t._s(t.formatedChanges)+": "+t._s(t.activity.properties.reason)+"\n")])},[],!1,null,null,null).exports;function tn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var en={name:"nzFieldObservationActivityLog",components:(Ge={},tn(Ge,Ye.name,Ye),tn(Ge,qe.name,qe),tn(Ge,Ve.name,Ve),tn(Ge,Ze.name,Ze),tn(Ge,Qe.name,Qe),Ge),props:{activities:{type:Array,default:function(){return[]}}},methods:{chooseActivityComponent:function(t){return"nz-activity-field-observation-".concat(t.description.split("_").join("-"))}}},nn=Object(p.a)(en,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"activity-log"},t._l(t.activities,function(e){return n(t.chooseActivityComponent(e),{key:e.id,tag:"component",attrs:{activity:e}})}),1)},[],!1,null,null,null).exports,an={name:"nzActivityLiteratureObservationCreated",props:{activity:{type:Object,required:!0}}},sn=Object(p.a)(an,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"activity-log-item"},[t._v("\n  "+t._s(t._f("formatDateTime")(t.activity.created_at))+" "+t._s(t.activity.causer.full_name)+" "+t._s(t.trans("activityLog.added_record"))+" "+t._s(t.activity.subject_id)+"\n")])},[],!1,null,null,null).exports;function on(t){return(on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var rn,ln={name:"nzActivityLiteratureObservationUpdated",props:{activity:{type:Object,required:!0}},computed:{formatedChanges:function(){var t=this,e=this.activity.properties.old;return Object.keys(e).map(function(n){var a=t.oldValue(e,n);return"".concat(t.trans("labels.literature_observations."+n))+(a?" (".concat(a,")"):"")}).join(", ")}},methods:{oldValue:function(t,e){var n=t[e];return null==n?null:"object"===on(n)?n.label?this.trans(n.label):null:n}}},cn=Object(p.a)(ln,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"activity-log-item"},[t._v("\n  "+t._s(t._f("formatDateTime")(t.activity.created_at))+" "+t._s(t.activity.causer.full_name)+" "+t._s(t.trans("activityLog.changed"))+" "+t._s(t.formatedChanges)+": "+t._s(t.activity.properties.reason)+"\n")])},[],!1,null,null,null).exports;function un(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var dn={name:"nzLiteratureObservationActivityLog",components:(rn={},un(rn,sn.name,sn),un(rn,cn.name,cn),rn),props:{activities:{type:Array,default:function(){return[]}}},methods:{chooseActivityComponent:function(t){return"nz-activity-literature-observation-".concat(t.description.split("_").join("-"))}}},fn=Object(p.a)(dn,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"activity-log"},t._l(t.activities,function(e){return n(t.chooseActivityComponent(e),{key:e.id,tag:"component",attrs:{activity:e}})}),1)},[],!1,null,null,null).exports,mn={name:"nzActivityTaxonCreated",props:{activity:{type:Object,required:!0}}},hn=Object(p.a)(mn,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"activity-log-item"},[t._v("\n  "+t._s(t._f("formatDateTime")(t.activity.created_at))+" "+t._s(t.activity.causer.full_name)+" "+t._s(t.trans("activityLog.added_record"))+" "+t._s(t.activity.subject_id)+"\n")])},[],!1,null,null,null).exports;function pn(t){return(pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var bn,vn={name:"nzActivityTaxonUpdated",props:{activity:{type:Object,required:!0}},computed:{formatedChanges:function(){var t=this,e=this.activity.properties.old;return Object.keys(e).map(function(n){var a=t.oldValue(e,n);return"".concat(t.trans("labels.taxa."+n))+(a?" (".concat(a,")"):"")}).join(", ")}},methods:{oldValue:function(t,e){var n=t[e];return null==n?null:"object"===pn(n)?n.label?this.trans(n.label):null:n}}},gn=Object(p.a)(vn,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"activity-log-item"},[t._v("\n  "+t._s(t._f("formatDateTime")(t.activity.created_at))+" "+t._s(t.activity.causer.full_name)+" "+t._s(t.trans("activityLog.changed"))+" "+t._s(t.formatedChanges)+": "+t._s(t.activity.properties.reason)+"\n")])},[],!1,null,null,null).exports;function _n(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var yn={name:"nzTaxonActivityLog",components:(bn={},_n(bn,hn.name,hn),_n(bn,gn.name,gn),bn),props:{activities:{type:Array,default:function(){return[]}}},methods:{chooseActivityComponent:function(t){return"nz-activity-taxon-".concat(t.description.replace("_","-"))}}},xn=Object(p.a)(yn,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"activity-log"},t._l(t.activities,function(e){return n(t.chooseActivityComponent(e),{key:e.id,tag:"component",attrs:{activity:e}})}),1)},[],!1,null,null,null).exports;function Cn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var kn={name:"nzCustomExport",props:{checked:{type:Array,default:function(){return[]}},filter:{type:Object,default:function(){return{}}},columns:{type:[Array,Object],required:!0},url:{type:String,required:!0}},data:function(){return{onlyChecked:!1,applyFilters:!0,processing:!1,currentExport:null,selectedColumns:[],withHeader:!1,form:new le.a}},computed:{filters:function(){var t={};return this.applyFilters&&(t=Object.assign(t,this.filter)),this.onlyChecked&&(t.id=this.checked),t},exportStatus:function(){return _.get(this.currentExport,"status")},exportFinished:function(){return"finished"===this.exportStatus},exportFailed:function(){return"failed"===this.exportStatus}},methods:{sendExportRequest:function(){var t=this;this.processing||(this.processing=!0,this.form.withData(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){Cn(t,e,n[e])})}return t}({},this.filters,{columns:this.selectedColumns,with_header:this.withHeader})).post(this.url).then(function(e){t.startCheckingStatus(e)}).catch(function(e){t.processing=!1}))},startCheckingStatus:function(t){var e=this;this.currentExport=t,this.checkInterval=setInterval(function(){e.checkExportStatus()},2e3)},checkExportStatus:function(){var t=this;axios.get("/api/exports/".concat(this.currentExport.id)).then(function(e){var n=e.data;t.currentExport=n,(t.exportFailed||t.exportFinished)&&(clearInterval(t.checkInterval),t.processing=!1,t.$emit("done",t.currentExport))})}}},wn=Object(p.a)(kn,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-card"},[n("div",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[t._v(t._s(t.trans("labels.exports.title")))])]),t._v(" "),n("div",{staticClass:"modal-card-body"},[t.processing?[t._v("\n      "+t._s(t.trans("labels.exports.processing"))+"\n\n      "),n("span",{staticClass:"loader mr-2 is-inline-block"})]:[n("b-field",[n("b-checkbox",{model:{value:t.onlyChecked,callback:function(e){t.onlyChecked=e},expression:"onlyChecked"}},[t._v(t._s(t.trans("labels.exports.only_checked")))])],1),t._v(" "),n("b-field",[n("b-checkbox",{model:{value:t.applyFilters,callback:function(e){t.applyFilters=e},expression:"applyFilters"}},[t._v(t._s(t.trans("labels.exports.apply_filters")))])],1),t._v(" "),n("b-field",{attrs:{type:t.form.errors.has("with_header")?"is-danger":null,message:t.form.errors.first("with_header")}},[n("b-checkbox",{model:{value:t.withHeader,callback:function(e){t.withHeader=e},expression:"withHeader"}},[t._v(t._s(t.trans("labels.exports.with_header")))])],1),t._v(" "),n("div",{staticClass:"field"},[t.form.errors.has("columns")?n("p",{staticClass:"help is-danger"},[t._v(t._s(t.form.errors.first("columns")))]):t._e(),t._v(" "),n("nz-columns-picker",{attrs:{columns:t.columns,title:t.trans("labels.exports.columns")},model:{value:t.selectedColumns,callback:function(e){t.selectedColumns=e},expression:"selectedColumns"}})],1)]],2),t._v(" "),t.processing?t._e():n("div",{staticClass:"modal-card-foot"},[n("button",{staticClass:"button is-primary",attrs:{type:"button"},on:{click:t.sendExportRequest}},[t._v(t._s(t.trans("buttons.export")))]),t._v(" "),n("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){return t.$emit("cancel")}}},[t._v(t._s(t.trans("buttons.cancel")))])])])},[],!1,null,null,null).exports;function Sn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var An={name:"nzExportModal",props:{checked:{type:Array,default:function(){return[]}},filter:{type:Object,default:function(){return{}}},columns:{type:[Array,Object],required:!0},url:{type:String,required:!0},types:{type:Array,default:function(){return["custom","darwin_core"]},validator:function(t){return t.length>0}}},data:function(){return{onlyChecked:!1,applyFilters:!0,processing:!1,currentExport:null,selectedColumns:[],withHeader:!1,type:this.types[0],form:new le.a}},computed:{filters:function(){var t={};return this.applyFilters&&(t=Object.assign(t,this.filter)),this.onlyChecked&&(t.id=this.checked),t},exportStatus:function(){return _.get(this.currentExport,"status")},exportFinished:function(){return"finished"===this.exportStatus},exportFailed:function(){return"failed"===this.exportStatus},isCustom:function(){return"custom"===this.type}},methods:{sendExportRequest:function(){var t=this;this.processing||(this.processing=!0,this.form.withData(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){Sn(t,e,n[e])})}return t}({},this.filters,{columns:this.selectedColumns,with_header:this.withHeader,type:this.type})).post(this.url).then(function(e){t.startCheckingStatus(e)}).catch(function(e){t.processing=!1}))},startCheckingStatus:function(t){var e=this;this.currentExport=t,this.checkInterval=setInterval(function(){e.checkExportStatus()},2e3)},checkExportStatus:function(){var t=this;axios.get("/api/exports/".concat(this.currentExport.id)).then(function(e){var n=e.data;t.currentExport=n,(t.exportFailed||t.exportFinished)&&(clearInterval(t.checkInterval),t.processing=!1,t.$emit("done",t.currentExport))})}}},On=Object(p.a)(An,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-card"},[n("div",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[t._v(t._s(t.trans("labels.exports.title")))])]),t._v(" "),n("div",{staticClass:"modal-card-body"},[t.processing?[t._v("\n      "+t._s(t.trans("labels.exports.processing"))+"\n\n      "),n("span",{staticClass:"loader mr-2 is-inline-block"})]:[t.types.length>1?n("b-field",{attrs:{type:t.form.errors.has("type")?"is-danger":null,message:t.form.errors.first("type")}},t._l(t.types,function(e){return n("b-radio",{key:e,attrs:{"native-value":e},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("\n          "+t._s(t.trans("labels.exports.types."+e))+"\n        ")])}),1):t._e(),t._v(" "),n("b-field",[n("b-checkbox",{model:{value:t.onlyChecked,callback:function(e){t.onlyChecked=e},expression:"onlyChecked"}},[t._v(t._s(t.trans("labels.exports.only_checked")))])],1),t._v(" "),n("b-field",[n("b-checkbox",{model:{value:t.applyFilters,callback:function(e){t.applyFilters=e},expression:"applyFilters"}},[t._v(t._s(t.trans("labels.exports.apply_filters")))])],1),t._v(" "),t.isCustom?[n("b-field",{attrs:{type:t.form.errors.has("with_header")?"is-danger":null,message:t.form.errors.first("with_header")}},[n("b-checkbox",{model:{value:t.withHeader,callback:function(e){t.withHeader=e},expression:"withHeader"}},[t._v(t._s(t.trans("labels.exports.with_header")))])],1),t._v(" "),n("div",{staticClass:"field"},[t.form.errors.has("columns")?n("p",{staticClass:"help is-danger"},[t._v(t._s(t.form.errors.first("columns")))]):t._e(),t._v(" "),n("nz-columns-picker",{attrs:{columns:t.columns,title:t.trans("labels.exports.columns")},model:{value:t.selectedColumns,callback:function(e){t.selectedColumns=e},expression:"selectedColumns"}})],1)]:t._e()]],2),t._v(" "),t.processing?t._e():n("div",{staticClass:"modal-card-foot"},[n("button",{staticClass:"button is-primary",attrs:{type:"button"},on:{click:t.sendExportRequest}},[t._v(t._s(t.trans("buttons.export")))]),t._v(" "),n("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){return t.$emit("cancel")}}},[t._v(t._s(t.trans("buttons.cancel")))])])])},[],!1,null,null,null).exports,Dn={name:"nzFieldObservationsImport",props:{columns:{type:Array,default:function(){return[]}},initial:{type:Array,default:function(){return[]}},runningImport:Object,cancellableStatuses:{type:Array,default:function(){return[]}},canSubmitForUser:Boolean},data:function(){return{selectedColumns:this.initial,showColumnsSelection:!1,file:null,importing:!1,currentImport:this.runningImport,validationErrors:[],currentErrorsPage:1,submissionErrors:null,hasHeading:!1,showSuccessMessage:!1,cancelling:!1,userId:null,user:null}},computed:{canSubmit:function(){return!this.importing&&this.file},validationFailed:function(){return"validation_failed"===_.get(this.currentImport,"status")},saved:function(){return"saved"===_.get(this.currentImport,"status")},savingFailed:function(){return"saving_failed"===_.get(this.currentImport,"status")},cancelled:function(){return"cancelled"===_.get(this.currentImport,"status")},importStatus:function(){var t=_.get(this.currentImport,"status");return this.trans("imports.status.".concat(t))},cancellable:function(){return this.currentImport&&this.cancellableStatuses.includes(this.currentImport.status)&&!this.cancelling},userFullName:function(){return window.App.User.full_name}},created:function(){this.currentImport&&!this.saved&&(this.importing=!0,this.startCheckingStatus())},methods:{toggleColumns:function(){this.showColumnsSelection=!this.showColumnsSelection},submit:function(){this.canSubmit&&(this.resetForm(),this.importing=!0,this.currentImport=null,axios.post("/api/field-observation-imports",this.makeForm()).then(this.handleSuccessfulSubmit).catch(this.handleFailedSubmit))},makeForm:function(){var t=new FormData;return t.append("file",this.file),this.selectedColumns.forEach(function(e){t.append("columns[]",e)}),this.hasHeading&&t.append("has_heading",1),t.append("user_id",this.userId||""),t},resetForm:function(){this.validationErrors=[],this.currentErrorsPage=1,this.showColumnsSelection=!1,this.submissionErrors=null},handleSuccessfulSubmit:function(t){var e=t.data;this.currentImport=e,this.file=null,this.startCheckingStatus()},handleFailedSubmit:function(t){this.importing=!1,this.submissionErrors=_.get(t,"response.data.errors",[]),this.$toast.open({duration:2500,message:_.get(t,"response.data.message"),type:"is-danger"})},startCheckingStatus:function(){var t=this;this.interval=setInterval(function(){t.checkStatus()},2500)},checkStatus:function(){var t=this;return axios.get("/api/field-observation-imports/".concat(this.currentImport.id)).then(function(e){var n=e.data;return t.currentImport=n,t.validationFailed?t.handleFailedValidation():t.savingFailed?t.handleFailedSaving():t.cancelled?t.stopCheckingImport():void(t.saved&&t.handleStored())})},showValiadtionErrors:function(){var t=this;return axios.get(this.currentImport.errors_url).then(function(e){var n=e.data;t.validationErrors=n})},handleFailedValidation:function(){this.$toast.open({duration:2500,message:this.trans("imports.validation_failed"),type:"is-danger"}),this.showColumnsSelection=!1,this.showValiadtionErrors(),this.stopCheckingImport()},handleFailedSaving:function(){this.$toast.open({duration:2500,message:this.trans("imports.saving_failed"),type:"is-danger"}),this.showColumnsSelection=!1,this.stopCheckingImport()},handleStored:function(){this.showSuccessMessage=!0,this.stopCheckingImport()},cancel:function(){var t=this;this.cancellable&&(this.cancelling=!0,axios.post("/api/cancelled-imports",{import_id:this.currentImport.id}).then(function(){t.cancelling=!1,t.stopCheckingImport()}).catch(function(){t.cancelling=!1}))},stopCheckingImport:function(){clearInterval(this.interval),this.importing=!1,this.currentImport=null},setUserId:function(t){this.userId=t?t.id:null}}},Pn=(n("jd2M"),Object(p.a)(Dn,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"field-observations-import"},[t.importing?n("div",{staticClass:"is-flex is-flex-center flex-col"},[n("div",{staticClass:"is-flex is-flex-center"},[n("span",{staticClass:"loader mr-2"}),t._v(" "),t.currentImport?n("span",{staticClass:"has-loader"},[t._v(t._s(t.importStatus))]):t._e()]),t._v(" "),t.cancellable?n("button",{staticClass:"button is-text has-text-danger",attrs:{type:"button"},on:{click:t.cancel}},[t._v(t._s(t.trans("buttons.cancel")))]):t._e()]):n("div",[n("b-notification",{attrs:{type:"is-success",active:t.showSuccessMessage},on:{"update:active":function(e){t.showSuccessMessage=e}}},[t._v("\n      "+t._s(t.trans("imports.success"))+"\n    ")]),t._v(" "),t.canSubmitForUser?n("nz-user-autocomplete",{attrs:{label:t.trans("labels.imports.user"),placeholder:t.userFullName},on:{select:t.setUserId},model:{value:t.user,callback:function(e){t.user=e},expression:"user"}}):t._e(),t._v(" "),n("div",{staticClass:"level mb-4"},[n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item"},[n("div",{staticClass:"buttons"},[t.importing?t._e():n("button",{staticClass:"button is-outlined",class:[t.showColumnsSelection?"is-primary":""],attrs:{type:"button"},on:{click:t.toggleColumns}},[t._v(t._s(t.trans("labels.imports.choose_columns")))])])]),t._v(" "),n("div",{staticClass:"level-item"},[n("b-checkbox",{model:{value:t.hasHeading,callback:function(e){t.hasHeading=e},expression:"hasHeading"}},[t._v(t._s(t.trans("labels.imports.has_heading")))])],1),t._v(" "),n("div",{staticClass:"level-item"},[t.importing?t._e():n("b-field",{staticClass:"file"},[n("b-upload",{attrs:{accept:".csv"},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}},[n("a",{staticClass:"button"},[n("span",[t._v(t._s(t.trans("labels.imports.select_csv_file")))])])]),t._v(" "),t.file?n("span",{staticClass:"file-name"},[t._v(t._s(t.file.name))]):t._e()],1)],1)]),t._v(" "),n("div",{staticClass:"level-right"},[n("div",{staticClass:"level-item"},[n("button",{staticClass:"button is-primary is-outlined",attrs:{type:"button",disabled:!t.canSubmit},on:{click:t.submit}},[n("b-icon",{attrs:{icon:"upload"}}),t._v(" "),n("span",[t._v(t._s(t.trans("labels.imports.import")))])],1)])])])],1),t._v(" "),n("b-collapse",{attrs:{open:t.showColumnsSelection}},[n("nz-columns-picker",{attrs:{columns:t.columns,title:t.trans("labels.imports.columns")},model:{value:t.selectedColumns,callback:function(e){t.selectedColumns=e},expression:"selectedColumns"}})],1),t._v(" "),t.validationErrors.length?n("b-table",{staticClass:"is-danger",attrs:{data:t.validationErrors,paginated:!0,"per-page":30,"current-page":t.currentErrorsPage},on:{"update:currentPage":function(e){t.currentErrorsPage=e},"update:current-page":function(e){t.currentErrorsPage=e}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-table-column",{attrs:{field:"row",label:t.trans("labels.imports.row_number")}},[t._v("\n            "+t._s(e.row.row)+"\n        ")]),t._v(" "),n("b-table-column",{attrs:{field:"error",label:t.trans("labels.imports.error")}},[t._v("\n            "+t._s(e.row.error)+"\n        ")])]}}],null,!1,2183879962)}):t._e()],1)},[],!1,null,"3dcf0c02",null).exports),jn={name:"nzFieldObservationApproval",props:{approveUrl:String,markAsUnidentifiableUrl:String,redirectUrl:{type:String,required:!0},fieldObservation:{type:Object,required:!0}},data:function(){return{approving:!1,markingAsUnidentifiable:!1}},computed:{busy:function(){return this.approving||this.markingAsUnidentifiable}},methods:{confirmApprove:function(){this.$dialog.confirm({message:this.trans("You are about to approve this field observation"),confirmText:this.trans("buttons.approve"),cancelText:this.trans("buttons.cancel"),type:"is-primary",onConfirm:this.approve.bind(this)})},approve:function(){this.approving=!0,axios.post(this.approveUrl,{field_observation_ids:[this.fieldObservation.id]}).then(this.successfullyApproved).catch(this.failedToApprove)},successfullyApproved:function(){var t=this;this.$toast.open({message:this.trans("Observation has been approved"),type:"is-success"}),setTimeout(function(){t.approving=!1,window.location.href=t.redirectUrl},1e3)},failedToApprove:function(t){this.approving=!1,this.$toast.open({message:this.trans("Observation cannot be approved"),type:"is-danger",duration:5e3})},confirmMarkingAsUnidentifiable:function(){var t=this,e=this.$dialog.prompt({message:this.trans("You are about to mark observation as unidentifiable. What's the reason?"),confirmText:this.trans("buttons.mark_unidentifiable"),cancelText:this.trans("buttons.cancel"),type:"is-warning",inputAttrs:{placeholder:this.trans("Reason"),required:!0,maxlength:255},onConfirm:this.markAsUnidentifiable.bind(this)});e.$nextTick(function(){t.validateReason(e)})},markAsUnidentifiable:function(t){this.markingAsUnidentifiable=!0,axios.post(this.markAsUnidentifiableUrl,{field_observation_ids:[this.fieldObservation.id],reason:t}).then(this.successfullyMarkedAsUnidentifiable).catch(this.failedToMarkAsUnidentifiable)},successfullyMarkedAsUnidentifiable:function(){var t=this;this.$toast.open({message:this.trans("Observation has been marked as unidentifiable"),type:"is-success"}),setTimeout(function(){t.markingAsUnidentifiable=!1,window.location.href=t.redirectUrl},1e3)},failedToMarkAsUnidentifiable:function(t){this.markingAsUnidentifiable=!1,this.$toast.open({message:this.trans("This observation cannot be marked as unidentifiable"),type:"is-danger",duration:5e3})},validateReason:function(t){var e=this;t.$refs.input.addEventListener("invalid",function(t){t.target.setCustomValidity(""),t.target.validity.valid||t.target.setCustomValidity(e.trans("This field is required and can contain max 255 chars."))}),t.$refs.input.addEventListener("input",function(e){t.validationMessage=null})}}},In=Object(p.a)(jn,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"level-right"},[t.approveUrl?n("div",{staticClass:"level-item"},[n("button",{staticClass:"button",class:{"is-loading":t.approving},attrs:{type:"button",disabled:t.busy},on:{click:t.confirmApprove}},[n("b-icon",{staticClass:"has-text-success",attrs:{icon:"check"}}),t._v(" "),n("span",[t._v(t._s(t.trans("buttons.approve")))])],1)]):t._e(),t._v(" "),t.markAsUnidentifiableUrl?n("div",{staticClass:"level-item"},[n("button",{staticClass:"button",class:{"is-loading":t.markingAsUnidentifiable},attrs:{type:"button",disabled:t.busy},on:{click:t.confirmMarkingAsUnidentifiable}},[n("b-icon",{staticClass:"has-text-danger",attrs:{icon:"times"}}),t._v(" "),n("span",[t._v(t._s(t.trans("buttons.unidentifiable")))])],1)]):t._e()])},[],!1,null,null,null).exports,Tn={egg:"white",larva:"green",pupa:"yellow",juvenile:"orange",adult:"red"},Rn=Object.keys(Tn),$n={name:"nzOccurrenceChart",props:{elevationLabel:{type:String,default:"Elevation"},monthsLabel:{type:String,default:"Months"},availableStages:{type:Array,default:function(){return[]}},data:{type:Array,required:!0}},data:function(){return{visibleStages:Rn}},computed:{allStages:function(){var t=this;return Rn.filter(function(e){return t.availableStages.includes(e)})},currentDateLineX:function(){return this.xForDate(moment())-1},filteredData:function(){var t=this;return this.data.filter(function(e){return t.visibleStages.includes(e.stage)&&null!==e.elevation})},sortedData:function(){this.stageOrder;return _.sortBy(this.filteredData,function(t){return t.date})},maxElevation:function(){var t=_.maxBy(this.data,function(t){return t.elevation});return t?t.elevation:1e3},minElevation:function(){var t=_.minBy(this.data,function(t){return t.elevation});return t?t.elevation:0},topElevationValue:function(){return 1e3*parseInt(Math.ceil(this.maxElevation/1e3))},bottomElevationValue:function(){var t=this.topElevationValue/4;return this.minElevation>=0?0:parseInt(Math.floor(this.minElevation/t))*t},preparedPoints:function(){var t=this;return this.sortedData.map(function(e){return{x:t.xForDate(e.date),y:t.yForElevation(e.elevation),color:Tn[e.stage]}})},yForZeroElevation:function(){return this.yForElevation(0)},negativeElevations:function(){var t=this.bottomElevationValue;if(0===t)return[];for(var e=this.topElevationValue/4,n=Math.abs(t/e),a=[],i=0;i<=n;i++){var s=(i+1)*-e;a.push({value:s,y:this.yForElevation(s)})}return a},positiveElevations:function(){for(var t=this.topElevationValue,e=[],n=0;n<4;n++){var a=parseInt(t*(n+1)/4);e.push({value:a,y:this.yForElevation(a)})}return e}},methods:{progressInYear:function(t){var e=moment(t);return parseInt(e.format("DDD"))/(e.isLeapYear()?366:365)},xForDate:function(t){return 730*this.progressInYear(moment(t))+70},yForElevation:function(t){var e=this.topElevationValue,n=this.bottomElevationValue;return 529-499*t/(e-n)+499*n/(e-n)},optionColor:function(t){return{height:"1rem",width:"1rem",backgroundColor:Tn[t],borderRadius:"50%",display:"inline-block",border:"1px solid black"}}}},En=Object(p.a)($n,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 800 600"}},[n("g",[n("rect",{attrs:{x:"70",y:"30",width:"62",height:"500",fill:"#ffffff"}}),t._v(" "),n("text",{attrs:{x:"101",y:"560","font-size":"25",fill:"#000000","text-anchor":"middle"}},[t._v("I")]),t._v(" "),n("rect",{attrs:{x:"132",y:"30",width:"56",height:"500",fill:"#eeeeee"}}),t._v(" "),n("text",{attrs:{x:"160",y:"560","font-size":"25",fill:"#000000","text-anchor":"middle"}},[t._v("II")]),t._v(" "),n("rect",{attrs:{x:"188",y:"30",width:"62",height:"500",fill:"#ffffff"}}),t._v(" "),n("text",{attrs:{x:"219",y:"560","font-size":"25",fill:"#000000","text-anchor":"middle"}},[t._v("III")]),t._v(" "),n("rect",{attrs:{x:"250",y:"30",width:"60",height:"500",fill:"#eeeeee"}}),t._v(" "),n("text",{attrs:{x:"280",y:"560","font-size":"25",fill:"#000000","text-anchor":"middle"}},[t._v("IV")]),t._v(" "),n("rect",{attrs:{x:"310",y:"30",width:"62",height:"500",fill:"#ffffff"}}),t._v(" "),n("text",{attrs:{x:"341",y:"560","font-size":"25",fill:"#000000","text-anchor":"middle"}},[t._v("V")]),t._v(" "),n("rect",{attrs:{x:"372",y:"30",width:"60",height:"500",fill:"#eeeeee"}}),t._v(" "),n("text",{attrs:{x:"402",y:"560","font-size":"25",fill:"#000000","text-anchor":"middle"}},[t._v("VI")]),t._v(" "),n("rect",{attrs:{x:"432",y:"30",width:"62",height:"500",fill:"#ffffff"}}),t._v(" "),n("text",{attrs:{x:"463",y:"560","font-size":"25",fill:"#000000","text-anchor":"middle"}},[t._v("VII")]),t._v(" "),n("rect",{attrs:{x:"494",y:"30",width:"62",height:"500",fill:"#eeeeee"}}),t._v(" "),n("text",{attrs:{x:"525",y:"560","font-size":"25",fill:"#000000","text-anchor":"middle"}},[t._v("VIII")]),t._v(" "),n("rect",{attrs:{x:"556",y:"30",width:"60",height:"500",fill:"#ffffff"}}),t._v(" "),n("text",{attrs:{x:"586",y:"560","font-size":"25",fill:"#000000","text-anchor":"middle"}},[t._v("IX")]),t._v(" "),n("rect",{attrs:{x:"616",y:"30",width:"62",height:"500",fill:"#eeeeee"}}),t._v(" "),n("text",{attrs:{x:"647",y:"560","font-size":"25",fill:"#000000","text-anchor":"middle"}},[t._v("X")]),t._v(" "),n("rect",{attrs:{x:"678",y:"30",width:"60",height:"500",fill:"#ffffff"}}),t._v(" "),n("text",{attrs:{x:"708",y:"560","font-size":"25",fill:"#000000","text-anchor":"middle"}},[t._v("XI")]),t._v(" "),n("rect",{attrs:{x:"738",y:"30",width:"62",height:"500",fill:"#eeeeee"}}),t._v(" "),n("text",{attrs:{x:"769",y:"560","font-size":"25",fill:"#000000","text-anchor":"middle"}},[t._v("XII")]),t._v(" "),n("line",{attrs:{x1:"70",y1:"10",x2:"70",y2:"530","stroke-width":"2",stroke:"#222222"}}),t._v(" "),n("path",{attrs:{d:"M70 7 L65 15 L75 15 Z"}}),t._v(" "),n("text",{attrs:{x:"80",y:"25","font-size":"20",fill:"#000000"}},[t._v(t._s(t.elevationLabel)+" (m)")]),t._v(" "),n("text",{attrs:{x:"400",y:"590","font-size":"20",fill:"#000000","dominant-baseline":"middle","text-anchor":"middle"}},[t._v(t._s(t.monthsLabel))]),t._v(" "),t._l(t.negativeElevations,function(e,a){return[n("line",{attrs:{x1:"60",y1:e.y,x2:"800",y2:e.y,"stroke-width":"1",stroke:(a+1)%2?"#555555":"#222222"}}),t._v(" "),n("text",{attrs:{x:"55",y:e.y,"font-size":"20",fill:"#000000","dominant-baseline":"central","text-anchor":"end"}},[t._v(t._s(e.value))])]}),t._v(" "),n("line",{attrs:{x1:"60",y1:t.yForZeroElevation,x2:"800",y2:t.yForZeroElevation,"stroke-width":"2",stroke:"#222222"}}),t._v(" "),n("text",{attrs:{x:"55",y:t.yForZeroElevation,"font-size":"20",fill:"#000000","dominant-baseline":"central","text-anchor":"end"}},[t._v("0")]),t._v(" "),t._l(t.positiveElevations,function(e,a){return[n("line",{attrs:{x1:"60",y1:e.y,x2:"800",y2:e.y,"stroke-width":"1",stroke:(a+1)%2?"#555555":"#222222"}}),t._v(" "),n("text",{attrs:{x:"55",y:e.y,"font-size":"20",fill:"#000000","dominant-baseline":"central","text-anchor":"end"}},[t._v(t._s(e.value))])]})],2),t._v(" "),n("g",[t._l(t.preparedPoints,function(t){return[n("circle",{attrs:{cx:t.x,cy:t.y,r:"7",fill:t.color,"stroke-width":"1",stroke:"black"}})]})],2),t._v(" "),n("line",{attrs:{x1:t.currentDateLineX,y1:"30",x2:t.currentDateLineX,y2:"528","stroke-width":"1",stroke:"#00aa00"}})]),t._v(" "),n("div",{staticClass:"flex flex-col is-flex-center"},t._l(t.allStages,function(e){return n("div",{staticClass:"control"},[n("label",{staticClass:"checkbox"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.visibleStages,expression:"visibleStages"}],attrs:{type:"checkbox",name:"stages"},domProps:{value:e,checked:Array.isArray(t.visibleStages)?t._i(t.visibleStages,e)>-1:t.visibleStages},on:{change:function(n){var a=t.visibleStages,i=n.target,s=!!i.checked;if(Array.isArray(a)){var o=e,r=t._i(a,o);i.checked?r<0&&(t.visibleStages=a.concat([o])):r>-1&&(t.visibleStages=a.slice(0,r).concat(a.slice(r+1)))}else t.visibleStages=s}}}),t._v(" "+t._s(t.trans("stages."+e))+" "),n("span",{style:t.optionColor(e)})])])}),0)])},[],!1,null,null,null).exports,Fn={name:"nzDeleteAccounModal",props:{action:String,csrfToken:String}},Mn=Object(p.a)(Fn,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{staticClass:"modal-card",attrs:{action:t.action,method:"POST"}},[n("header",{staticClass:"modal-card-head"},[n("h3",{staticClass:"modal-card-title"},[t._v(t._s(t.trans("navigation.preferences.delete_account")))])]),t._v(" "),n("input",{attrs:{type:"hidden",name:"_token"},domProps:{value:t.csrfToken}}),t._v(" "),n("input",{attrs:{type:"hidden",name:"_method",value:"DELETE"}}),t._v(" "),n("section",{staticClass:"modal-card-body"},[n("p",[t._v(t._s(t.trans("This action is irreversible, once an account is deleted it cannot be restored.")))]),t._v(" "),n("p",[t._v(t._s(t.trans("Are you sure you want to delete your account?")))]),t._v(" "),n("b-field",{staticClass:"mt-8"},[n("b-checkbox",{attrs:{name:"delete_observations"}},[t._v(t._s(t.trans("labels.preferences.account.delete_observations")))])],1)],1),t._v(" "),n("footer",{staticClass:"modal-card-foot"},[n("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){return t.$parent.close()}}},[t._v(t._s(t.trans("buttons.cancel")))]),t._v(" "),n("button",{staticClass:"button is-danger",attrs:{type:"submit"}},[t._v(t._s(t.trans("labels.preferences.account.delete_account")))])])])},[],!1,null,null,null).exports,zn={name:"nzDeleteAccountButton",props:{action:String,csrfToken:String},methods:{openModal:function(){this.$modal.open({parent:this,component:Mn,hasModalCard:!0,props:{action:this.action,csrfToken:this.csrfToken}})}}},Ln=Object(p.a)(zn,function(){var t=this.$createElement;return(this._self._c||t)("button",{staticClass:"button is-danger",attrs:{type:"button"},on:{click:this.openModal}},[this._v("\n  "+this._s(this.trans("labels.preferences.account.delete_account"))+"\n")])},[],!1,null,null,null).exports;window.Vue=i.a,i.a.use(d.a,{attempt:1,loading:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCAzOCAzOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBzdHJva2U9IiMzNjM2MzYiPgogICAgPGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxIDEpIiBzdHJva2Utd2lkdGg9IjIiPgogICAgICAgICAgICA8Y2lyY2xlIHN0cm9rZS1vcGFjaXR5PSIuNSIgY3g9IjE4IiBjeT0iMTgiIHI9IjE4Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNiAxOGMwLTkuOTQtOC4wNi0xOC0xOC0xOCI+CiAgICAgICAgICAgICAgICA8YW5pbWF0ZVRyYW5zZm9ybQogICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIKICAgICAgICAgICAgICAgICAgICB0eXBlPSJyb3RhdGUiCiAgICAgICAgICAgICAgICAgICAgZnJvbT0iMCAxOCAxOCIKICAgICAgICAgICAgICAgICAgICB0bz0iMzYwIDE4IDE4IgogICAgICAgICAgICAgICAgICAgIGR1cj0iMXMiCiAgICAgICAgICAgICAgICAgICAgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiLz4KICAgICAgICAgICAgPC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+"}),i.a.use(o.a,{defaultIconPack:"fa"});var Nn,Un={};window.App&&window.App.gmaps&&window.App.gmaps.load&&(Un.load={key:window.App.gmaps.apiKey,libraries:"drawing",language:document.documentElement.lang}),i.a.use(r,Un),window.route&&(i.a.prototype.$ziggy=window.route),i.a.component(f.name,f),i.a.component(v.name,v),i.a.component(y.name,y),i.a.component(w.name,w),i.a.component(A.name,A),i.a.component(M.name,M),i.a.component(N.name,N),i.a.component(H.name,H),i.a.component(Ft.name,Ft),i.a.component(Yt.name,Yt),i.a.component(qt.name,qt),i.a.component(Zt.name,Zt),i.a.component(Gt.name,Gt),i.a.component(ae.name,ae),i.a.component(se.name,se),i.a.component(B.name,B),i.a.component(X.name,X),i.a.component(J.name,J),i.a.component(et.name,et),i.a.component(it.name,it),i.a.component(rt.name,rt),i.a.component(mt.name,mt),i.a.component(Ct.name,Ct),i.a.component(Tt.name,Tt),i.a.component(oe.name,oe),i.a.component(ke.name,ke),i.a.component(Oe.name,Oe),i.a.component(ge.name,ge),i.a.component(ue.name,ue),i.a.component(je.name,je),i.a.component($e.name,$e),i.a.component(Ue.name,Ue),i.a.component(nn.name,nn),i.a.component(fn.name,fn),i.a.component(xn.name,xn),i.a.component(wn.name,wn),i.a.component(On.name,On),i.a.component(Pn.name,Pn),i.a.component(In.name,In),i.a.component(En.name,En),i.a.component(Ln.name,Ln),i.a.prototype.trans=window.trans=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=window.App.i18n[t]||n||t;return _.eachRight(e,function(t,e){a=_.replace(a,":".concat(e),t)}),a},i.a.filter("formatDateTime",function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DD.MM.YYYY HH:mm";return t?(t=t.toString(),window.moment(t).format(e)):""}),(Nn=l.a).options=_.merge(Nn.options,c),i.a.directive("tooltip",l.a);new i.a({el:"#app"})},dI4A:function(t,e,n){var a=n("+9Wz");"string"==typeof a&&(a=[[t.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(a,i);a.locals&&(t.exports=a.locals)},iO7F:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,".buttons .field[data-v-3dcf0c02]{margin-bottom:0}.buttons .field.file[data-v-3dcf0c02]{margin-right:.5rem}.buttons .field .upload[data-v-3dcf0c02]:hover{cursor:pointer}.buttons .field .upload .button[data-v-3dcf0c02]{margin-right:0}",""])},jd2M:function(t,e,n){"use strict";var a=n("a3Es");n.n(a).a},pyCd:function(t,e){},uDn1:function(t,e,n){"use strict";var a=n("dI4A");n.n(a).a}},[[0,1,2]]]);
//# sourceMappingURL=app.js.map