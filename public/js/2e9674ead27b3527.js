(self.webpackChunk=self.webpackChunk||[]).push([[323],{9516:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(i=o.key,a=void 0,a=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}n.d(e,{Z:()=>i});const i=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"get",value:function(t){var e=JSON.parse(localStorage.getItem(t));return e?new Date(e.expires)<new Date?(localStorage.removeItem(t),null):e.value:null}},{key:"has",value:function(t){return null!==this.get(t)}},{key:"set",value:function(t,e,n){var r=(new Date).getTime(),o=new Date(r+6e4*n);localStorage.setItem(t,JSON.stringify({value:e,expires:o}))}},{key:"delete",value:function(t){this.get(t)&&localStorage.removeItem(t)}}])&&o(e.prototype,n),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}())},950:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r={data:function(){return{showFilter:!1,filter:this.filterDefaults(),newFilter:this.filterDefaults(),filterIsActive:!1}},methods:{filterDefaults:function(){return{}},clearFilter:function(){this.newFilter=this.filterDefaults(),this.applyFilter(!1)},applyFilter:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=!1;Object.keys(this.newFilter).forEach((function(e){t.filter[e]!==t.newFilter[e]&&(n=!0),t.filter[e]=t.newFilter[e]})),this.filterIsActive=e,n&&this.$emit("filter")}}}},5442:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(8718),o=n.n(r),i=n(9516);const a={props:{cacheKey:{default:null},cacheLifetime:{default:1440}},computed:{storageKey:function(){return this.cacheKey?"nz-table.".concat(this.cacheKey):"nz-table.".concat(window.location.host).concat(window.location.pathname)}},methods:{getPersistantKeys:function(){return["sortField","sortOrder","perPage"]},saveState:function(){i.Z.set(this.storageKey,o()(this.$data,this.getPersistantKeys()),this.cacheLifetime)},restoreState:function(){var t=this,e=i.Z.get(this.storageKey);null!=e&&(this.getPersistantKeys().forEach((function(n){void 0!==e[n]&&t.$set(t,n,e[n])})),this.saveState())}}}},1078:(t,e,n)=>{var r=n(2488),o=n(7285);t.exports=function t(e,n,i,a,s){var l=-1,c=e.length;for(i||(i=o),s||(s=[]);++l<c;){var u=e[l];n>0&&i(u)?n>1?t(u,n-1,i,a,s):r(s,u):a||(s[s.length]=u)}return s}},7786:(t,e,n)=>{var r=n(1811),o=n(327);t.exports=function(t,e){for(var n=0,i=(e=r(e,t)).length;null!=t&&n<i;)t=t[o(e[n++])];return n&&n==i?t:void 0}},13:t=>{t.exports=function(t,e){return null!=t&&e in Object(t)}},5970:(t,e,n)=>{var r=n(3012),o=n(9095);t.exports=function(t,e){return r(t,e,(function(e,n){return o(t,n)}))}},3012:(t,e,n)=>{var r=n(7786),o=n(611),i=n(1811);t.exports=function(t,e,n){for(var a=-1,s=e.length,l={};++a<s;){var c=e[a],u=r(t,c);n(u,c)&&o(l,i(c,t),u)}return l}},611:(t,e,n)=>{var r=n(4865),o=n(1811),i=n(5776),a=n(3218),s=n(327);t.exports=function(t,e,n,l){if(!a(t))return t;for(var c=-1,u=(e=o(e,t)).length,f=u-1,p=t;null!=p&&++c<u;){var d=s(e[c]),h=n;if("__proto__"===d||"constructor"===d||"prototype"===d)return t;if(c!=f){var v=p[d];void 0===(h=l?l(v,d,p):void 0)&&(h=a(v)?v:i(e[c+1])?[]:{})}r(p,d,h),p=p[d]}return t}},1811:(t,e,n)=>{var r=n(1469),o=n(5403),i=n(5514),a=n(9833);t.exports=function(t,e){return r(t)?t:o(t,e)?[t]:i(a(t))}},9021:(t,e,n)=>{var r=n(5564),o=n(5357),i=n(61);t.exports=function(t){return i(o(t,void 0,r),t+"")}},222:(t,e,n)=>{var r=n(1811),o=n(5694),i=n(1469),a=n(5776),s=n(1780),l=n(327);t.exports=function(t,e,n){for(var c=-1,u=(e=r(e,t)).length,f=!1;++c<u;){var p=l(e[c]);if(!(f=null!=t&&n(t,p)))break;t=t[p]}return f||++c!=u?f:!!(u=null==t?0:t.length)&&s(u)&&a(p,u)&&(i(t)||o(t))}},7285:(t,e,n)=>{var r=n(2705),o=n(5694),i=n(1469),a=r?r.isConcatSpreadable:void 0;t.exports=function(t){return i(t)||o(t)||!!(a&&t&&t[a])}},5403:(t,e,n)=>{var r=n(1469),o=n(3448),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!o(t))||(a.test(t)||!i.test(t)||null!=e&&t in Object(e))}},4523:(t,e,n)=>{var r=n(8306);t.exports=function(t){var e=r(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}},5514:(t,e,n)=>{var r=n(4523),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=r((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(o,(function(t,n,r,o){e.push(r?o.replace(i,"$1"):n||t)})),e}));t.exports=a},327:(t,e,n)=>{var r=n(3448);t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e}},5564:(t,e,n)=>{var r=n(1078);t.exports=function(t){return(null==t?0:t.length)?r(t,1):[]}},9095:(t,e,n)=>{var r=n(13),o=n(222);t.exports=function(t,e){return null!=t&&o(t,e,r)}},8306:(t,e,n)=>{var r=n(3369);function o(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(o.Cache||r),n}o.Cache=r,t.exports=o},8718:(t,e,n)=>{var r=n(5970),o=n(9021)((function(t,e){return null==t?{}:r(t,e)}));t.exports=o},2573:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});const r={name:"nzPerPageSelect",props:{value:Number,options:Array}};const o=(0,n(1900).Z)(r,(function(){var t=this,e=t._self._c;return e("b-field",[e("b-select",{attrs:{value:t.value,placeholder:"Per page"},on:{input:function(e){return t.$emit("input",e)}}},t._l(t.options,(function(n,r){return e("option",{key:r,domProps:{value:n,textContent:t._s(n)}})})),0)],1)}),[],!1,null,null,null).exports},5997:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});const r={name:"nzSortableColumnHeader",props:{column:{type:Object,required:!0},sort:Object},computed:{isNotSortedColumn:function(){return this.sort.field!==this.column.field},sortIcon:function(){return this.isNotSortedColumn?"sort":"asc"===this.sort.order?"sort-asc":"sort-desc"}}};const o=(0,n(1900).Z)(r,(function(){var t=this,e=t._self._c;return e("span",{staticClass:"is-flex is-align-items-center"},[t._v("\n  "+t._s(t.column.label)+"\n  "),t.column.sortable?e("b-icon",{staticClass:"ml-2",class:{"has-text-grey-light":t.isNotSortedColumn},attrs:{pack:"fa",icon:t.sortIcon,size:"is-small"}}):t._e()],1)}),[],!1,null,null,null).exports},5323:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>b});var r=n(9669),o=n.n(r),i=n(1701),a=n.n(i),s=n(9174),l=n(950),c=n(5442),u=n(2573),f=n(5997);function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){v(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function v(t,e,n){return(e=function(t){var e=function(t,e){if("object"!==p(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===p(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y(){return y=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},y.apply(this,arguments)}const g={name:"nzLiteratureObservationsTable",mixins:[l.Z,c.Z],components:{NzPerPageSelect:u.Z,NzSortableColumnHeader:f.Z},props:{perPageOptions:{type:Array,default:function(){return[15,30,50,100]},validator:function(t){return t.length}},listRoute:String,viewRoute:String,editRoute:String,deleteRoute:String,empty:{type:String,default:"Nothing here."},showActivityLog:Boolean,exportUrl:String,exportColumns:{type:Array,default:function(){return[]}}},data:function(){return{data:[],total:0,loading:!1,sortField:"id",sortOrder:"desc",defaultSortOrder:"asc",page:1,perPage:this.perPageOptions[0],checkedRows:[],activityLog:[],showExportModal:!1,exporting:!1}},computed:{months:function(){return s.Z.months()},days:function(){return a()(1,31)},hasActions:function(){return this.exportable},checkedIds:function(){return this.checkedRows.map((function(t){return t.id}))},exportable:function(){return!(!this.exportUrl||!this.exportColumns.length)},actionRunning:function(){return this.exporting}},created:function(){var t=this;this.restoreState(),this.loadAsyncData(),this.$on("filter",(function(){t.saveState(),t.loadAsyncData()}))},methods:{loadAsyncData:function(){var t=this;this.loading=!0,this.checkedRows=[];var e=y({},(function(t){if(null==t)throw new TypeError("Cannot destructure "+t)}(this.filter),this.filter));return o().get(route(this.listRoute).withQuery(h(h({},e),{},{sort_by:"".concat(this.sortField,".").concat(this.sortOrder),page:this.page,per_page:this.perPage}))).then((function(e){var n=e.data;t.data=[],t.total=n.meta.total,n.data.forEach((function(e){return t.data.push(e)})),t.loading=!1}),(function(e){t.data=[],t.total=0,t.loading=!1}))},getPersistantKeys:function(){return["sortField","sortOrder","perPage","page","newFilter","filter","filterIsActive"]},onPageChange:function(t){this.page=t,this.saveState(),this.loadAsyncData()},onSort:function(t,e){this.sortField=t,this.sortOrder=e,this.saveState(),this.loadAsyncData()},onPerPageChange:function(t){t!==this.perPage&&(this.perPage=t,this.saveState(),this.loadAsyncData())},confirmRemove:function(t){var e=this;this.$buefy.dialog.confirm({message:this.trans("Are you sure you want to delete this record?"),confirmText:this.trans("buttons.delete"),cancelText:this.trans("buttons.cancel"),type:"is-danger",onConfirm:function(){e.remove(t)}})},remove:function(t){var e=this;return o().delete(route(this.deleteRoute,t.id)).then((function(t){e.$buefy.toast.open({message:e.trans("Record deleted"),type:"is-success"}),e.loadAsyncData()})).catch((function(t){console.error(t)}))},editLink:function(t){return route(this.editRoute,t.id)},viewLink:function(t){return this.viewRoute?route(this.viewRoute,t.id):null},openActivityLogModal:function(t){this.activityLog=t.activity},filterDefaults:function(){return{}},openExportModal:function(){this.showExportModal=!0},onExportDone:function(t){this.showExportModal=!1,t.url?this.$buefy.modal.open({parent:this,component:ExportDownloadModal,canCancel:[],hasModalCard:!0,props:{url:t.url}}):this.$buefy.toast.open({duration:0,message:"Whoops, looks like something went wrong.",type:"is-danger"})}},filters:{truncate:function(t,e){return t.length>e?t.substr(0,e)+"...":t}}};const b=(0,n(1900).Z)(g,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"collection-observations-table"},[e("b-table",{attrs:{data:t.data,loading:t.loading,paginated:"","backend-pagination":"",total:t.total,"per-page":t.perPage,"current-page":t.page,"pagination-position":"both","backend-sorting":"","default-sort-direction":"asc","default-sort":[t.sortField,t.sortOrder],detailed:"","mobile-cards":"",checkable:t.hasActions,"checked-rows":t.checkedRows},on:{"page-change":t.onPageChange,sort:t.onSort,"update:checkedRows":function(e){t.checkedRows=e},"update:checked-rows":function(e){t.checkedRows=e}},scopedSlots:t._u([{key:"top-left",fn:function(){return[e("nz-per-page-select",{attrs:{value:t.perPage,options:t.perPageOptions},on:{input:t.onPerPageChange}})]},proxy:!0},{key:"bottom-left",fn:function(){return[e("nz-per-page-select",{attrs:{value:t.perPage,options:t.perPageOptions},on:{input:t.onPerPageChange}})]},proxy:!0},{key:"empty",fn:function(){return[e("section",{staticClass:"section"},[e("div",{staticClass:"content has-text-grey has-text-centered"},[e("p",[t._v(t._s(t.empty))])])])]},proxy:!0},{key:"detail",fn:function(n){var r=n.row;return[e("article",{staticClass:"media"},[e("div",{staticClass:"media-content"},[e("div",{staticClass:"content"},[e("strong",[t._v(t._s(r.location))]),t._v(" "),e("small",[t._v(t._s(r.latitude)+", "+t._s(r.longitude))]),e("br"),t._v(" "),e("small",[t._v(t._s(t.trans("labels.collection_observations.elevation"))+": "+t._s(r.elevation)+"m")]),e("br"),t._v(" "),r.accuracy?e("small",[t._v(t._s(t.trans("labels.collection_observations.accuracy"))+": "+t._s(r.accuracy)+"m")]):t._e()])])])]}}])},[t._v(" "),t._v(" "),e("b-table-column",{attrs:{field:"id",label:t.trans("labels.id"),width:"40",numeric:"",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v("\n        "+t._s(n.id)+"\n      ")]}},{key:"header",fn:function(n){var r=n.column;return[e("nz-sortable-column-header",{attrs:{column:r,sort:{field:t.sortField,order:t.sortOrder}}})]}}])}),t._v(" "),e("b-table-column",{attrs:{field:"taxon_name",label:t.trans("labels.collection_observations.taxon"),sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v("\n        "+t._s(n.taxon?n.taxon.name:"")+"\n      ")]}},{key:"header",fn:function(n){var r=n.column;return[e("nz-sortable-column-header",{attrs:{column:r,sort:{field:t.sortField,order:t.sortOrder}}})]}}])}),t._v(" "),e("b-table-column",{attrs:{field:"collection_name",label:t.trans("labels.collection_observations.collection"),sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v("\n        "+t._s(n.collection?n.collection.name:"")+"\n      ")]}},{key:"header",fn:function(n){var r=n.column;return[e("nz-sortable-column-header",{attrs:{column:r,sort:{field:t.sortField,order:t.sortOrder}}})]}}])}),t._v(" "),e("b-table-column",{attrs:{width:"150",numeric:""},scopedSlots:t._u([{key:"default",fn:function(n){var r=n.row;return[t.viewRoute?e("a",{attrs:{href:t.viewLink(r),title:t.trans("buttons.view")}},[e("b-icon",{attrs:{icon:"eye"}})],1):t._e(),t._v(" "),e("a",{attrs:{href:t.editLink(r),title:t.trans("buttons.edit")}},[e("b-icon",{attrs:{icon:"edit"}})],1),t._v(" "),e("a",{attrs:{title:t.trans("buttons.delete")},on:{click:function(e){return t.confirmRemove(r)}}},[e("b-icon",{attrs:{icon:"trash"}})],1)]}}])})],1)],1)}),[],!1,null,null,null).exports}}]);
//# sourceMappingURL=2e9674ead27b3527.js.map