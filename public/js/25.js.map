{"version":3,"sources":["webpack:///./resources/js/mixins/FormMixin.js","webpack:///./resources/js/components/inputs/PhotoUpload.vue?e6b9","webpack:///./resources/js/Croppr.js","webpack:///./resources/js/components/ImageCropModal.vue?7cdd","webpack:///resources/js/components/ImageCropModal.vue","webpack:///./resources/js/components/inputs/PhotoUpload.vue?7763","webpack:///resources/js/components/inputs/PhotoUpload.vue","webpack:///./resources/js/components/ImageCropModal.vue","webpack:///./resources/js/components/ImageCropModal.vue?9faf","webpack:///./resources/js/components/inputs/PhotoUpload.vue","webpack:///./resources/js/components/ImageModal.vue?f78d","webpack:///./resources/js/components/ImageModal.vue?a0e2","webpack:///resources/js/components/ImageModal.vue","webpack:///./resources/js/components/ImageModal.vue","webpack:///./resources/js/components/forms/ViewGroupForm.vue?8809","webpack:///resources/js/components/forms/ViewGroupForm.vue","webpack:///./resources/js/components/forms/ViewGroupForm.vue?4af1","webpack:///./resources/js/components/forms/ViewGroupForm.vue"],"names":["name","props","action","type","String","required","method","default","redirectUrl","cancelUrl","submitMore","Boolean","shouldConfirmSubmit","confirmSubmitMessage","this","trans","shouldAskReason","shouldConfirmCancel","submitOnlyDirty","submitOnlyDirtyMessage","data","form","newForm","keepAfterSubmit","submittingWithRedirect","submittingWithoutRedirect","confirmingSubmit","confirmingCancel","locale","window","App","created","document","addEventListener","registerKeyListener","beforeDestroy","removeEventListener","methods","Form","resetOnSuccess","e","enter","which","keyCode","ctrlKey","shiftKey","submitWithoutRedirect","submitWithRedirect","confirmSubmit","onConfirm","options","message","confirmText","cancelText","onCancel","promptForReason","$buefy","dialog","confirm","prompt","inputAttrs","placeholder","maxlength","$nextTick","$refs","input","target","setCustomValidity","validity","valid","validationMessage","notifyNoChanges","toast","open","notifyNoChangesAndRedirect","setTimeout","location","href","processing","isDirty","performSubmitWithRedirect","reason","toLowerCase","then","onSuccessfulSubmitWithRedirect","onFailedSubmit","hookAfterSubmitWithRedirect","performSubmitWithoutRedirect","onSuccessfulSubmitWithoutRedirect","keep","_pick","reset","populate","hookAfterSubmitWithoutRedirect","error","duration","_get","_isEqual","initial","confirmCancel","event","preventDefault","Croppr","value","actualWidth","imageEl","naturalWidth","actualHeight","naturalHeight","factorX","offsetWidth","factorY","offsetHeight","box","Box","Math","round","x","y","width","height","redraw","BaseCroppr","mixins","canCancel","Array","imageUrl","crop","Object","newCrop","preserveRatio","mounted","ctrlIsPressed","ctrlIsNotPressed","watch","isActive","handleScroll","croppr","onCropEnd","onInitialize","setBoxToRealPosition","savedScrollTop","body","classList","toggle","style","top","documentElement","scrollTop","cropImage","$emit","close","aspectRatio","components","NzImageCropModal","_vm","_h","$createElement","_c","_self","attrs","animation","staticClass","_v","maxWidth","newWidth","ref","on","$event","cancel","_e","NzImageModal","withCrop","haveImage","showModal","thumbnailUrl","openCropModal","closeCropModal","image","path","hasExisting","remove","license","handleLicenseChanged","domProps","_s","_l","label","showCropModal","url","$set","onInput","progress","text","items","Number","newValue","active","computed","openImage","immediate","handler","next","length","prev","key","onClose","component","defaultTranslations","FormMixin","NzPhotoUpload","group","rootGroups","names","descriptions","taxa","filteredTaxa","supportedLocales","parent","get","set","parent_id","isRoot","taxa_ids","map","description","image_url","image_path","only_observed_taxa","focusOnTranslation","fetchTaxa","axios","route","params","page","per_page","except","onTaxonNameInput","onImageUploaded","onImageRemoved","model","callback","$$v","expression","rootGroup","index","scopedSlots","_u","fn","option","class"],"mappings":"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","file":"js/25.js?id=172d554e25908fa2424a","sourcesContent":["import Form from 'form-backend-validation'\nimport _pick from 'lodash/pick'\nimport _get from 'lodash/get'\nimport _isEqual from 'lodash/isEqual'\n\n\nexport default {\n  name: 'nzFieldObservationForm',\n\n  props: {\n    action: {\n      type: String,\n      required: true\n    },\n\n    method: {\n      type: String,\n      default: 'POST'\n    },\n\n    redirectUrl: String,\n    cancelUrl: String,\n\n    submitMore: Boolean,\n    shouldConfirmSubmit: Boolean,\n    confirmSubmitMessage: {\n      type: String,\n      default() {\n        return this.trans('You are about to submit')\n      }\n    },\n    shouldAskReason: Boolean,\n    shouldConfirmCancel: Boolean,\n    submitOnlyDirty: Boolean,\n    submitOnlyDirtyMessage: {\n      type: String,\n      default() {\n        return this.trans('There are no changes, the data will not be saved.')\n      }\n    }\n  },\n\n  data() {\n    return {\n      form: this.newForm(),\n      keepAfterSubmit: [],\n      submittingWithRedirect: false,\n      submittingWithoutRedirect: false,\n      confirmingSubmit: false,\n      confirmingCancel: false,\n      locale: window.App.locale\n    }\n  },\n\n  created() {\n    document.addEventListener('keyup', this.registerKeyListener)\n  },\n\n  beforeDestroy() {\n    document.removeEventListener('keyup', this.registerKeyListener)\n  },\n\n  methods: {\n    /**\n     * Create new form instance.\n     *\n     * @param  {Object} data default form data\n     * @return {Form}\n     */\n    newForm(data = {}) {\n      return new Form(data, {\n        resetOnSuccess: false\n      })\n    },\n\n    /**\n     * Keyboard shortcuts.\n     *\n     * @param {Event} e\n     */\n    registerKeyListener(e) {\n      const enter = 13 === (e.which || e.keyCode)\n\n      if (e.ctrlKey && e.shiftKey && enter) {\n        this.submitMore && this.submitWithoutRedirect()\n      } else if (e.ctrlKey && enter) {\n        this.submitWithRedirect()\n      }\n    },\n\n    /**\n     * Confirm submit.\n     *\n     * @param {Function} onConfirm\n     */\n    confirmSubmit(onConfirm) {\n      if (this.confirmingSubmit) return\n\n      this.confirmingSubmit = true\n\n      const options = {\n        message: this.confirmSubmitMessage,\n        confirmText: this.trans('buttons.save'),\n        cancelText: this.trans('buttons.cancel'),\n        onConfirm,\n        onCancel: () => { this.confirmingSubmit = false }\n      }\n\n      if (!this.shouldAskReason) {\n        return this.$buefy.dialog.confirm(options)\n      }\n\n      return this.promptForReason(options)\n    },\n\n    /**\n     * Prompt the user for reason of change.\n     *\n     * @param  {Object} options\n     * @return {Vue}\n     */\n    promptForReason(options) {\n      const dialog = this.$buefy.dialog.prompt({\n        ...options,\n        inputAttrs: {\n            placeholder: this.trans('Reason'),\n            required: true,\n            maxlength: 255\n        }\n      })\n\n      // Custom localized validation for the prompt input.\n      dialog.$nextTick(() => {\n        dialog.$refs.input.addEventListener('invalid', (e) => {\n          e.target.setCustomValidity('')\n\n          if (!e.target.validity.valid) {\n            e.target.setCustomValidity(this.trans('This field is required and can contain max 255 chars.'))\n          }\n        })\n\n        dialog.$refs.input.addEventListener('input', (e) => {\n          dialog.validationMessage = null\n        })\n      })\n\n      return dialog\n    },\n\n    /**\n     * Notify the user there are no changes.\n     */\n    notifyNoChanges() {\n      this.$buefy.toast.open({\n        message: this.submitOnlyDirtyMessage,\n        type: 'is-info'\n      })\n    },\n\n    /**\n     * Notify the user there are no changes and redirect.\n     */\n    notifyNoChangesAndRedirect() {\n      this.notifyNoChanges()\n\n      setTimeout(() => {\n        if (this.redirectUrl) {\n          window.location.href = this.redirectUrl\n        }\n      }, 500)\n    },\n\n    /**\n     * Submit the form with redirect.\n     */\n    submitWithRedirect() {\n      if (this.form.processing) return\n\n      if (this.submitOnlyDirty && !this.isDirty()) return this.notifyNoChangesAndRedirect()\n\n      if (this.shouldConfirmSubmit) return this.confirmSubmit(this.performSubmitWithRedirect)\n\n      this.performSubmitWithRedirect()\n    },\n\n    /**\n     * Submit the form with redirect.\n     */\n    performSubmitWithRedirect(reason = null) {\n      this.submittingWithRedirect = true\n      this.confirmingSubmit = false\n\n      if (this.shouldAskReason) {\n        this.form.reason = reason\n      }\n\n      this.form[this.method.toLowerCase()](this.action)\n          .then(this.onSuccessfulSubmitWithRedirect)\n          .catch(this.onFailedSubmit)\n    },\n\n    /**\n     * Handle successful form submit with redirect.\n     */\n    onSuccessfulSubmitWithRedirect() {\n      this.form.processing = true\n\n      this.$buefy.toast.open({\n        message: this.trans('Saved successfully'),\n        type: 'is-success'\n      })\n\n      // We want to wait a bit before we send the user to redirect route\n      // so we can show the message that the action was successful.\n      setTimeout(() => {\n        this.form.processing = false\n        this.submittingWithRedirect = false\n\n        this.hookAfterSubmitWithRedirect()\n\n        if (this.redirectUrl) {\n          window.location.href = this.redirectUrl\n        }\n      }, 500)\n    },\n\n    /**\n     * Perform after submit with redirect is successful.\n     */\n    hookAfterSubmitWithRedirect() {},\n\n    /**\n     * Submit the form and stay to add more.\n     */\n    submitWithoutRedirect() {\n      if (this.form.processing) return\n\n      if (this.submitOnlyDirty  && !this.isDirty()) return this.notifyNoChanges()\n\n      if (this.shouldConfirmSubmit) return this.confirmSubmit(this.performSubmitWithoutRedirect)\n\n      this.performSubmitWithoutRedirect()\n    },\n\n    /**\n     * Submit the form and stay to add more.\n     */\n    performSubmitWithoutRedirect(reason = null) {\n      this.submittingWithoutRedirect = true\n      this.confirmingSubmit = false\n\n      if (this.shouldAskReason) {\n        this.form.reason = reason\n      }\n\n      this.form[this.method.toLowerCase()](this.action)\n          .then(this.onSuccessfulSubmitWithoutRedirect)\n          .catch(this.onFailedSubmit)\n    },\n\n    /**\n     * Handle successful form submit with no redirect.\n     */\n    onSuccessfulSubmitWithoutRedirect() {\n      this.submittingWithoutRedirect = false\n\n      this.$buefy.toast.open({\n        message: this.trans('Saved successfully'),\n        type: 'is-success'\n      })\n\n      // Reset the form but remember some data.\n      const keep = _pick(this.form.data(), this.keepAfterSubmit)\n      this.form.reset()\n      this.form.populate(keep)\n\n      this.hookAfterSubmitWithoutRedirect()\n    },\n\n    /**\n     * Perform after submit without redirect is successful.\n     */\n    hookAfterSubmitWithoutRedirect() {},\n\n    /**\n     * Handle failed form submit.\n     *\n     * @param {Error} error\n     */\n    onFailedSubmit(error) {\n      this.submittingWithRedirect = false\n      this.submittingWithoutRedirect = false\n\n      this.$buefy.toast.open({\n        duration: 2500,\n        message: _get(error, 'response.data.message', error.message),\n        type: 'is-danger'\n      })\n    },\n\n    /**\n     * Check if form is changed.\n     *\n     * @return {Boolean}\n     */\n    isDirty() {\n      return ! _isEqual(this.form.data(), this.form.initial)\n    },\n\n    /**\n     * Confirmation dialog for canceling.\n     */\n    confirmCancel() {\n      if (this.confirmingCancel) return\n\n      this.confirmingCancel = true\n\n      this.$buefy.dialog.confirm({\n        message: this.trans('If you leave this page changes will not be saved.'),\n        onConfirm: () => {\n          this.confirmingCancel = false\n          window.location.href = this.cancelUrl\n        },\n        onCancel: () => { this.confirmingCancel = false },\n        cancelText: this.trans('buttons.stay_on_page'),\n        confirmText: this.trans('buttons.leave_page'),\n      })\n    },\n\n    /**\n     * Handle cancel button/link.\n     *\n     * @param {Event} event\n     */\n    onCancel(event) {\n      if (this.shouldConfirmCancel && this.isDirty()) {\n        event.preventDefault()\n\n        this.confirmCancel()\n      }\n    }\n  }\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (!_vm.haveImage)?_c('b-field',{attrs:{\"message\":_vm.error || null,\"type\":_vm.error ? 'is-danger' : null,\"expanded\":\"\"}},[_c('b-upload',{attrs:{\"drag-drop\":\"\",\"type\":\"is-fullwidth\"},on:{\"input\":_vm.onInput}},[_c('section',{staticClass:\"section\"},[_c('div',{staticClass:\"has-text-centered\"},[_c('div',[_c('b-icon',{attrs:{\"icon\":\"upload\",\"size\":\"is-medium\"}})],1),_vm._v(\" \"),(_vm.uploading)?_c('progress',{staticClass:\"progress is-primary is-small\",attrs:{\"max\":\"100\"},domProps:{\"value\":_vm.progress}},[_vm._v(_vm._s(_vm.progress)+\"%\")]):_c('div',[_vm._v(_vm._s(_vm.text))])])])])],1):_c('div',{staticClass:\"card\"},[_c('div',{staticClass:\"card-image\"},[_c('figure',{staticClass:\"has-magnifier has-text-centered\",on:{\"click\":function($event){_vm.showModal = true}}},[_c('img',{staticClass:\"max-h-36\",attrs:{\"src\":_vm.thumbnailUrl,\"alt\":\"Uploaded photo\"}}),_vm._v(\" \"),_c('div',{staticClass:\"image-magnifier\"},[_c('b-icon',{attrs:{\"icon\":\"expand\",\"size\":\"is-medium\"}})],1)])]),_vm._v(\" \"),(_vm.haveImage)?_c('footer',{staticClass:\"card-footer\"},[_c('div',{staticClass:\"card-footer-item flex-col\"},[_c('div',{staticClass:\"mb-4 w-full flex justify-between\"},[(_vm.withCrop)?_c('button',{staticClass:\"button is-outlined is-small mr-2\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.openCropModal,\"close\":_vm.closeCropModal}},[_c('b-icon',{attrs:{\"icon\":\"crop\"}})],1):_vm._e(),_vm._v(\" \"),(_vm.image.path || _vm.hasExisting)?_c('button',{staticClass:\"delete is-danger is-medium\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.remove}}):_vm._e()]),_vm._v(\" \"),(_vm.withLicense)?_c('div',{staticClass:\"w-full\"},[_c('b-select',{attrs:{\"value\":_vm.image.license,\"expanded\":\"\"},on:{\"input\":_vm.handleLicenseChanged}},[_c('option',{domProps:{\"value\":null}},[_vm._v(_vm._s(_vm.trans('labels.field_observations.default')))]),_vm._v(\" \"),_vm._l((_vm.licenses),function(label,value){return _c('option',{domProps:{\"value\":value,\"textContent\":_vm._s(label)}})})],2)],1):_vm._e()])]):_vm._e(),_vm._v(\" \"),(_vm.haveImage)?_c('nz-image-crop-modal',{attrs:{\"active\":_vm.showCropModal,\"crop\":_vm.image.crop,\"image-url\":_vm.image.url},on:{\"update:active\":function($event){_vm.showCropModal=$event},\"update:crop\":function($event){return _vm.$set(_vm.image, \"crop\", $event)}}}):_vm._e(),_vm._v(\" \"),(_vm.showModal)?_c('nz-image-modal',{attrs:{\"items\":[_vm.thumbnailUrl]},on:{\"close\":function($event){_vm.showModal = false}}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import BaseCroppr from 'croppr'\nimport Box from 'croppr/src/box'\n\nexport default class Croppr extends BaseCroppr {\n  setBoxToRealPosition(value) {\n    const actualWidth = this.imageEl.naturalWidth\n    const actualHeight = this.imageEl.naturalHeight\n    const factorX = actualWidth / this.imageEl.offsetWidth\n    const factorY = actualHeight / this.imageEl.offsetHeight\n\n    this.box = new Box(\n      Math.round(value.x / factorX),\n      Math.round(value.y / factorY),\n      Math.round((value.x + value.width) / factorX),\n      Math.round((value.y + value.height) / factorY)\n    )\n\n    this.redraw()\n  }\n}\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageCropModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageCropModal.vue?vue&type=script&lang=js&\"","<template>\n  <transition :name=\"animation\">\n    <div v-if=\"isActive\" class=\"modal is-active\">\n      <div class=\"modal-background\"/>\n\n      <div\n        class=\"animation-content modal-content\"\n        :style=\"{ maxWidth: newWidth }\"\n      >\n        <img\n          :src=\"imageUrl\"\n          class=\"image\"\n          alt=\"Cropped image\"\n          ref=\"cropModalImage\"\n        >\n      </div>\n\n      <button\n        type=\"button\"\n        class=\"modal-close is-large\"\n        @click=\"cancel('x')\"\n      />\n\n      <button\n        type=\"button\"\n        class=\"modal-action\"\n        @click=\"cropImage\"\n      >\n        <b-icon icon=\"check\"/>\n      </button>\n    </div>\n  </transition>\n</template>\n\n<script>\nimport Croppr from '@/Croppr'\nimport bModal from 'buefy/src/components/modal/Modal'\n\nexport default {\n  name: 'nzImageCropModal',\n\n  mixins: [bModal],\n\n  props: {\n    canCancel: {\n      type: [Array, Boolean],\n      default: () => ['escape', 'x']\n    },\n    imageUrl: String,\n    crop: Object\n  },\n\n  data() {\n    return {\n\t\t\tcroppr: null,\n      newCrop: this.crop,\n      preserveRatio: false\n    }\n  },\n\n  mounted() {\n    document.addEventListener('keydown', this.ctrlIsPressed)\n    document.addEventListener('keyup', this.ctrlIsNotPressed)\n  },\n\n  beforeDestroy() {\n    document.removeEventListener('keydown', this.ctrlIsPressed)\n    document.removeEventListener('keyup', this.ctrlIsNotPressed)\n  },\n\n  watch: {\n    isActive(value) {\n      this.handleScroll()\n\n      this.croppr =  null\n\n      if (value) {\n        this.$nextTick(() => {\n          this.croppr = new Croppr(this.$refs.cropModalImage, {\n            onCropEnd: (value) => {\n              this.newCrop = value\n            },\n\n            onInitialize: (croppr) => {\n              if (this.newCrop) {\n                croppr.setBoxToRealPosition(this.newCrop)\n              }\n            }\n          })\n        })\n      }\n    }\n  },\n\n  methods: {\n    handleScroll() {\n      if (typeof window === 'undefined') return\n\n      this.savedScrollTop = !this.savedScrollTop\n        ? document.documentElement.scrollTop\n        : this.savedScrollTop\n\n      document.body.classList.toggle('is-noscroll', this.isActive)\n\n      if (this.isActive) {\n        document.body.style.top = `-${this.savedScrollTop}px`\n        return\n      }\n\n      document.documentElement.scrollTop = this.savedScrollTop\n      document.body.style.top = null\n      this.savedScrollTop = null\n    },\n\n    cropImage() {\n      this.$emit('update:crop', this.newCrop)\n\n      this.close()\n    },\n\n    ctrlIsPressed(e) {\n      if (e.which == 17 && this.croppr) {\n        this.croppr.options.aspectRatio = this.croppr.box.height() / this.croppr.box.width()\n      }\n    },\n\n    ctrlIsNotPressed(e) {\n      if (e.which == 17  && this.croppr) {\n        this.croppr.options.aspectRatio = null\n      }\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PhotoUpload.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PhotoUpload.vue?vue&type=script&lang=js&\"","<template>\n\t<b-field v-if=\"!haveImage\" :message=\"error || null\" :type=\"error ? 'is-danger' : null\" expanded>\n\t\t<b-upload @input=\"onInput\" drag-drop type=\"is-fullwidth\">\n\t\t\t<section class=\"section\">\n\t\t\t\t<div class=\"has-text-centered\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<b-icon\n\t\t\t\t\t\t\ticon=\"upload\"\n\t\t\t\t\t\t\tsize=\"is-medium\">\n\t\t\t\t\t\t</b-icon>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<progress class=\"progress is-primary is-small\" :value=\"progress\" max=\"100\" v-if=\"uploading\">{{ progress }}%</progress>\n\n\t\t\t\t\t<div v-else>{{ text }}</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</b-upload>\n\t</b-field>\n\n\t<div class=\"card\" v-else>\n\t\t<div class=\"card-image\">\n\t\t\t<figure class=\"has-magnifier has-text-centered\" @click=\"showModal = true\">\n\t\t\t\t<img :src=\"thumbnailUrl\" alt=\"Uploaded photo\" class=\"max-h-36\" />\n\t\t\t\t<div class=\"image-magnifier\">\n\t\t\t\t\t<b-icon icon=\"expand\" size=\"is-medium\" />\n\t\t\t\t</div>\n\t\t\t</figure>\n\t  </div>\n\n\t\t<footer class=\"card-footer\" v-if=\"haveImage\">\n\t\t\t<div class=\"card-footer-item flex-col\">\n\t\t\t\t<div class=\"mb-4 w-full flex justify-between\">\n\t\t\t\t\t<button\n            type=\"button\"\n            class=\"button is-outlined is-small mr-2\"\n            v-if=\"withCrop\"\n            @click=\"openCropModal\"\n            @close=\"closeCropModal\"\n          >\n            <b-icon icon=\"crop\" />\n          </button>\n\n\t\t\t\t\t<button type=\"button\" class=\"delete is-danger is-medium\" @click=\"remove\" v-if=\"image.path || hasExisting\"></button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"w-full\" v-if=\"withLicense\">\n\t\t\t\t\t<b-select :value=\"image.license\" @input=\"handleLicenseChanged\" expanded>\n\t\t\t\t\t\t<option :value=\"null\">{{ trans('labels.field_observations.default') }}</option>\n\t\t\t\t\t\t<option v-for=\"(label, value) in licenses\" :value=\"value\" v-text=\"label\"></option>\n\t\t\t\t\t</b-select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</footer>\n\n\t\t<nz-image-crop-modal :active.sync=\"showCropModal\" :crop.sync=\"image.crop\" :image-url=\"image.url\" v-if=\"haveImage\"/>\n\n\t\t<nz-image-modal :items=\"[thumbnailUrl]\" v-if=\"showModal\" @close=\"showModal = false\"/>\n\t</div>\n</template>\n\n<script>\nimport loadImage from 'blueimp-load-image'\nimport NzImageCropModal from '@/components/ImageCropModal'\nimport NzImageModal from '@/components/ImageModal'\n\nexport default {\n\tname: 'nzPhotoUpload',\n\n  components: {\n    NzImageCropModal,\n    NzImageModal\n  },\n\n  props: {\n\t\timageUrl: {\n\t\t\ttype: String,\n\t\t\tdefault: null\n\t\t},\n\t\timagePath: {\n\t\t\ttype: String,\n\t\t\tdefault: null\n\t\t},\n\t\timageLicense: {\n\t\t\ttype: [Number, String],\n\t\t\tdefault: null\n\t\t},\n\t\tlicenses: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t\ttext: String,\n\t\twithLicense: {\n      type: Boolean,\n      default: true\n    },\n    withCrop: {\n      type: Boolean,\n      default: true\n    }\n\t},\n\n  data() {\n    return {\n    \timage: {\n\t\t\t\turl: this.imageUrl,\n\t\t\t\tpath: this.imagePath,\n\t\t\t\tcrop: null,\n\t\t\t\tlicense: this.imageLicense\n\t\t\t},\n\t\t\tcroppedImageUrl: null,\n\t\t\treader: null,\n\t\t\tuploading: false,\n\t\t\tprogress: 0,\n\t\t\thasExisting: !!this.imageUrl,\n\t\t\terror: null,\n\t\t\tshowCropModal: false,\n\t\t\tshowModal: false\n    }\n  },\n\n\twatch: {\n\t\t'image.crop': function (value) {\n\t\t\tthis.$emit('cropped', this.image)\n\n\t\t\tif (!value) {\n\t\t\t\tthis.croppedImageUrl = null\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tthis.cropThumbnail(value)\n\t\t}\n\t},\n\n\tcomputed: {\n\t\thaveImage() {\n\t\t\treturn !!this.image.url\n\t\t},\n\n\t\tthumbnailUrl() {\n\t\t\treturn this.croppedImageUrl || this.image.url\n\t\t}\n\t},\n\n\tmethods: {\n\t\tselectImage() {\n\t\t\tthis.$refs.input.click()\n\t\t},\n\n\t\tonInput(file) {\n\t\t\tthis.error = null\n\n\t\t\tif (!file) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tthis.upload(file)\n\t\t},\n\n\t\tupload(file) {\n\t\t\tthis.uploading = true\n\t\t\treturn axios.post(route('api.photo-uploads.store'), this.makeForm(file), {\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'multipart/form-data',\n\t\t\t\t\tAccept: 'application/json'\n\t\t\t\t},\n\t\t\t\tonUploadProgress: progressEvent => {\n\t\t\t\t   this.progress = Math.floor((progressEvent.loaded * 100) / progressEvent.total)\n\t\t\t\t}\n\t\t\t}).then(response => {\n\t\t\t\tthis.image.path = response.data.file\n\t\t\t\tthis.image.exif = response.data.exif\n\t\t\t\tthis.image.license = null\n\t\t\t\tthis.uploading = false\n\t\t\t\tthis.progress = 0\n\n\t\t\t\tthis.$emit('uploaded', this.image)\n\n        loadImage(file, canvas => {\n          this.image.url = canvas.toDataURL()\n        }, { orientation: true })\n\t\t\t}).catch(this.handleError)\n\t\t},\n\n\t\tmakeForm(file) {\n\t\t\tlet form = new FormData()\n\n\t\t\tform.append('file', file)\n\n\t\t\treturn form\n\t\t},\n\n\t\tremove() {\n\t\t\tif (this.hasExisting) {\n\t\t\t\tthis.hasExisting = false\n\t\t\t\treturn this.clearPhoto()\n\t\t\t}\n\n\t\t\taxios.delete(route('api.photo-uploads.destroy', this.image.path)).then(() => {\n\t\t\t\tthis.clearPhoto()\n\t\t\t})\n\t\t},\n\n\t\tclearPhoto() {\n\t\t\tthis.$emit('removed', this.image)\n\n\t\t\tthis.image.path = null\n\t\t\tthis.image.url = null\n\t\t\tthis.image.crop = null\n\t\t\tthis.image.license = null\n\t\t\tthis.croppedImageUrl = null\n\t\t},\n\n\t\thandleError(error) {\n\t\t\tthis.uploading = false\n\t\t\tthis.progress = 0\n\t\t\tthis.image.url = null\n\t\t\t// Clear the input so we can select the same image if needed.\n\t\t\tthis.$el.querySelector('input[type=\"file\"]').value = ''\n\n\t\t\tif (!error.response) {\n\t\t\t\treturn this.$buefy.toast.open({\n\t\t\t\t\tduration: 5000,\n\t\t\t\t\tmessage: error.message,\n\t\t\t\t\tposition: 'is-top',\n\t\t\t\t\ttype: 'is-danger'\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tthis.error = error.response.data.errors.file[0] || this.trans('Error')\n\t\t},\n\n\t\topenCropModal() {\n\t\t\tthis.showCropModal = true\n\t\t},\n\n\t\tcloseCropModal() {\n\t\t\tthis.showCropModal = false\n\t\t},\n\n\t\tcropThumbnail(crop) {\n\t\t\t// Create image\n\t\t\tconst image = document.createElement('img')\n\t\t\timage.src = this.image.url\n\n\t\t\t// Draw canvas\n\t\t\tconst canvas = document.createElement('canvas')\n\n  \t\tcanvas.setAttribute('width', crop.width)\n  \t\tcanvas.setAttribute('height', crop.height)\n\n  \t\tconst context = canvas.getContext('2d')\n  \t\tcontext.drawImage(image, -crop.x, -crop.y)\n\n\t\t\tthis.croppedImageUrl = canvas.toDataURL()\n\t\t},\n\n\t\t/**\n\t\t * Handle license change.\n\t\t *\n\t\t * @param {String|Number} license\n\t\t */\n\t\thandleLicenseChanged(license) {\n\t\t\tthis.image.license = license\n\t\t\tthis.$emit('license-changed', license)\n\t\t}\n\t}\n}\n</script>\n","import { render, staticRenderFns } from \"./ImageCropModal.vue?vue&type=template&id=035960ca&\"\nimport script from \"./ImageCropModal.vue?vue&type=script&lang=js&\"\nexport * from \"./ImageCropModal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('transition',{attrs:{\"name\":_vm.animation}},[(_vm.isActive)?_c('div',{staticClass:\"modal is-active\"},[_c('div',{staticClass:\"modal-background\"}),_vm._v(\" \"),_c('div',{staticClass:\"animation-content modal-content\",style:({ maxWidth: _vm.newWidth })},[_c('img',{ref:\"cropModalImage\",staticClass:\"image\",attrs:{\"src\":_vm.imageUrl,\"alt\":\"Cropped image\"}})]),_vm._v(\" \"),_c('button',{staticClass:\"modal-close is-large\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.cancel('x')}}}),_vm._v(\" \"),_c('button',{staticClass:\"modal-action\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.cropImage}},[_c('b-icon',{attrs:{\"icon\":\"check\"}})],1)]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./PhotoUpload.vue?vue&type=template&id=4c771e47&\"\nimport script from \"./PhotoUpload.vue?vue&type=script&lang=js&\"\nexport * from \"./PhotoUpload.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-modal',{attrs:{\"active\":_vm.active,\"can-cancel\":['escape', 'x']},on:{\"update:active\":function($event){_vm.active=$event},\"close\":_vm.onClose}},[_c('div',{staticClass:\"image-modal\"},[_c('img',{attrs:{\"src\":_vm.openImage}}),_vm._v(\" \"),(_vm.items.length > 1)?_c('div',{staticClass:\"image-modal-navigation\"},[_c('div',{staticClass:\"image-modal-previous\",on:{\"click\":_vm.prev}},[_c('i',{staticClass:\"fa fa-chevron-left\",attrs:{\"aria-hidden\":\"true\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"image-modal-next\",on:{\"click\":_vm.next}},[_c('i',{staticClass:\"fa fa-chevron-right\",attrs:{\"aria-hidden\":\"true\"}})])]):_vm._e()])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageModal.vue?vue&type=script&lang=js&\"","<template>\n  <b-modal :active.sync=\"active\" :can-cancel=\"['escape', 'x']\" @close=\"onClose\">\n    <div class=\"image-modal\">\n      <img :src=\"openImage\">\n\n      <div class=\"image-modal-navigation\" v-if=\"items.length > 1\">\n        <div class=\"image-modal-previous\" @click=\"prev\">\n          <i class=\"fa fa-chevron-left\" aria-hidden=\"true\"></i>\n        </div>\n\n        <div class=\"image-modal-next\" @click=\"next\">\n          <i class=\"fa fa-chevron-right\" aria-hidden=\"true\"></i>\n        </div>\n      </div>\n    </div>\n  </b-modal>\n</template>\n\n<script>\nexport default {\n  name: 'nzImageModal',\n\n  props: {\n    items: {\n      type: Array,\n      default: () => []\n    },\n    value: {\n      type: Number,\n      default: 0\n    }\n  },\n\n  data() {\n    return {\n      newValue: this.value,\n      active: true\n    }\n  },\n\n  computed: {\n    openImage() {\n      return this.items[this.newValue]\n    }\n  },\n\n  watch: {\n    newValue() {\n      this.$emit('input', this.newValue)\n    },\n\n    openImage: {\n      immediate: true,\n      handler(value) {\n        this.active = Boolean(value)\n      }\n    }\n  },\n\n  created() {\n    document.addEventListener('keyup', this.registerKeyListener)\n  },\n\n  beforeDestroy() {\n    document.removeEventListener('keyup', this.registerKeyListener)\n  },\n\n  methods: {\n    next() {\n      let newValue = this.newValue + 1\n\n      if (newValue >= this.items.length) {\n        newValue = 0\n      }\n\n      this.newValue = newValue\n    },\n\n    prev() {\n      let newValue = this.newValue - 1\n\n      if (newValue < 0) {\n        newValue = this.items.length - 1\n      }\n\n      this.newValue = newValue\n    },\n\n    registerKeyListener(e) {\n      const key = e.which || e.keyCode\n\n      if (key === 37) { // left arrow\n        this.prev()\n      } else if (key === 39) { // right arrow\n        this.next()\n      }\n    },\n\n    onClose(e) {\n      this.active = false\n\n      // Buefy modal component sets these classes and\n      // if we don't remove them scroll will not work.\n      document.documentElement.classList.remove('is-clipped')\n      document.body.classList.remove('is-noscroll')\n\n      this.$emit('close', e)\n    }\n  }\n}\n</script>\n","import { render, staticRenderFns } from \"./ImageModal.vue?vue&type=template&id=82126584&\"\nimport script from \"./ImageModal.vue?vue&type=script&lang=js&\"\nexport * from \"./ImageModal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('form',{attrs:{\"action\":_vm.action,\"method\":\"POST\"},on:{\"submit\":function($event){$event.preventDefault();return _vm.submitWithRedirect($event)}}},[_c('b-field',{attrs:{\"label\":_vm.trans('labels.view_groups.parent')}},[_c('b-select',{model:{value:(_vm.parent),callback:function ($$v) {_vm.parent=$$v},expression:\"parent\"}},[_c('option'),_vm._v(\" \"),_vm._l((_vm.rootGroups),function(rootGroup){return _c('option',{domProps:{\"value\":rootGroup}},[_vm._v(_vm._s(rootGroup.name))])})],2)],1),_vm._v(\" \"),_c('b-field',{attrs:{\"label\":_vm.trans('labels.view_groups.name')}},[_c('b-tabs',{staticClass:\"block\",attrs:{\"size\":\"is-small\"},on:{\"change\":function (index) { return _vm.focusOnTranslation(index, 'name'); }}},_vm._l((_vm.supportedLocales),function(data,locale){return _c('b-tab-item',{key:locale,attrs:{\"label\":_vm.trans('languages.' + data.name)}},[_c('b-input',{attrs:{\"id\":(\"name-\" + locale)},model:{value:(_vm.form.name[locale]),callback:function ($$v) {_vm.$set(_vm.form.name, locale, $$v)},expression:\"form.name[locale]\"}})],1)}),1)],1),_vm._v(\" \"),_c('b-field',{attrs:{\"label\":_vm.trans('labels.view_groups.description')}},[_c('b-tabs',{staticClass:\"block\",attrs:{\"size\":\"is-small\"},on:{\"change\":function (index) { return _vm.focusOnTranslation(index, 'description'); }}},_vm._l((_vm.supportedLocales),function(data,locale){return _c('b-tab-item',{key:locale,attrs:{\"label\":_vm.trans('languages.' + data.name)}},[_c('b-input',{attrs:{\"type\":\"textarea\",\"id\":(\"description-\" + locale)},model:{value:(_vm.form.description[locale]),callback:function ($$v) {_vm.$set(_vm.form.description, locale, $$v)},expression:\"form.description[locale]\"}})],1)}),1)],1),_vm._v(\" \"),(!_vm.isRoot)?[_c('b-field',{attrs:{\"label\":_vm.trans('labels.view_groups.taxa')}},[_c('b-taginput',{attrs:{\"data\":_vm.filteredTaxa,\"autocomplete\":\"\",\"field\":\"name\"},on:{\"typing\":_vm.onTaxonNameInput},scopedSlots:_vm._u([{key:\"default\",fn:function(props){return [_c('span',[_vm._v(_vm._s(props.option.name))])]}}],null,false,1538493864),model:{value:(_vm.taxa),callback:function ($$v) {_vm.taxa=$$v},expression:\"taxa\"}})],1),_vm._v(\" \"),_c('b-field',[_c('b-checkbox',{model:{value:(_vm.form.only_observed_taxa),callback:function ($$v) {_vm.$set(_vm.form, \"only_observed_taxa\", $$v)},expression:\"form.only_observed_taxa\"}},[_vm._v(_vm._s(_vm.trans('labels.view_groups.only_observed_taxa')))])],1)]:_vm._e(),_vm._v(\" \"),_c('b-field',{attrs:{\"label\":_vm.trans('labels.view_groups.image')}},[_c('nz-photo-upload',{attrs:{\"image-url\":_vm.form.image_url,\"image-path\":_vm.form.image_path,\"licenses\":{},\"with-license\":false,\"with-crop\":false},on:{\"uploaded\":_vm.onImageUploaded,\"removed\":_vm.onImageRemoved}})],1),_vm._v(\" \"),_c('hr'),_vm._v(\" \"),_c('button',{staticClass:\"button is-primary\",class:{\n        'is-loading': _vm.form.processing\n    },attrs:{\"type\":\"submit\"},on:{\"click\":_vm.submitWithRedirect}},[_vm._v(\"\\n    \"+_vm._s(_vm.trans('buttons.save'))+\"\\n  \")]),_vm._v(\" \"),_c('a',{staticClass:\"button is-text\",attrs:{\"href\":_vm.cancelUrl},on:{\"click\":_vm.onCancel}},[_vm._v(_vm._s(_vm.trans('buttons.cancel')))])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <form :action=\"action\" method=\"POST\" @submit.prevent=\"submitWithRedirect\">\n    <b-field :label=\"trans('labels.view_groups.parent')\">\n      <b-select v-model=\"parent\">\n        <option></option>\n        <option v-for=\"rootGroup in rootGroups\" :value=\"rootGroup\">{{ rootGroup.name }}</option>\n      </b-select>\n    </b-field>\n\n    <b-field :label=\"trans('labels.view_groups.name')\">\n      <b-tabs size=\"is-small\" class=\"block\" @change=\"(index) => focusOnTranslation(index, 'name')\">\n        <b-tab-item :label=\"trans('languages.' + data.name)\" v-for=\"(data, locale) in supportedLocales\" :key=\"locale\">\n          <b-input v-model=\"form.name[locale]\" :id=\"`name-${locale}`\" />\n        </b-tab-item>\n      </b-tabs>\n    </b-field>\n\n    <b-field :label=\"trans('labels.view_groups.description')\">\n      <b-tabs size=\"is-small\" class=\"block\" @change=\"(index) => focusOnTranslation(index, 'description')\">\n        <b-tab-item :label=\"trans('languages.' + data.name)\" v-for=\"(data, locale) in supportedLocales\" :key=\"locale\">\n          <b-input type=\"textarea\" v-model=\"form.description[locale]\" :id=\"`description-${locale}`\" />\n        </b-tab-item>\n      </b-tabs>\n    </b-field>\n\n    <template v-if=\"!isRoot\">\n      <b-field :label=\"trans('labels.view_groups.taxa')\">\n        <b-taginput v-model=\"taxa\"\n            :data=\"filteredTaxa\"\n            autocomplete\n            field=\"name\"\n            @typing=\"onTaxonNameInput\"\n        >\n          <template v-slot:default=\"props\">\n            <span>{{ props.option.name }}</span>\n          </template>\n        </b-taginput>\n      </b-field>\n\n      <b-field>\n        <b-checkbox v-model=\"form.only_observed_taxa\">{{ trans('labels.view_groups.only_observed_taxa') }}</b-checkbox>\n      </b-field>\n    </template>\n\n    <b-field :label=\"trans('labels.view_groups.image')\">\n      <nz-photo-upload\n        :image-url=\"form.image_url\"\n    \t\t:image-path=\"form.image_path\"\n    \t\t:licenses=\"{}\"\n    \t\t:with-license=\"false\"\n        :with-crop=\"false\"\n        @uploaded=\"onImageUploaded\"\n        @removed=\"onImageRemoved\"\n      />\n    </b-field>\n\n    <hr>\n\n    <button\n      type=\"submit\"\n      class=\"button is-primary\"\n      :class=\"{\n          'is-loading': form.processing\n      }\"\n      @click=\"submitWithRedirect\"\n    >\n      {{ trans('buttons.save') }}\n    </button>\n\n    <a :href=\"cancelUrl\" class=\"button is-text\" @click=\"onCancel\">{{ trans('buttons.cancel') }}</a>\n  </form>\n</template>\n\n<script>\nimport Form from 'form-backend-validation'\nimport _keys from 'lodash/keys'\nimport _find from 'lodash/find'\nimport _get from 'lodash/get'\nimport _debounce from 'lodash/debounce'\nimport FormMixin from '@/mixins/FormMixin'\nimport NzPhotoUpload from '@/components/inputs/PhotoUpload'\n\nfunction defaultTranslations() {\n  const value = {}\n\n  _keys(window.App.supportedLocales).forEach(locale => {\n    value[locale] = null\n  })\n\n  return value\n}\n\nexport default {\n  name: 'nzViewGroupForm',\n\n  mixins: [FormMixin],\n\n  components: {\n    NzPhotoUpload\n  },\n\n  props: {\n    group: {\n      type: Object,\n      default() {\n        return {\n            parent_id: null,\n            only_observed_taxa: false,\n            taxa: []\n        }\n      }\n    },\n    rootGroups: Array,\n    names: {\n      type: Object,\n      default: () => defaultTranslations()\n    },\n    descriptions: {\n      type: Object,\n      default: () => defaultTranslations()\n    }\n  },\n\n  data() {\n    return {\n      form: this.newForm(),\n      taxa: this.group.taxa,\n      filteredTaxa: []\n    }\n  },\n\n  computed: {\n    supportedLocales() {\n      return window.App.supportedLocales\n    },\n\n    parent: {\n      get() {\n        return _find(this.rootGroups, { id: this.form.parent_id })\n      },\n\n      set(value) {\n        this.form.parent_id = _get(value, 'id')\n      }\n    },\n\n    isRoot() {\n      return !this.form.parent_id\n    }\n  },\n\n  watch: {\n    taxa(value) {\n      this.form.taxa_ids = value.map(taxon => taxon.id)\n    }\n  },\n\n  methods: {\n    newForm() {\n      return new Form({\n        parent_id: this.group.parent_id,\n        name: this.names,\n        description: this.descriptions,\n        image_url: this.group.image_url,\n        image_path: this.group.image_path,\n        only_observed_taxa: this.group.only_observed_taxa,\n        taxa_ids: this.group.taxa.map(taxon => taxon.id)\n      }, {\n        resetOnSuccess: false\n      })\n    },\n\n    focusOnTranslation(index, attribute) {\n      const locales = _keys(this.supportedLocales)\n      const selector = `#${attribute}-${locales[index]}`\n\n      setTimeout(() => {\n        this.$el.querySelector(selector).focus()\n      }, 500)\n    },\n\n    fetchTaxa(name) {\n      axios.get(route('api.taxa.index'), {\n        params: {\n          name,\n          page: 1,\n          per_page: 10,\n          except: this.taxa.map(taxon => taxon.id)\n        }\n      }).then(({ data }) => {\n        this.filteredTaxa = data.data\n      })\n    },\n\n    onTaxonNameInput: _debounce(function (name) {\n      return this.fetchTaxa(name)\n    }, 500),\n\n    onImageUploaded(image) {\n      this.form.image_path = image.path\n    },\n\n    onImageRemoved() {\n      this.form.image_url = null\n      this.form.image_path = null\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ViewGroupForm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ViewGroupForm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ViewGroupForm.vue?vue&type=template&id=ed2cecba&\"\nimport script from \"./ViewGroupForm.vue?vue&type=script&lang=js&\"\nexport * from \"./ViewGroupForm.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}