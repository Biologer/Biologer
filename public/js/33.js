(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"S+E7":function(t,e,s){"use strict";s.r(e);var a=s("5YJQ"),n=s.n(a),i=s("J2m7"),r=s.n(i),o=s("ijCd"),u=s.n(o),l=s("mwIZ"),c=s.n(l),m=s("sEfC"),f={name:"nzUserForm",props:{action:String,method:{type:String,default:"post"},roles:Array,user:{type:Object,default:function(){return{first_name:"",last_name:"",institution:"",roles:[],curated_taxa:[]}}},redirect:String},data:function(){return{filteredTaxa:[],curatedTaxa:this.user.curated_taxa,form:new n.a({first_name:this.user.first_name,last_name:this.user.last_name,institution:this.user.institution,roles_ids:this.user.roles.map((function(t){return t.id})),curated_taxa_ids:this.user.curated_taxa.map((function(t){return t.id}))},{resetOnSuccess:!1})}},computed:{isCurator:function(){return u()(this.form.roles_ids,r()(this.roles,{name:"curator"}).id)}},watch:{curatedTaxa:function(t){this.form.curated_taxa_ids=t.map((function(t){return t.id}))}},methods:{onTaxonNameInput:s.n(m)()((function(t){return this.fetchTaxa(t)}),500),fetchTaxa:function(t){var e=this;axios.get(route("api.taxa.index"),{params:{name:t,page:1,per_page:10,except:this.curatedTaxa.map((function(t){return t.id}))}}).then((function(t){var s=t.data;e.filteredTaxa=s.data}))},submit:function(){this.form.processing||this.form[this.method.toLowerCase()](this.action).then(this.onSuccessfulSubmit).catch(this.onFailedSubmit)},onSuccessfulSubmit:function(){var t=this;this.form.processing=!0,this.$buefy.toast.open({message:this.trans("Saved successfully"),type:"is-success"}),setTimeout((function(){t.form.processing=!1,window.location.href=t.redirect}),500)},onFailedSubmit:function(t){this.$buefy.toast.open({duration:2500,message:c()(t,"response.data.message",t.message),type:"is-danger"})}}},d=s("KHd+"),p=Object(d.a)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"user-form"},[s("form",{on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[s("div",{staticClass:"columns"},[s("div",{staticClass:"column"},[s("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.users.first_name")}},[s("b-input",{model:{value:t.form.first_name,callback:function(e){t.$set(t.form,"first_name",e)},expression:"form.first_name"}})],1)],1),t._v(" "),s("div",{staticClass:"column"},[s("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.users.last_name")}},[s("b-input",{model:{value:t.form.last_name,callback:function(e){t.$set(t.form,"last_name",e)},expression:"form.last_name"}})],1)],1)]),t._v(" "),s("b-field",{attrs:{label:t.trans("labels.users.institution")}},[s("b-input",{model:{value:t.form.institution,callback:function(e){t.$set(t.form,"institution",e)},expression:"form.institution"}})],1),t._v(" "),s("b-field",{attrs:{label:t.trans("labels.users.roles")}},[s("div",{staticClass:"block"},t._l(t.roles,(function(e){return s("b-checkbox",{key:e.id,attrs:{"native-value":e.id},model:{value:t.form.roles_ids,callback:function(e){t.$set(t.form,"roles_ids",e)},expression:"form.roles_ids"}},[t._v("\n          "+t._s(t.trans("roles."+e.name))+"\n        ")])})),1)]),t._v(" "),t.isCurator?s("b-field",{attrs:{label:t.trans("labels.users.curated_taxa")}},[s("b-taginput",{attrs:{data:t.filteredTaxa,autocomplete:"",field:"name",placeholder:"Type taxon name"},on:{typing:t.onTaxonNameInput},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.option.name))])]}}],null,!1,1538493864),model:{value:t.curatedTaxa,callback:function(e){t.curatedTaxa=e},expression:"curatedTaxa"}})],1):t._e(),t._v(" "),s("hr"),t._v(" "),s("button",{staticClass:"button is-primary",attrs:{type:"submit"}},[t._v(t._s(t.trans("buttons.save")))])],1)])}),[],!1,null,null,null);e.default=p.exports}}]);
//# sourceMappingURL=33.js.map?id=ff9d2491768c9d690ff2