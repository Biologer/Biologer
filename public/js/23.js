(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"2ajD":function(t,n){t.exports=function(t){return t!=t}},"4qC0":function(t,n,e){var r=e("NykK"),a=e("Z0cm"),i=e("ExA7");t.exports=function(t){return"string"==typeof t||!a(t)&&i(t)&&"[object String]"==r(t)}},CZoQ:function(t,n){t.exports=function(t,n,e){for(var r=e-1,a=t.length;++r<a;)if(t[r]===n)return r;return-1}},JmpY:function(t,n,e){var r=e("eUgh");t.exports=function(t,n){return r(n,(function(n){return t[n]}))}},"P/G1":function(t,n,e){var r=e("JmpY"),a=e("7GkX");t.exports=function(t){return null==t?[]:r(t,a(t))}},QIyF:function(t,n,e){var r=e("Kz5y");t.exports=function(){return r.Date.now()}},"R/W3":function(t,n,e){var r=e("KwMD"),a=e("2ajD"),i=e("CZoQ");t.exports=function(t,n,e){return n==n?i(t,n,e):r(t,a,e)}},"S+E7":function(t,n,e){"use strict";e.r(n);var r=e("5YJQ"),a=e.n(r),i=e("J2m7"),s=e.n(i),o=e("ijCd"),u=e.n(o),c=e("mwIZ"),f=e.n(c),l=e("sEfC"),m={name:"nzUserForm",props:{action:String,method:{type:String,default:"post"},roles:Array,user:{type:Object,default:function(){return{first_name:"",last_name:"",institution:"",roles:[],curated_taxa:[]}}},redirect:String},data:function(){return{filteredTaxa:[],curatedTaxa:this.user.curated_taxa,form:new a.a({first_name:this.user.first_name,last_name:this.user.last_name,institution:this.user.institution,roles_ids:this.user.roles.map((function(t){return t.id})),curated_taxa_ids:this.user.curated_taxa.map((function(t){return t.id}))},{resetOnSuccess:!1})}},computed:{isCurator:function(){return u()(this.form.roles_ids,s()(this.roles,{name:"curator"}).id)}},watch:{curatedTaxa:function(t){this.form.curated_taxa_ids=t.map((function(t){return t.id}))}},methods:{onTaxonNameInput:e.n(l)()((function(t){return this.fetchTaxa(t)}),500),fetchTaxa:function(t){var n=this;axios.get(route("api.taxa.index"),{params:{name:t,page:1,per_page:10,except:this.curatedTaxa.map((function(t){return t.id}))}}).then((function(t){var e=t.data;n.filteredTaxa=e.data}))},submit:function(){this.form.processing||this.form[this.method.toLowerCase()](this.action).then(this.onSuccessfulSubmit).catch(this.onFailedSubmit)},onSuccessfulSubmit:function(){var t=this;this.form.processing=!0,this.$buefy.toast.open({message:this.trans("Saved successfully"),type:"is-success"}),setTimeout((function(){t.form.processing=!1,window.location.href=t.redirect}),500)},onFailedSubmit:function(t){this.$buefy.toast.open({duration:2500,message:f()(t,"response.data.message",t.message),type:"is-danger"})}}},d=e("KHd+"),p=Object(d.a)(m,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"user-form"},[e("form",{on:{submit:function(n){return n.preventDefault(),t.submit(n)}}},[e("div",{staticClass:"columns"},[e("div",{staticClass:"column"},[e("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.users.first_name")}},[e("b-input",{model:{value:t.form.first_name,callback:function(n){t.$set(t.form,"first_name",n)},expression:"form.first_name"}})],1)],1),t._v(" "),e("div",{staticClass:"column"},[e("b-field",{staticClass:"is-required",attrs:{label:t.trans("labels.users.last_name")}},[e("b-input",{model:{value:t.form.last_name,callback:function(n){t.$set(t.form,"last_name",n)},expression:"form.last_name"}})],1)],1)]),t._v(" "),e("b-field",{attrs:{label:t.trans("labels.users.institution")}},[e("b-input",{model:{value:t.form.institution,callback:function(n){t.$set(t.form,"institution",n)},expression:"form.institution"}})],1),t._v(" "),e("b-field",{attrs:{label:t.trans("labels.users.roles")}},[e("div",{staticClass:"block"},t._l(t.roles,(function(n){return e("b-checkbox",{key:n.id,attrs:{"native-value":n.id},model:{value:t.form.roles_ids,callback:function(n){t.$set(t.form,"roles_ids",n)},expression:"form.roles_ids"}},[t._v("\n          "+t._s(t.trans("roles."+n.name))+"\n        ")])})),1)]),t._v(" "),t.isCurator?e("b-field",{attrs:{label:t.trans("labels.users.curated_taxa")}},[e("b-taginput",{attrs:{data:t.filteredTaxa,autocomplete:"",field:"name",placeholder:"Type taxon name"},on:{typing:t.onTaxonNameInput},scopedSlots:t._u([{key:"default",fn:function(n){return[e("span",[t._v(t._s(n.option.name))])]}}],null,!1,1538493864),model:{value:t.curatedTaxa,callback:function(n){t.curatedTaxa=n},expression:"curatedTaxa"}})],1):t._e(),t._v(" "),e("hr"),t._v(" "),e("button",{staticClass:"button is-primary",attrs:{type:"submit"}},[t._v(t._s(t.trans("buttons.save")))])],1)])}),[],!1,null,null,null);n.default=p.exports},ijCd:function(t,n,e){var r=e("R/W3"),a=e("MMmD"),i=e("4qC0"),s=e("Sxd8"),o=e("P/G1"),u=Math.max;t.exports=function(t,n,e,c){t=a(t)?t:o(t),e=e&&!c?s(e):0;var f=t.length;return e<0&&(e=u(f+e,0)),i(t)?e<=f&&t.indexOf(n,e)>-1:!!f&&r(t,n,e)>-1}},sEfC:function(t,n,e){var r=e("GoyQ"),a=e("QIyF"),i=e("tLB3"),s=Math.max,o=Math.min;t.exports=function(t,n,e){var u,c,f,l,m,d,p=0,v=!1,x=!1,h=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function b(n){var e=u,r=c;return u=c=void 0,p=n,l=t.apply(r,e)}function _(t){return p=t,m=setTimeout(y,n),v?b(t):l}function g(t){var e=t-d;return void 0===d||e>=n||e<0||x&&t-p>=f}function y(){var t=a();if(g(t))return T(t);m=setTimeout(y,function(t){var e=n-(t-d);return x?o(e,f-(t-p)):e}(t))}function T(t){return m=void 0,h&&u?b(t):(u=c=void 0,l)}function C(){var t=a(),e=g(t);if(u=arguments,c=this,d=t,e){if(void 0===m)return _(d);if(x)return clearTimeout(m),m=setTimeout(y,n),b(d)}return void 0===m&&(m=setTimeout(y,n)),l}return n=i(n)||0,r(e)&&(v=!!e.leading,f=(x="maxWait"in e)?s(i(e.maxWait)||0,n):f,h="trailing"in e?!!e.trailing:h),C.cancel=function(){void 0!==m&&clearTimeout(m),p=0,u=d=c=m=void 0},C.flush=function(){return void 0===m?l:T(a())},C}}}]);
//# sourceMappingURL=23.js.map?id=ecde2abcb67a810a4361