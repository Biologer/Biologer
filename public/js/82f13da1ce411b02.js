(self.webpackChunk=self.webpackChunk||[]).push([[445],{104:(t,e,r)=>{var n=r(3661);function o(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],a=r.cache;if(a.has(o))return a.get(o);var i=t.apply(this,n);return r.cache=a.set(o,i)||a,i};return r.cache=new(o.Cache||n),r}o.Cache=n,t.exports=o},124:(t,e,r)=>{var n=r(9325);t.exports=function(){return n.Date.now()}},631:(t,e,r)=>{var n=r(8077),o=r(9326);t.exports=function(t,e){return null!=t&&o(t,e,n)}},1059:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});const n={name:"nzSortableColumnHeader",props:{column:{type:Object,required:!0},sort:Object},computed:{isNotSortedColumn:function(){return this.sort.field!==this.column.field},sortIcon:function(){return this.isNotSortedColumn?"sort":"asc"===this.sort.order?"sort-asc":"sort-desc"}}};const o=(0,r(4486).A)(n,function(){var t=this,e=t._self._c;return e("span",{staticClass:"is-flex is-align-items-center"},[t._v("\n  "+t._s(t.column.label)+"\n  "),t.column.sortable?e("b-icon",{staticClass:"ml-2",class:{"has-text-grey-light":t.isNotSortedColumn},attrs:{pack:"fa",icon:t.sortIcon,size:"is-small"}}):t._e()],1)},[],!1,null,null,null).exports},1769:(t,e,r)=>{var n=r(6449),o=r(8586),a=r(1802),i=r(3222);t.exports=function(t,e){return n(t)?t:o(t,e)?[t]:a(i(t))}},1802:(t,e,r)=>{var n=r(2224),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,i=n(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(o,function(t,r,n,o){e.push(n?o.replace(a,"$1"):r||t)}),e});t.exports=i},2224:(t,e,r)=>{var n=r(104);t.exports=function(t){var e=n(t,function(t){return 500===r.size&&r.clear(),t}),r=e.cache;return e}},2474:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function a(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}r.d(e,{A:()=>i});const i=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"get",value:function(t){var e=JSON.parse(localStorage.getItem(t));return e?new Date(e.expires)<new Date?(localStorage.removeItem(t),null):e.value:null}},{key:"has",value:function(t){return null!==this.get(t)}},{key:"set",value:function(t,e,r){var n=(new Date).getTime(),o=new Date(n+6e4*r);localStorage.setItem(t,JSON.stringify({value:e,expires:o}))}},{key:"delete",value:function(t){this.get(t)&&localStorage.removeItem(t)}}])&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}())},2559:(t,e,r)=>{"use strict";r.d(e,{A:()=>i});var n=r(4383),o=r.n(n),a=r(2474);const i={props:{cacheKey:{default:null},cacheLifetime:{default:1440}},computed:{storageKey:function(){return this.cacheKey?"nz-table.".concat(this.cacheKey):"nz-table.".concat(window.location.host).concat(window.location.pathname)}},methods:{getPersistantKeys:function(){return["sortField","sortOrder","perPage"]},saveState:function(){a.A.set(this.storageKey,o()(this.$data,this.getPersistantKeys()),this.cacheLifetime)},restoreState:function(){var t=this,e=a.A.get(this.storageKey);null!=e&&(this.getPersistantKeys().forEach(function(r){void 0!==e[r]&&t.$set(t,r,e[r])}),this.saveState())}}}},3120:(t,e,r)=>{var n=r(4528),o=r(5891);t.exports=function t(e,r,a,i,s){var l=-1,u=e.length;for(a||(a=o),s||(s=[]);++l<u;){var c=e[l];r>0&&a(c)?r>1?t(c,r-1,a,i,s):n(s,c):i||(s[s.length]=c)}return s}},3170:(t,e,r)=>{var n=r(6547),o=r(1769),a=r(361),i=r(3805),s=r(7797);t.exports=function(t,e,r,l){if(!i(t))return t;for(var u=-1,c=(e=o(e,t)).length,d=c-1,f=t;null!=f&&++u<c;){var v=s(e[u]),h=r;if("__proto__"===v||"constructor"===v||"prototype"===v)return t;if(u!=d){var p=f[v];void 0===(h=l?l(p,v,f):void 0)&&(h=i(p)?p:a(e[u+1])?[]:{})}n(f,v,h),f=f[v]}return t}},4383:(t,e,r)=>{var n=r(6001),o=r(8816)(function(t,e){return null==t?{}:n(t,e)});t.exports=o},5891:(t,e,r)=>{var n=r(1873),o=r(2428),a=r(6449),i=n?n.isConcatSpreadable:void 0;t.exports=function(t){return a(t)||o(t)||!!(i&&t&&t[i])}},5970:(t,e,r)=>{var n=r(3120);t.exports=function(t){return(null==t?0:t.length)?n(t,1):[]}},6001:(t,e,r)=>{var n=r(7420),o=r(631);t.exports=function(t,e){return n(t,e,function(e,r){return o(t,r)})}},6445:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>u});var n=r(8221),o=r.n(n),a=r(2559),i=r(7852),s=r(1059);const l={name:"nzTimedCountObservationsTable",mixins:[a.A],components:{NzPerPageSelect:i.A,NzSortableColumnHeader:s.A},props:{perPageOptions:{type:Array,default:function(){return[15,30,50,100]},validator:function(t){return t.length}},listRoute:String,viewRoute:String,editRoute:String,deleteRoute:String,showActivityLog:Boolean,empty:{type:String,default:"Nothing here."}},data:function(){return{data:[],total:0,loading:!1,sortField:"id",sortOrder:"asc",page:1,perPage:this.perPageOptions[0],checkedRows:[],activityLog:[],search:""}},computed:{showing:function(){var t=this.page*this.perPage<=this.total?this.page*this.perPage:this.total,e=this.page>1?(this.page-1)*this.perPage+1:1;return this.total?this.trans("labels.tables.from_to_total",{total:this.total,from:e,to:t}):""}},created:function(){this.restoreState(),this.loadAsyncData()},methods:{loadAsyncData:function(){var t=this;return this.loading=!0,axios.get(route(this.listRoute).withQuery({sort_by:"".concat(this.sortField,".").concat(this.sortOrder),page:this.page,per_page:this.perPage,search:this.search})).then(function(e){var r=e.data;t.data=[],t.total=r.meta.total,r.data.forEach(function(e){return t.data.push(e)}),t.loading=!1},function(e){t.data=[],t.total=0,t.loading=!1})},onPageChange:function(t){this.page=t,this.loadAsyncData()},onSort:function(t,e){this.sortField=t,this.sortOrder=e,this.saveState(),this.loadAsyncData()},onPerPageChange:function(t){t!==this.perPage&&(this.perPage=t,this.saveState(),this.loadAsyncData())},openActivityLogModal:function(t){this.activityLog=t.activity},confirmRemove:function(t){var e=this;this.$buefy.dialog.confirm({message:this.trans("Are you sure you want to delete this record?"),confirmText:this.trans("buttons.delete"),cancelText:this.trans("buttons.cancel"),type:"is-danger",onConfirm:function(){e.remove(t)}})},remove:function(t){var e=this;return axios.delete(route(this.deleteRoute,t.id)).then(function(t){e.$buefy.toast.open({message:e.trans("Record deleted"),type:"is-success"}),e.loadAsyncData()}).catch(function(t){console.error(t)})},editLink:function(t){return route(this.editRoute,t.id)},viewLink:function(t){return this.viewRoute?route(this.viewRoute,t.id):null},performSearch:o()(function(t){this.search!==t&&(this.search=t,this.loadAsyncData())},500),clearSearch:function(){this.search="",this.loadAsyncData()},formatDuration:function(t,e){if(!t||!e)return"-";var r=new Date("1970-01-01T".concat(t)),n=new Date("1970-01-01T".concat(e));if(isNaN(r)||isNaN(n))return"-";var o=Math.floor((n-r)/1e3);if(o<0)return"-";var a=Math.floor(o/3600),i=Math.floor(o%3600/60),s=o%60;return a>0?"".concat(a,"h ").concat(i,"m ").concat(s,"s"):i>0?"".concat(i,"m ").concat(s,"s"):"".concat(s,"s")}}};const u=(0,r(4486).A)(l,function(){var t=this,e=t._self._c;return e("div",{staticClass:"timed-count-observations-table"},[e("b-table",{attrs:{data:t.data,loading:t.loading,paginated:"","backend-pagination":"",total:t.total,"per-page":t.perPage,"current-page":t.page,"pagination-position":"both","backend-sorting":"","default-sort-direction":"asc","default-sort":[t.sortField,t.sortOrder],"mobile-cards":""},on:{"page-change":t.onPageChange,sort:t.onSort},scopedSlots:t._u([{key:"top-left",fn:function(){return[e("div",{staticClass:"level-item"},[e("nz-per-page-select",{attrs:{value:t.perPage,options:t.perPageOptions},on:{input:t.onPerPageChange}})],1),t._v(" "),e("div",{staticClass:"level-item"},[t._v(t._s(t.showing))])]},proxy:!0},{key:"bottom-left",fn:function(){return[e("div",{staticClass:"level-item"},[e("nz-per-page-select",{attrs:{value:t.perPage,options:t.perPageOptions},on:{input:t.onPerPageChange}})],1),t._v(" "),e("div",{staticClass:"level-item"},[t._v(t._s(t.showing))])]},proxy:!0},{key:"empty",fn:function(){return[e("section",{staticClass:"section"},[e("div",{staticClass:"content has-text-grey has-text-centered"},[e("p",[t._v(t._s(t.empty))])])])]},proxy:!0}])},[t._v(" "),t._v(" "),e("b-table-column",{attrs:{field:"id",label:t.trans("labels.id"),width:"40",numeric:"",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[t._v("\n        "+t._s(r.id)+"\n      ")]}},{key:"header",fn:function(r){var n=r.column;return[e("nz-sortable-column-header",{attrs:{column:n,sort:{field:t.sortField,order:t.sortOrder}}})]}}])}),t._v(" "),e("b-table-column",{attrs:{field:"view_group",label:t.trans("labels.exports.group_name"),sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[t._v("\n        "+t._s(r.view_group.name)+"\n      ")]}},{key:"header",fn:function(r){var n=r.column;return[e("nz-sortable-column-header",{attrs:{column:n,sort:{field:t.sortField,order:t.sortOrder}}})]}}])}),t._v(" "),e("b-table-column",{attrs:{field:"year",label:t.trans("labels.field_observations.year"),numeric:"",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[t._v("\n        "+t._s(r.year)+"\n      ")]}},{key:"header",fn:function(r){var n=r.column;return[e("nz-sortable-column-header",{attrs:{column:n,sort:{field:t.sortField,order:t.sortOrder}}})]}}])}),t._v(" "),e("b-table-column",{attrs:{field:"month",label:t.trans("labels.field_observations.month"),numeric:"",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[t._v("\n        "+t._s(r.month)+"\n      ")]}},{key:"header",fn:function(r){var n=r.column;return[e("nz-sortable-column-header",{attrs:{column:n,sort:{field:t.sortField,order:t.sortOrder}}})]}}])}),t._v(" "),e("b-table-column",{attrs:{field:"day",label:t.trans("labels.field_observations.day"),numeric:"",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[t._v("\n        "+t._s(r.day)+"\n      ")]}},{key:"header",fn:function(r){var n=r.column;return[e("nz-sortable-column-header",{attrs:{column:n,sort:{field:t.sortField,order:t.sortOrder}}})]}}])}),t._v(" "),e("b-table-column",{attrs:{field:"start_time",label:t.trans("labels.timed_count_observations.start_time"),numeric:"",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[t._v("\n        "+t._s(r.start_time)+"\n      ")]}},{key:"header",fn:function(r){var n=r.column;return[e("nz-sortable-column-header",{attrs:{column:n,sort:{field:t.sortField,order:t.sortOrder}}})]}}])}),t._v(" "),e("b-table-column",{attrs:{field:"end_time",label:t.trans("labels.timed_count_observations.end_time"),numeric:"",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[t._v("\n        "+t._s(r.end_time)+"\n      ")]}},{key:"header",fn:function(r){var n=r.column;return[e("nz-sortable-column-header",{attrs:{column:n,sort:{field:t.sortField,order:t.sortOrder}}})]}}])}),t._v(" "),e("b-table-column",{attrs:{field:"duration",label:t.trans("labels.timed_count_observations.duration"),sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[t._v("\n        "+t._s(t.formatDuration(r.start_time,r.end_time))+"\n      ")]}},{key:"header",fn:function(r){var n=r.column;return[e("nz-sortable-column-header",{attrs:{column:n,sort:{field:t.sortField,order:t.sortOrder}}})]}}])}),t._v(" "),e("b-table-column",{attrs:{width:"150",numeric:""},scopedSlots:t._u([{key:"default",fn:function(r){var n=r.row;return[t.showActivityLog?e("a",{attrs:{title:t.trans("Activity Log")},on:{click:function(e){return t.openActivityLogModal(n)}}},[e("b-icon",{attrs:{icon:"history"}})],1):t._e(),t._v(" "),t.viewRoute?e("a",{attrs:{href:t.viewLink(n),title:t.trans("buttons.view")}},[e("b-icon",{attrs:{icon:"eye"}})],1):t._e(),t._v(" "),e("a",{on:{click:function(e){return t.confirmRemove(n)}}},[e("b-icon",{attrs:{icon:"trash"}})],1)]}}])}),t._v(" "),e("b-modal",{attrs:{active:t.activityLog.length>0,"has-modal-card":""},on:{close:function(e){t.activityLog=[]}}},[e("div",{staticClass:"modal-card"},[e("div",{staticClass:"modal-card-head"},[e("b-icon",{attrs:{icon:"history"}}),t._v(" "),e("p",{staticClass:"modal-card-title"},[t._v(t._s(t.trans("Activity Log")))])],1),t._v(" "),e("div",{staticClass:"modal-card-body"},[e("nz-timed-count-observation-activity-log",{attrs:{activities:t.activityLog}})],1)])])],1)],1)},[],!1,null,null,null).exports},7420:(t,e,r)=>{var n=r(7422),o=r(3170),a=r(1769);t.exports=function(t,e,r){for(var i=-1,s=e.length,l={};++i<s;){var u=e[i],c=n(t,u);r(c,u)&&o(l,a(u,t),c)}return l}},7422:(t,e,r)=>{var n=r(1769),o=r(7797);t.exports=function(t,e){for(var r=0,a=(e=n(e,t)).length;null!=t&&r<a;)t=t[o(e[r++])];return r&&r==a?t:void 0}},7797:(t,e,r)=>{var n=r(4394);t.exports=function(t){if("string"==typeof t||n(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},7852:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});const n={name:"nzPerPageSelect",props:{value:Number,options:Array}};const o=(0,r(4486).A)(n,function(){var t=this,e=t._self._c;return e("b-field",[e("b-select",{attrs:{value:t.value,placeholder:"Per page"},on:{input:function(e){return t.$emit("input",e)}}},t._l(t.options,function(r,n){return e("option",{key:n,domProps:{value:r,textContent:t._s(r)}})}),0)],1)},[],!1,null,null,null).exports},8077:t=>{t.exports=function(t,e){return null!=t&&e in Object(t)}},8221:(t,e,r)=>{var n=r(3805),o=r(124),a=r(9374),i=Math.max,s=Math.min;t.exports=function(t,e,r){var l,u,c,d,f,v,h=0,p=!1,m=!1,g=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function b(e){var r=l,n=u;return l=u=void 0,h=e,d=t.apply(n,r)}function y(t){var r=t-v;return void 0===v||r>=e||r<0||m&&t-h>=c}function _(){var t=o();if(y(t))return w(t);f=setTimeout(_,function(t){var r=e-(t-v);return m?s(r,c-(t-h)):r}(t))}function w(t){return f=void 0,g&&l?b(t):(l=u=void 0,d)}function S(){var t=o(),r=y(t);if(l=arguments,u=this,v=t,r){if(void 0===f)return function(t){return h=t,f=setTimeout(_,e),p?b(t):d}(v);if(m)return clearTimeout(f),f=setTimeout(_,e),b(v)}return void 0===f&&(f=setTimeout(_,e)),d}return e=a(e)||0,n(r)&&(p=!!r.leading,c=(m="maxWait"in r)?i(a(r.maxWait)||0,e):c,g="trailing"in r?!!r.trailing:g),S.cancel=function(){void 0!==f&&clearTimeout(f),h=0,l=v=u=f=void 0},S.flush=function(){return void 0===f?d:w(o())},S}},8586:(t,e,r)=>{var n=r(6449),o=r(4394),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;t.exports=function(t,e){if(n(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!o(t))||(i.test(t)||!a.test(t)||null!=e&&t in Object(e))}},8816:(t,e,r)=>{var n=r(5970),o=r(6757),a=r(2865);t.exports=function(t){return a(o(t,void 0,n),t+"")}},9326:(t,e,r)=>{var n=r(1769),o=r(2428),a=r(6449),i=r(361),s=r(294),l=r(7797);t.exports=function(t,e,r){for(var u=-1,c=(e=n(e,t)).length,d=!1;++u<c;){var f=l(e[u]);if(!(d=null!=t&&r(t,f)))break;t=t[f]}return d||++u!=c?d:!!(c=null==t?0:t.length)&&s(c)&&i(f,c)&&(a(t)||o(t))}}}]);
//# sourceMappingURL=82f13da1ce411b02.js.map