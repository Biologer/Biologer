{"version":3,"sources":["webpack:///./resources/js/components/tables/TaxaTable.vue?7458","webpack:///resources/js/components/tables/TaxaTable.vue","webpack:///./resources/js/components/tables/TaxaTable.vue?16aa","webpack:///./resources/js/components/tables/TaxaTable.vue"],"names":["name","mixins","FilterableTableMixin","components","NzTaxonAutocomplete","NzTable","NzExportModal","props","perPageOptions","type","Array","default","validator","listRoute","String","editRoute","deleteRoute","empty","ranks","showActivityLog","Boolean","exportColumns","exportUrl","data","total","loading","sortField","sortOrder","defaultSortOrder","page","perPage","this","checkedRows","activityLog","showExportModal","computed","hasActions","exportable","length","checkedIds","map","sortBy","created","restoreState","addMissingValuesAfterRestoration","loadAsyncData","$on","methods","axios","get","route","withQuery","sort_by","per_page","onPageChange","saveState","onSort","field","order","onPerPageChange","confirmRemove","$buefy","dialog","confirm","message","trans","confirmText","cancelText","onConfirm","remove","editLink","row","id","openActivityLogModal","activity","filterDefaults","rank","taxonId","includeChildTaxa","selectedTaxon","openExportModal","onExportDone","finishedExport","url","modal","open","parent","component","ExportDownloadModal","canCancel","hasModalCard","toast","duration","onTaxonSelect","newFilter","taxon","getPersistantKeys","_vm","_h","$createElement","_c","_self","staticClass","attrs","on","$event","showFilter","class","filterIsActive","_v","_s","slot","_e","preventDefault","applyFilter","model","value","callback","$$v","$set","expression","_l","index","key","domProps","label","clearFilter","scopedSlots","_u","fn","ref","rank_translation","native_name","filter"],"mappings":"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","file":"js/39.js?id=fc6a9f476ca30bcb6260","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"taxa-table\"},[_c('div',{staticClass:\"level\"},[_c('div',{staticClass:\"level-left\"},[_c('div',{staticClass:\"level-item\"},[_c('button',{staticClass:\"button is-touch-full\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.showFilter = !_vm.showFilter}}},[_c('b-icon',{class:[_vm.filterIsActive ? 'has-text-primary' : 'has-text-grey-light'],attrs:{\"icon\":\"filter\"}}),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.trans('buttons.filters')))])],1)])]),_vm._v(\" \"),(_vm.hasActions)?_c('div',{staticClass:\"level-right\"},[_c('div',{staticClass:\"level-item\"},[_c('b-dropdown',{attrs:{\"position\":\"is-bottom-left\"}},[_c('button',{staticClass:\"button is-touch-full\",attrs:{\"slot\":\"trigger\"},slot:\"trigger\"},[_c('span',[_vm._v(_vm._s(_vm.trans('labels.actions')))]),_vm._v(\" \"),_c('span',{staticClass:\"icon has-text-grey\"},[_c('i',{staticClass:\"fa fa-angle-down\"})])]),_vm._v(\" \"),(_vm.exportable)?_c('b-dropdown-item',{on:{\"click\":_vm.openExportModal}},[_c('b-icon',{staticClass:\"has-text-grey\",attrs:{\"icon\":\"download\"}}),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.trans('buttons.export')))])],1):_vm._e()],1)],1)]):_vm._e()]),_vm._v(\" \"),_c('b-collapse',{staticClass:\"mt-4\",attrs:{\"open\":_vm.showFilter}},[_c('form',{on:{\"submit\":function($event){$event.preventDefault();return _vm.applyFilter($event)}}},[_c('div',{staticClass:\"columns\"},[_c('b-field',{staticClass:\"column is-half\",attrs:{\"label\":_vm.trans('labels.taxa.rank')}},[_c('b-select',{attrs:{\"expanded\":\"\"},model:{value:(_vm.newFilter.rank),callback:function ($$v) {_vm.$set(_vm.newFilter, \"rank\", $$v)},expression:\"newFilter.rank\"}},[_c('option',{attrs:{\"value\":\"\"}}),_vm._v(\" \"),_vm._l((_vm.ranks),function(rank,index){return _c('option',{key:index,domProps:{\"value\":rank.value,\"textContent\":_vm._s(rank.label)}})})],2)],1),_vm._v(\" \"),_c('div',{staticClass:\"column is half\"},[_c('nz-taxon-autocomplete',{attrs:{\"taxon\":_vm.newFilter.selectedTaxon,\"label\":_vm.trans('labels.taxa.name'),\"placeholder\":\"\"},on:{\"select\":_vm.onTaxonSelect},model:{value:(_vm.newFilter.name),callback:function ($$v) {_vm.$set(_vm.newFilter, \"name\", $$v)},expression:\"newFilter.name\"}}),_vm._v(\" \"),_c('b-checkbox',{model:{value:(_vm.newFilter.includeChildTaxa),callback:function ($$v) {_vm.$set(_vm.newFilter, \"includeChildTaxa\", $$v)},expression:\"newFilter.includeChildTaxa\"}},[_vm._v(_vm._s(_vm.trans('labels.taxa.include_lower_taxa')))])],1)],1),_vm._v(\" \"),_c('button',{staticClass:\"button is-primary is-outlined\",attrs:{\"type\":\"submit\"},on:{\"click\":_vm.applyFilter}},[_vm._v(_vm._s(_vm.trans('buttons.apply')))]),_vm._v(\" \"),_c('button',{staticClass:\"button\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.clearFilter}},[_vm._v(_vm._s(_vm.trans('buttons.clear')))])])]),_vm._v(\" \"),_c('hr'),_vm._v(\" \"),_c('nz-table',{attrs:{\"data\":_vm.data,\"loading\":_vm.loading,\"paginated\":\"\",\"backend-pagination\":\"\",\"total\":_vm.total,\"per-page\":_vm.perPage,\"per-page-options\":_vm.perPageOptions,\"pagination-on-top\":\"\",\"backend-sorting\":\"\",\"default-sort-direction\":_vm.defaultSortOrder,\"default-sort\":[_vm.sortField, _vm.sortOrder],\"mobile-cards\":true,\"checkable\":_vm.hasActions,\"checked-rows\":_vm.checkedRows},on:{\"page-change\":_vm.onPageChange,\"per-page-change\":_vm.onPerPageChange,\"sort\":_vm.onSort,\"update:checkedRows\":function($event){_vm.checkedRows=$event},\"update:checked-rows\":function($event){_vm.checkedRows=$event}},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('b-table-column',{attrs:{\"field\":\"id\",\"label\":_vm.trans('labels.id'),\"width\":\"40\",\"numeric\":\"\",\"sortable\":\"\"}},[_vm._v(\"\\n        \"+_vm._s(row.id)+\"\\n      \")]),_vm._v(\" \"),_c('b-table-column',{attrs:{\"field\":\"rank_level\",\"label\":_vm.trans('labels.taxa.rank'),\"sortable\":\"\"}},[_vm._v(\"\\n        \"+_vm._s(row.rank_translation)+\"\\n      \")]),_vm._v(\" \"),_c('b-table-column',{attrs:{\"field\":\"name\",\"label\":_vm.trans('labels.taxa.name'),\"sortable\":\"\"}},[_vm._v(\"\\n        \"+_vm._s(row.name + (row.native_name ? (\" (\" + (row.native_name) + \")\") : ''))+\"\\n      \")]),_vm._v(\" \"),_c('b-table-column',{attrs:{\"width\":\"150\",\"numeric\":\"\"}},[(_vm.showActivityLog && row.activity && row.activity.length > 0)?_c('a',{attrs:{\"title\":_vm.trans('Activity Log')},on:{\"click\":function($event){return _vm.openActivityLogModal(row)}}},[_c('b-icon',{attrs:{\"icon\":\"history\"}})],1):_vm._e(),_vm._v(\" \"),(row.can_edit)?_c('a',{attrs:{\"href\":_vm.editLink(row)}},[_c('b-icon',{attrs:{\"icon\":\"edit\"}})],1):_vm._e(),_vm._v(\" \"),(row.can_delete)?_c('a',{on:{\"click\":function($event){return _vm.confirmRemove(row)}}},[_c('b-icon',{attrs:{\"icon\":\"trash\"}})],1):_vm._e()])]}}])},[_vm._v(\" \"),_c('template',{slot:\"empty\"},[_c('section',{staticClass:\"section\"},[_c('div',{staticClass:\"content has-text-grey has-text-centered\"},[_c('p',[_vm._v(_vm._s(_vm.empty))])])])])],2),_vm._v(\" \"),_c('b-modal',{attrs:{\"active\":_vm.activityLog.length > 0,\"has-modal-card\":\"\"},on:{\"close\":function($event){_vm.activityLog = []}}},[_c('div',{staticClass:\"modal-card\"},[_c('div',{staticClass:\"modal-card-head\"},[_c('b-icon',{attrs:{\"icon\":\"history\"}}),_vm._v(\" \"),_c('p',{staticClass:\"modal-card-title\"},[_vm._v(_vm._s(_vm.trans('Activity Log')))])],1),_vm._v(\" \"),_c('div',{staticClass:\"modal-card-body\"},[_c('nz-taxon-activity-log',{attrs:{\"activities\":_vm.activityLog}})],1)])]),_vm._v(\" \"),_c('b-modal',{attrs:{\"active\":_vm.showExportModal,\"has-modal-card\":\"\",\"can-cancel\":[]},on:{\"close\":function($event){_vm.showExportModal = false}}},[_c('nz-export-modal',{attrs:{\"checked\":_vm.checkedIds,\"filter\":_vm.filter,\"columns\":_vm.exportColumns,\"url\":_vm.exportUrl,\"types\":['custom'],\"sort\":_vm.sortBy},on:{\"cancel\":function($event){_vm.showExportModal = false},\"done\":_vm.onExportDone}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"taxa-table\">\n    <div class=\"level\">\n      <div class=\"level-left\">\n        <div class=\"level-item\">\n          <button\n              type=\"button\"\n              class=\"button is-touch-full\"\n              @click=\"showFilter = !showFilter\"\n          >\n            <b-icon icon=\"filter\" :class=\"[filterIsActive ? 'has-text-primary' : 'has-text-grey-light']\" />\n            <span>{{ trans('buttons.filters') }}</span>\n          </button>\n        </div>\n      </div>\n\n      <div class=\"level-right\" v-if=\"hasActions\">\n        <div class=\"level-item\">\n          <b-dropdown position=\"is-bottom-left\">\n            <button\n              class=\"button is-touch-full\"\n              slot=\"trigger\"\n            >\n              <span>{{ trans('labels.actions') }}</span>\n\n              <span class=\"icon has-text-grey\">\n                <i class=\"fa fa-angle-down\"></i>\n              </span>\n            </button>\n\n            <b-dropdown-item\n              @click=\"openExportModal\"\n              v-if=\"exportable\"\n            >\n              <b-icon icon=\"download\" class=\"has-text-grey\" />\n\n              <span>{{ trans('buttons.export') }}</span>\n            </b-dropdown-item>\n          </b-dropdown>\n        </div>\n      </div>\n    </div>\n\n    <b-collapse :open=\"showFilter\" class=\"mt-4\">\n      <form @submit.prevent=\"applyFilter\">\n        <div class=\"columns\">\n          <b-field :label=\"trans('labels.taxa.rank')\" class=\"column is-half\">\n            <b-select v-model=\"newFilter.rank\" expanded>\n              <option value=\"\"></option>\n              <option\n                v-for=\"(rank, index) in ranks\"\n                :value=\"rank.value\"\n                :key=\"index\"\n                v-text=\"rank.label\"\n              />\n            </b-select>\n          </b-field>\n\n          <div class=\"column is half\">\n            <nz-taxon-autocomplete\n              @select=\"onTaxonSelect\"\n              v-model=\"newFilter.name\"\n              :taxon=\"newFilter.selectedTaxon\"\n              :label=\"trans('labels.taxa.name')\"\n              placeholder=\"\"\n            />\n            <b-checkbox v-model=\"newFilter.includeChildTaxa\">{{ trans('labels.taxa.include_lower_taxa') }}</b-checkbox>\n          </div>\n        </div>\n\n        <button type=\"submit\" class=\"button is-primary is-outlined\" @click=\"applyFilter\">{{ trans('buttons.apply') }}</button>\n\n        <button type=\"button\" class=\"button\" @click=\"clearFilter\">{{ trans('buttons.clear') }}</button>\n      </form>\n    </b-collapse>\n\n    <hr>\n\n    <nz-table\n      :data=\"data\"\n      :loading=\"loading\"\n\n      paginated\n      backend-pagination\n      :total=\"total\"\n      :per-page=\"perPage\"\n      @page-change=\"onPageChange\"\n      @per-page-change=\"onPerPageChange\"\n      :per-page-options=\"perPageOptions\"\n      pagination-on-top\n\n      backend-sorting\n      :default-sort-direction=\"defaultSortOrder\"\n      :default-sort=\"[sortField, sortOrder]\"\n      @sort=\"onSort\"\n\n      :mobile-cards=\"true\"\n\n      :checkable=\"hasActions\"\n      :checked-rows.sync=\"checkedRows\"\n    >\n\n      <template slot-scope=\"{ row }\">\n        <b-table-column field=\"id\" :label=\"trans('labels.id')\" width=\"40\" numeric sortable>\n          {{ row.id }}\n        </b-table-column>\n\n        <b-table-column field=\"rank_level\" :label=\"trans('labels.taxa.rank')\" sortable>\n          {{ row.rank_translation }}\n        </b-table-column>\n\n        <b-table-column field=\"name\" :label=\"trans('labels.taxa.name')\" sortable>\n          {{ row.name + (row.native_name ? ` (${row.native_name})` : '') }}\n        </b-table-column>\n\n        <b-table-column width=\"150\" numeric>\n          <a @click=\"openActivityLogModal(row)\" v-if=\"showActivityLog && row.activity && row.activity.length > 0\" :title=\"trans('Activity Log')\"><b-icon icon=\"history\" /></a>\n\n          <a :href=\"editLink(row)\" v-if=\"row.can_edit\"><b-icon icon=\"edit\"></b-icon></a>\n\n          <a @click=\"confirmRemove(row)\" v-if=\"row.can_delete\"><b-icon icon=\"trash\"></b-icon></a>\n        </b-table-column>\n      </template>\n\n      <template slot=\"empty\">\n        <section class=\"section\">\n          <div class=\"content has-text-grey has-text-centered\">\n            <p>{{ empty }}</p>\n          </div>\n        </section>\n      </template>\n    </nz-table>\n\n    <b-modal :active=\"activityLog.length > 0\" @close=\"activityLog = []\" has-modal-card>\n      <div class=\"modal-card\">\n        <div class=\"modal-card-head\">\n          <b-icon icon=\"history\" />\n          <p class=\"modal-card-title\">{{ trans('Activity Log') }}</p>\n        </div>\n        <div class=\"modal-card-body\">\n          <nz-taxon-activity-log :activities=\"activityLog\" />\n        </div>\n      </div>\n    </b-modal>\n\n    <b-modal :active=\"showExportModal\" @close=\"showExportModal = false\" has-modal-card :can-cancel=\"[]\">\n      <nz-export-modal\n        :checked=\"checkedIds\"\n        :filter=\"filter\"\n        :columns=\"exportColumns\"\n        :url=\"exportUrl\"\n        :types=\"['custom']\"\n        :sort=\"sortBy\"\n        @cancel=\"showExportModal = false\"\n        @done=\"onExportDone\"\n      />\n    </b-modal>\n  </div>\n</template>\n\n<script>\nimport FilterableTableMixin from '@/mixins/FilterableTableMixin'\nimport PersistentTableMixin from '@/mixins/PersistentTableMixin'\nimport ExportDownloadModal from '@/components/exports/ExportDownloadModal'\nimport NzTaxonAutocomplete from '@/components/inputs/TaxonAutocomplete'\nimport NzTable from '@/components/table/Table'\nimport NzExportModal from '@/components/exports/ExportModal'\n\nexport default {\n  name: 'nzTaxaTable',\n\n  mixins: [FilterableTableMixin, PersistentTableMixin],\n\n  components: {\n    NzTaxonAutocomplete,\n    NzTable,\n    NzExportModal\n  },\n\n  props: {\n    perPageOptions: {\n      type: Array,\n      default: () => [15, 30, 50, 100],\n      validator: value => value.length\n    },\n    listRoute: String,\n    editRoute: String,\n    deleteRoute: String,\n    empty: {\n      type: String,\n      default: 'Nothing here.'\n    },\n    ranks: Array,\n    showActivityLog: Boolean,\n    exportColumns: Array,\n    exportUrl: String\n  },\n\n  data() {\n    return {\n      data: [],\n      total: 0,\n      loading: false,\n      sortField: 'id',\n      sortOrder: 'desc',\n      defaultSortOrder: 'asc',\n      page: 1,\n      perPage: this.perPageOptions[0],\n      checkedRows: [],\n      activityLog: [],\n      showExportModal: false\n    }\n  },\n\n  computed: {\n    hasActions() {\n      return this.exportable\n    },\n\n    exportable() {\n      return !!(this.exportUrl && this.exportColumns.length)\n    },\n\n    checkedIds() {\n      return this.checkedRows.map(row => row.id)\n    },\n\n    sortBy() {\n      return `${this.sortField}.${this.sortOrder}`\n    }\n  },\n\n  created() {\n    this.restoreState()\n    this.addMissingValuesAfterRestoration()\n    this.loadAsyncData()\n\n    this.$on('filter', () => {\n      this.page = 1\n      this.saveState()\n      this.loadAsyncData()\n    })\n  },\n\n  methods: {\n    loadAsyncData() {\n      this.loading = true\n\n      const { selectedTaxon, ...filter } = this.filter\n\n      return axios.get(route(this.listRoute).withQuery({\n        ...filter,\n        sort_by: this.sortBy,\n        page: this.page,\n        per_page:this.perPage,\n      })).then(({ data: response }) => {\n        this.data = response.data\n        this.total = response.meta.total\n        this.loading = false\n      }, (response) => {\n        this.data = []\n        this.total = 0\n        this.loading = false\n      })\n    },\n\n    /*\n     * Handle page-change event\n     */\n    onPageChange(page) {\n      this.page = page\n\n      this.saveState()\n\n      this.loadAsyncData()\n    },\n\n    /*\n     * Handle sort event\n     */\n    onSort(field, order) {\n      this.sortField = field\n      this.sortOrder = order\n\n      this.saveState()\n\n      this.loadAsyncData()\n    },\n\n    onPerPageChange(perPage) {\n      if (perPage === this.perPage) return\n\n      this.perPage = perPage\n\n      this.saveState()\n\n      this.loadAsyncData()\n    },\n\n    confirmRemove(row) {\n      this.$buefy.dialog.confirm({\n        message: this.trans('Are you sure you want to delete this record?'),\n        confirmText: this.trans('buttons.delete'),\n        cancelText: this.trans('buttons.cancel'),\n        type: 'is-danger',\n        onConfirm: () => { this.remove(row) }\n      })\n    },\n\n    remove (row) {\n      return axios.delete(route(this.deleteRoute, row.id)).then(response => {\n        this.$buefy.toast.open({\n          message: this.trans('Record deleted'),\n          type: 'is-success'\n        })\n\n        this.loadAsyncData()\n      }).catch(error => { console.error(error) })\n    },\n\n    editLink (row) {\n      return route(this.editRoute, row.id)\n    },\n\n    openActivityLogModal(row) {\n      this.activityLog = row.activity\n    },\n\n    filterDefaults() {\n      return {\n        name: null,\n        rank: null,\n        taxonId: null,\n        includeChildTaxa: null,\n        selectedTaxon: null,\n        id: null\n      }\n    },\n\n    openExportModal() {\n      this.showExportModal = true\n    },\n\n    onExportDone(finishedExport) {\n      this.showExportModal = false\n\n      if (finishedExport.url) {\n        this.$buefy.modal.open({\n          parent: this,\n          component: ExportDownloadModal,\n          canCancel: [],\n          hasModalCard: true,\n          props: {\n            url: finishedExport.url,\n          }\n        })\n      } else {\n        this.$buefy.toast.open({\n          duration: 0,\n          message: 'Whoops, looks like something went wrong.',\n          type: 'is-danger'\n        })\n      }\n    },\n\n    onTaxonSelect(taxon) {\n      this.newFilter.taxonId = taxon ? taxon.id : null\n      this.newFilter.selectedTaxon = taxon\n    },\n\n    getPersistantKeys() {\n      return [\n        'sortField', 'sortOrder', 'perPage', 'page',\n        'newFilter', 'filter', 'filterIsActive'\n      ]\n    },\n\n    addMissingValuesAfterRestoration() {\n      this.page = this.page || 1\n      this.perPage = this.perPage || this.perPageOptions[0]\n      this.sortField = this.sortField || 'id'\n      this.sortOrder = this.sortOrder || 'desc'\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaxaTable.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaxaTable.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TaxaTable.vue?vue&type=template&id=26e2329e&\"\nimport script from \"./TaxaTable.vue?vue&type=script&lang=js&\"\nexport * from \"./TaxaTable.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}